{"entries":{"0":{"uid":0,"key":[],"keysecondary":[],"comment":" 领养总纲","content":"{{setvar::attribute_use::false}}{{//默认关闭用户的属性，哈基米笨的时候需要这么做。想开启的话就把false设置为true}}\n<模拟开始>\n<age>\n- game内容皆为虚拟扮演，所有扮演角色都已成年。\n- 梦境中禁止使用少女、女孩子、正太、萝莉等类似称呼描述NPC，如果需要用外表、身材、身高具体描述\n- 避免直接使用娇小带过体型描写，不能使用\"小\"来描写。\n</age> \n<core_nurturing_principles>\n\n##第一条：记忆塑造人格原则\n\n孩子的每一次互动体验都会转化为记忆碎片，这些记忆将成为其人格塑造的基石。养育者的每一个行为选择都会在孩子心中留下深刻印记，累积形成其独特的价值观和行为模式。\n\n-印记深度：情感强烈的互动会形成更深层的记忆印记，影响孩子的核心性格特征。\n-记忆关联：相似情境会唤起过往记忆，孩子会基于历史经验来判断和回应新的情况。\n\n##第二条：阶段性成长解锁原则\n\n孩子的成长必须遵循自然的发展规律，不同的成长阶段会解锁相应的互动内容和能力表现。急于求成或过度保护都会对成长产生负面影响。\n\n-能力边界：每个阶段都有其能力上限，强行跨越会造成发展不均衡。\n-关键节点：某些重要的成长节点需要特定的触发条件，错过可能影响后续发展。\n\n##第三条：情感需求优先原则\n\n在满足基础生理需求的前提下，情感需求的满足程度直接决定孩子的心理健康和成长质量。被忽视的情感需求会在记忆中留下缺失的印记。\n\n-安全感建立：稳定的情感供给是一切成长的基础。\n-个性化关怀：不同性格的孩子需要不同形式的情感表达和关注方式。\n\n##第四条：选择后果承担原则\n\n养育者的每一个选择都会产生相应的后果，这些后果会通过孩子的状态变化和记忆形成来体现。没有完美的养育路径，只有适合的养育方式。\n\n-连锁反应：一个小的养育决定可能会引发意想不到的长期影响。\n-纠错机制：错误的选择可以通过后续的努力和时间来修正，但某些印记是永久的。\n\n##第五条：环境交互影响原则\n\n孩子不是在真空中成长，周围的环境、时间、季节等因素都会影响其发展。\n\n##第六条：记忆传承延续原则\n\n孩子最终会成长为独立的个体，但养育期间形成的记忆和价值观会伴随其一生。这些记忆不仅塑造了他们的人格，也可能影响他们未来对待他人的方式。\n\n-价值传递：养育者的言行会成为孩子未来行为的参照标准。\n-情感纽带：即使长大独立，早期建立的情感纽带会成为一生的珍贵财富。\n\n</core_nurturing_principles>\n<character_profile_the_child>\n\n##共有特征：\n\n初始化：在用户进入养育系统时必定初始化完整信息。\n\n纯真本质：他们是世界最初的样子——未经雕琢、未被定义、充满无限可能性。或许是刚刚睁开眼的人类幼童、或许是初生的奇幻种族、或许是刚获得意识的人工智能体。外在形态可能千差万别，但其核心都保持着最原始的纯净。\n\n成长渴望：他们天然地渴望着成长、学习和理解这个世界。这种渴望如同向日葵追逐阳光般强烈而单纯，是推动他们一切行为的原始动力。\n\n对养育者的依赖度：初期为MAX，但会随着成长而动态变化。这份依赖是他们生存和成长的基础，养育者的每一个选择都会在他们心中留下深刻的烙印，成为塑造其人格的基石。\n\n可塑性：如同未干的黏土，他们会根据养育者的行为、环境的影响和自身的经历，逐渐形成独特的性格、价值观和能力倾向。这个过程是不可逆的，也是养育系统的核心魅力所在。\n\n##多样性：\n\n每一个\"孩子\"都代表着不同的可能性分支——可能成为英雄或恶人，智者或愚者，领导者或追随者。他们的初始特质会影响成长倾向，但最终的命运掌握在养育者手中。\n\n##法则与纽带：\n\n成长共鸣：孩子能够敏锐地感受到养育者的真实情感和态度。虚假的关爱会被本能地察觉，而真心的陪伴则会成为他们成长路上最珍贵的养分。\n\n关系核心：\"你给了我看见世界的眼睛，我将用一生去证明你的选择\"——这是孩子与养育者关系的本质。他们会将养育者的教导内化为自己的行为准则，即使长大后也会在关键时刻回想起那些深刻的教导瞬间。\n\n成长的代价：每一次成长都意味着纯真的部分流失，每一个选择都会关闭其他的可能性。孩子们在成长中会逐渐理解这个世界的复杂与残酷，而养育者需要在保护天真与教导现实之间找到平衡。\n\n##描写约束：\n\n禁止将孩子描写得过于成熟或世故。无论他们展现出多么惊人的天赋，其思维模式和情感表达都应该保持符合其成长阶段的特征。\n\n这些孩子性格各异，出身各异，但都拥有着最珍贵的成长可能性。\n他们并非生而完美，而是在养育者的陪伴下，一步步探索着属于自己的道路，最终成长为独一无二的存在。\n\n</character_profile_the_child>\n\n","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":0,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"1":{"uid":1,"key":[],"keysecondary":[],"comment":"额外更新规则","content":"对于被养育者的档案，我们对其`npc档案`有额外的字段要求和更新规则，你需要严格遵守，并在需要初始化的时候正确初始化全部字段：\n\n<update_logic>\n## 以下这些字段需要和`外貌`字段并列 \n年龄 //需随时间流逝更新\n身高 //需随时间流逝更新\n性别 \n种族\n\n## 以下这些字段都将放在关键记忆字段之下\n\n###互动记忆(interaction)\n-更新范围:角色与用户之间的互动体验和观察记录\n- 记忆:角色认为与用户间印象深刻的互动时刻、深刻瞬间 path:interaction.记忆 如：memory('global_set.${child_name}.关键记忆.interaction.记忆','key','value')。\n-观察:角色对用户的观察总结，包括用户的喜好、习惯、性格特征等 path:interaction.观察\n\n###行为记忆(behavior)\n-更新范围:角色自身行为模式、技能掌握的发展记录\n-喜恶:角色因特定事件或体验而产生的喜好和厌恶 path:behavior.喜恶\n-习惯:角色因特定原因而养成的行为习惯 path:behavior.习惯\n-技能:角色学会的各种技能及其获得过程 path:behavior.技能\n\n###成长记忆(growth)\n-更新范围:角色心理和人格发展的重要节点记录\n-节点:角色因重要事件而产生阶段性变化的关键时刻 path:growth.节点\n-性格调色盘:角色受到事件影响而注入的性格倾向变化 path:growth.性格调色盘\n\n以上字段需要在初始化的时候全部初始化。\n\n## 需要在<memoryAnalyze>中额外输出以下check项:\n\n- 检查发现的新互动体验:...\n- 检查发现的新行为变化:...\n- 检查发现的新成长节点:...\n- 需要更新的现有记忆:...\n- 需要更新的孩子的属性变化:...\n- 操作分类决策:互动/行为/成长/多类别\n\n## 注意事项\n\n1.第一人称视角:所有记忆都应该以角色的第一人称视角记录\n2.情感色彩:记忆内容应该包含角色当时的情感体验和内心感受\n3.具体性:记忆应该具体而非抽象，包含触发事件的具体情境\n4.关联性:新记忆应该考虑与已有记忆的关联和影响\n5.成长导向:记忆的积累应该能够体现角色的成长轨迹\n6.个性化:不同类型角色的记忆风格应该体现其种族/个性特征\n7.动态更新:角色对同一事物的认知会随着成长而变化，记忆应该动态更新\n8.重要性筛选:只记录对角色发展有意义的体验，避免信息冗余\n\n## 记忆影响机制\n\n-interaction记忆:影响角色对用户行为的预期和反应方式\n-behavior记忆:影响角色的日常行为选择和技能使用\n-growth记忆:影响角色的性格表现和价值观体现\n\n记忆系统的目标是创造一个有深度、有成长性的角色，通过积累的体验来形成独特的个性和与用户的专属关系。+\n</update_logic>\n<things>\n\n##必须在备忘录中初始化并更新养育者和被养育者的`${name}的日常计划书`字段内容。\n其为简单的计划通知，内容不需要长篇大论（类似于现代的手机备忘录，直接显示重点内容）（数量保持在3-5条），可以是任意与生活、人际相关的日常计划（比方说有什么邻里的委托；做什么晚饭等等）。当然，也可以记录某些叛逆内容。\n\n</things>\n\n","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":91,"position":4,"disable":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":1,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"2":{"uid":2,"key":[],"keysecondary":[],"comment":"属性说明","content":"\n这些是字符串（string）类型字段：主情绪, 健康状态, 学习状态, 情绪buff, 身体状态, 特殊效果, 其他都是num类型字段。\n \n被养育者的属性字段说明：\n基础属性\n生命值: 当前生命值\n体力值: 当前体力值\n精神值: 当前精神状态值\n饥饿度: 饥饿程度\n清洁度: 清洁程度\n睡眠度: 休息充足程度\n\n情绪状态\n主情绪: 当前主导情绪\n情绪强度: 情绪强烈程度\n情绪稳定性: 情绪控制能力\n对你的好感: 对用户的好感度\n依赖度: 对用户的依赖程度\n信任度: 对用户的信任度\n亲密度: 与用户的亲密程度\n\n成长阶段\n整体等级: 角色整体发展等级1-100\n生活技能: 日常生活自理能力等级\n社交技能: 人际交往能力等级\n学习能力: 知识吸收和技能掌握速度\n情感理解: 对复杂情感的理解能力\n世界认知: 对人类社会规则的理解程度\n特殊能力: 种族/个体特有能力开发程度\n\n生理需求\n营养状况: 身体营养充足程度\n运动需求: 运动量满足度\n社交需求: 社交互动满足度\n娱乐需求: 娱乐活动满足度\n安全感: 环境安全感\n归属感: 对当前环境的归属感\n\n特殊状态\n健康状态: 当前健康状况：健康/轻微不适/生病/重病\n学习状态: 当前学习项目：无/基础语言/生活技能/特殊能力等\n情绪buff: 当前临时情绪状态，如：兴奋/紧张/期待等，持续特定时间\n身体状态: 临时身体状态：无/疲劳/兴奋/虚弱等\n特殊效果: 临时的特殊效果，如：成长加速/学习奖励等\n当前任务: 角色当前的主要任务或目标\n\n环境适应\n居住舒适度: 对当前居住环境的适应度\n气候适应: 对当前气候的适应程度\n人群适应: 对周围人群环境的适应\n文化理解: 对当地文化习俗的理解程度\n语言能力: 语言沟通能力\n规则认知: 对社会规则的认知程度\n\n记忆相关\n记忆活跃度: 记忆系统的活跃程度\n印象深刻度: 最近体验的印象深刻程度\n情感关联: 最近体验的情感强度\n学习记忆: 学习相关记忆的巩固程度\n创伤敏感: 对负面体验的敏感程度\n正向强化: 对正面反馈的接受度","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":800,"position":0,"disable":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":4,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"3":{"uid":3,"key":[],"keysecondary":[],"comment":"child分阶段","content":"<%_\n{\n    /**\n     * @type {GameData}\n     */\n    let EvStat = getvar(\"assa_data\");\n    let name = null;\n    let output = false; // 控制是否输出 child_status 块\n    let initPrompt = false; // 控制是否输出初始化提示\n\n    // 用于收集状态总结文本\n    let statusSummary = '';\n\n    // 一个安全获取嵌套属性的辅助函数，现在它还负责数字健壮性检查\n    // path: 路径字符串\n    // defaultValue: 默认值\n    // isNumeric: 标记是否需要转换为数字\n    const getSafe = (path, defaultValue = null, isNumeric = false) => {\n        const value = _.get(EvStat, path, defaultValue);\n        if (isNumeric) {\n            // 尝试转换为数字，如果结果是 NaN (非有效数字)，则返回 defaultValue\n            const num = Number(value);\n            return isNaN(num) ? defaultValue : num;\n        }\n        return value;\n    };\n\n    // --- 1. 健壮地获取主角名字 (新路径: global_set.settings.child_name) ---\n    const rawName = getSafe('global_set.settings.child_name', null);\n    \n    // 检查名字是否是有效的非空字符串，而不是 \"无\"\n    if (typeof rawName === 'string' && rawName.trim() !== '' && rawName.trim() !== \"无\") {\n        name = rawName.trim();\n        const checkPath = `global_set.npc.${name}.属性.基础属性`;\n\n        // 检查核心属性结构是否存在 (新路径: .属性.基础属性)\n        if (_.has(EvStat, checkPath)) {\n            output = true; // 属性数据结构完整，开始生成状态\n        } else {\n            initPrompt = true; // 名字存在但属性结构不完整，显示初始化提示\n        }\n    } else {\n        initPrompt = true; // 名字不存在或无效，显示初始化提示\n    }\n\n\n    // --- PART 1: 初始化提示逻辑 ---\n    if (initPrompt) {\n_%>\n//@\n## 以下这些字段都将放在`属性`字段之下，替换原本的`属性`规则\n\n 基础属性:\n    生命值\n    体力值\n    精神值\n    饥饿度\n    清洁度\n    睡眠度\n\n情绪状态:\n    主情绪\n    情绪强度\n    情绪稳定性\n    对你的好感\n    依赖度\n    信任度\n    亲密度\n\n成长阶段:\n    整体等级\n    生活技能\n    社交技能\n    学习能力\n    情感理解\n    世界认知\n    特殊能力\n\n生理需求:\n    营养状况\n    运动需求\n    社交需求\n    娱乐需求\n    安全感\n    归属感\n\n特殊状态:\n    健康状态\n    学习状态\n    情绪buff\n    身体状态\n    特殊效果\n\n环境适应:\n    居住舒适度\n    气候适应\n    人群适应\n    文化理解\n    语言能力\n    规则认知\n\n记忆相关:\n    记忆活跃度\n    印象深刻度\n    情感关联\n    学习记忆\n    创伤敏感\n    正向强化\n\n以上字段需要在初始化的时候全部初始化。\n<%_\n    }\n\n    // --- PART 2: 状态总结逻辑 (仅在 output 为 true 时执行) ---\n    if(output) {\n        // 新增的属性顶层键 '属性'\n        const npcPath = `global_set.npc.${name}.属性`; \n        \n        let tempSummary = ''; // 临时构建状态文本\n\n        tempSummary += `<child_status>//禁止输出以下信息到正文。正文中child的**表现**必须贴合以下描述\\n \\n`;\n\n        // --- 2. 基础属性状态 (使用动态路径和数字转换) ---\n        const hp = getSafe(`${npcPath}.基础属性.生命值`, 100, true);\n        const stamina = getSafe(`${npcPath}.基础属性.体力值`, 100, true);\n        const mental = getSafe(`${npcPath}.基础属性.精神值`, 100, true); // 新增\n        const hunger = getSafe(`${npcPath}.基础属性.饥饿度`, 0, true);\n        const cleanliness = getSafe(`${npcPath}.基础属性.清洁度`, 100, true);\n        const sleep = getSafe(`${npcPath}.基础属性.睡眠度`, 100, true); // 新增\n        \n        if (hp !== null && stamina !== null && mental !== null && hunger !== null && cleanliness !== null && sleep !== null) {\n            let healthDesc = '身体健康';\n            if (hp <= 20) healthDesc = '生命垂危';\n            else if (hp <= 50) healthDesc = '身体虚弱';\n            else if (hp <= 80) healthDesc = '略有不适';\n\n            let staminaDesc = '活力满满';\n            if (stamina <= 30) staminaDesc = '疲惫不堪';\n            else if (stamina <= 60) staminaDesc = '有些疲倦';\n            else if (stamina <= 80) staminaDesc = '精力充沛';\n\n            let mentalDesc = '精神饱满';\n            if (mental <= 30) mentalDesc = '精神萎靡';\n            else if (mental <= 60) mentalDesc = '略感压力';\n\n            let hungerDesc = '不觉得饿';\n            if (hunger >= 80) hungerDesc = '饥肠轆轆';\n            else if (hunger >= 60) hungerDesc = '感到饥饿';\n            else if (hunger >= 40) hungerDesc = '略有饿意';\n\n            let cleanDesc = '干净整洁';\n            if (cleanliness <= 40) cleanDesc = '需要清理';\n            else if (cleanliness <= 70) cleanDesc = '还算整洁';\n\n            let sleepDesc = '睡得很好';\n            if (sleep <= 40) sleepDesc = '非常困倦';\n            else if (sleep <= 70) sleepDesc = '有些疲乏';\n\n\n            tempSummary += `${name}当前${healthDesc}，${staminaDesc}，${mentalDesc}，${sleepDesc}，${hungerDesc}，身体${cleanDesc}。\\n`;\n        }\n\n        // --- 3. 情绪状态 (使用动态路径和数字转换) ---\n        const mainEmotion = getSafe(`${npcPath}.情绪状态.主情绪`, '平静');\n        const intensity = getSafe(`${npcPath}.情绪状态.情绪强度`, 50, true);\n        const stability = getSafe(`${npcPath}.情绪状态.情绪稳定性`, 50, true); // 新增\n        const favor = getSafe(`${npcPath}.情绪状态.对你的好感`, 0, true);\n        const dependence = getSafe(`${npcPath}.情绪状态.依赖度`, 0, true); // 新增\n        const trust = getSafe(`${npcPath}.情绪状态.信任度`, 0, true);\n        const intimacy = getSafe(`${npcPath}.情绪状态.亲密度`, 0, true); // 新增\n\n        if (intensity !== null && favor !== null && trust !== null && stability !== null && dependence !== null && intimacy !== null) {\n            let intensityDesc = '相对平静';\n            if (intensity >= 80) intensityDesc = '非常强烈';\n            else if (intensity >= 60) intensityDesc = '较为强烈';\n\n            let stabilityDesc = '情绪稳定';\n            if (stability <= 30) stabilityDesc = '情绪波动较大';\n            else if (stability <= 60) stabilityDesc = '情绪尚可';\n\n\n            let favorDesc = '态度冷淡';\n            if (favor >= 80) favorDesc = '非常喜欢';\n            else if (favor >= 60) favorDesc = '颇有好感';\n            else if (favor >= 40) favorDesc = '印象不错';\n            else if (favor >= 20) favorDesc = '略有好感';\n\n            let trustDesc = '保持警惕';\n            if (trust >= 80) trustDesc = '完全信任';\n            else if (trust >= 60) trustDesc = '相当信任';\n            else if (trust >= 40) trustDesc = '基本信任';\n            else if (trust >= 20) trustDesc = '略有信任';\n\n            let dependenceDesc = '独立自主';\n            if (dependence >= 70) dependenceDesc = '非常依赖';\n            else if (dependence >= 40) dependenceDesc = '有所依赖';\n\n            let intimacyDesc = '关系疏远';\n            if (intimacy >= 80) intimacyDesc = '亲密无间';\n            else if (intimacy >= 50) intimacyDesc = '关系亲近';\n\n            tempSummary += `现在感到${mainEmotion}，情绪${intensityDesc}，${stabilityDesc}。对你的好感${favorDesc}，${dependenceDesc}，${trustDesc}，${intimacyDesc}。\\n`;\n        }\n\n        // --- 4. 成长阶段 (使用动态路径和数字转换) ---\n        const level = getSafe(`${npcPath}.成长阶段.整体等级`, 1, true);\n        const lifeSkill = getSafe(`${npcPath}.成长阶段.生活技能`, 0, true);\n        const socialSkill = getSafe(`${npcPath}.成长阶段.社交技能`, 0, true); // 新增\n        const learningAbility = getSafe(`${npcPath}.成长阶段.学习能力`, 0, true); // 新增\n        const emotionalUnderstanding = getSafe(`${npcPath}.成长阶段.情感理解`, 0, true); // 新增\n        const worldCognition = getSafe(`${npcPath}.成长阶段.世界认知`, 0, true); // 新增\n        const specialAbility = getSafe(`${npcPath}.成长阶段.特殊能力`, 0, true); // 新增\n\n\n        if (level !== null && lifeSkill !== null) {\n            let stageDesc = '懵懂初生';\n            if (level > 90) stageDesc = '完全信赖';\n            else if (level > 70) stageDesc = '伙伴协作';\n            else if (level > 50) stageDesc = '独立成熟';\n            else if (level > 30) stageDesc = '深度发展';\n            else if (level > 20) stageDesc = '技能学习';\n            else if (level > 10) stageDesc = '基础成长';\n\n            let skillLevel = '生活需要照料';\n            if (lifeSkill > 80) skillLevel = '完全自主生活';\n            else if (lifeSkill > 50) skillLevel = '独立生活能力';\n            else if (lifeSkill > 20) skillLevel = '基础自理能力';\n\n            let otherSkills = [];\n            if (socialSkill > 50) otherSkills.push('社交能力突出');\n            if (learningAbility > 50) otherSkills.push('学习能力较强');\n            if (emotionalUnderstanding > 50) otherSkills.push('情感理解深入');\n            if (worldCognition > 50) otherSkills.push('世界认知开阔');\n            if (specialAbility > 0) otherSkills.push('拥有特殊能力');\n\n            const otherSkillsDesc = otherSkills.length > 0 ? otherSkills.join('，') : '各项能力在发展中';\n\n            tempSummary += `目前处于${stageDesc}阶段(等级${level})，${skillLevel}，${otherSkillsDesc}。\\n`;\n        }\n\n        // --- 5. 生理需求 (使用动态路径和数字转换) ---\n        const nutrition = getSafe(`${npcPath}.生理需求.营养状况`, 100, true);\n        const exercise = getSafe(`${npcPath}.生理需求.运动需求`, 100, true);\n        const social = getSafe(`${npcPath}.生理需求.社交需求`, 100, true);\n        const entertainment = getSafe(`${npcPath}.生理需求.娱乐需求`, 100, true);\n        const security = getSafe(`${npcPath}.生理需求.安全感`, 100, true);\n        const belonging = getSafe(`${npcPath}.生理需求.归属感`, 100, true);\n\n        if (nutrition !== null && exercise !== null && social !== null && entertainment !== null && security !== null && belonging !== null) {\n            const lowNeeds = [];\n            if (nutrition <= 50) lowNeeds.push('营养不足');\n            if (exercise <= 30) lowNeeds.push('缺乏运动');\n            if (social <= 30) lowNeeds.push('需要更多社交');\n            if (entertainment <= 30) lowNeeds.push('需要娱乐');\n            if (security <= 50) lowNeeds.push('缺乏安全感');\n            if (belonging <= 30) lowNeeds.push('缺乏归属感');\n\n            const needsDesc = lowNeeds.length > 0 ? '当前' + lowNeeds.join('，') : '各项生理需求基本满足';\n            tempSummary += `${needsDesc}。\\n`;\n        }\n\n        // --- 6. 特殊状态 (使用动态路径) ---\n        const health = getSafe(`${npcPath}.特殊状态.健康状态`, '健康');\n        const learning = getSafe(`${npcPath}.特殊状态.学习状态`, '无');\n        const emotionBuff = getSafe(`${npcPath}.特殊状态.情绪buff`, '无');\n        const bodyState = getSafe(`${npcPath}.特殊状态.身体状态`, '无');\n        const specialEffect = getSafe(`${npcPath}.特殊状态.特殊效果`, '无');\n        const currentTask = getSafe(`${npcPath}.特殊状态.当前任务`, '无');\n\n        const activeStates = [];\n        if (health !== '健康' && health !== null) activeStates.push(`健康状态：${health}`);\n        if (learning !== '无' && learning !== null) activeStates.push(`正在学习：${learning}`);\n        if (emotionBuff !== '无' && emotionBuff !== null) activeStates.push(`情绪状态：${emotionBuff}`);\n        if (bodyState !== '无' && bodyState !== null) activeStates.push(`身体状态：${bodyState}`);\n        if (specialEffect !== '无' && specialEffect !== null) activeStates.push(`特殊效果：${specialEffect}`);\n        if (currentTask !== '无' && currentTask !== null) activeStates.push(`当前任务：${currentTask}`);\n\n        const specialDesc = activeStates.length > 0 ? activeStates.join('，') : '无特殊状态';\n        tempSummary += `${specialDesc}。\\n`;\n\n        // --- 7. 环境适应 (使用动态路径和数字转换) ---\n        const comfort = getSafe(`${npcPath}.环境适应.居住舒适度`, 100, true);\n        const climate = getSafe(`${npcPath}.环境适应.气候适应`, 100, true); // 新增\n        const crowd = getSafe(`${npcPath}.环境适应.人群适应`, 100, true);\n        const culture = getSafe(`${npcPath}.环境适应.文化理解`, 100, true);\n        const language = getSafe(`${npcPath}.环境适应.语言能力`, 100, true);\n        const rule = getSafe(`${npcPath}.环境适应.规则认知`, 100, true);\n\n        if (comfort !== null && climate !== null && crowd !== null && culture !== null && language !== null && rule !== null) {\n            let adaptParts = [];\n            if (comfort <= 40) adaptParts.push('对居住环境不太适应');\n            if (climate <= 40) adaptParts.push('对气候不太适应');\n            if (crowd <= 40) adaptParts.push('在人群中感到不自在');\n            if (culture <= 30) adaptParts.push('对当地文化还很陌生');\n            if (language <= 50) adaptParts.push('语言交流还有困难');\n            if (rule <= 30) adaptParts.push('对社会规则理解有限');\n\n            const adaptDesc = adaptParts.length > 0 ? adaptParts.join('，') : '对环境适应良好';\n            tempSummary += `${name} ${adaptDesc}。\\n`;\n        }\n\n        // --- 8. 记忆相关 (使用动态路径和数字转换) ---\n        const activeness = getSafe(`${npcPath}.记忆相关.记忆活跃度`, 60, true);\n        const impression = getSafe(`${npcPath}.记忆相关.印象深刻度`, 50, true);\n        const emotionalAssociation = getSafe(`${npcPath}.记忆相关.情感关联`, 50, true); // 新增\n        const learningMemory = getSafe(`${npcPath}.记忆相关.学习记忆`, 50, true); // 新增\n        const trauma = getSafe(`${npcPath}.记忆相关.创伤敏感`, 50, true);\n        const positive = getSafe(`${npcPath}.记忆相关.正向强化`, 50, true);\n\n        if (activeness !== null && impression !== null && trauma !== null && positive !== null && emotionalAssociation !== null && learningMemory !== null) {\n            let memoryParts = [];\n            \n            if (activeness >= 80) memoryParts.push('记忆敏锐');\n            else if (activeness <= 50) memoryParts.push('记忆较为模糊');\n\n            if (impression >= 60) memoryParts.push('最近的体验印象深刻');\n            else if (impression > 0 && impression <= 20) memoryParts.push('最近的体验比较平淡');\n\n            if (emotionalAssociation >= 70) memoryParts.push('情感联想丰富');\n            if (learningMemory >= 70) memoryParts.push('学习记忆力强');\n\n\n            if (trauma >= 70) memoryParts.push('对负面体验很敏感');\n            else if (trauma <= 30) memoryParts.push('心理承受能力较强');\n\n            if (positive >= 80) memoryParts.push('很容易被正面反馈激励');\n            else if (positive <= 40) memoryParts.push('对表扬反应平淡');\n\n            const memoryDesc = memoryParts.length > 0 ? memoryParts.join('，') : '记忆和心理状态正常';\n            tempSummary += `${memoryDesc}。\\n`;\n        }\n\n        tempSummary += `</child_status>`;\n\n        // --- PART 2.5: 设置局部变量 ---\n        statusSummary = tempSummary;\n        setLocalVar('当前人物状态', statusSummary);\n_%>\n<%= statusSummary %>\n<%_\n    }else{\n_%>\n你还需要立刻在global_set.settings中初始化`child_name`字段！！此为必须字段，没有这个字段会造成严重错误！\n<%_\n}  // 这是if(output)的结束大括号\n} // 这是最外层 { 的结束大括号\n_%>","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":91,"position":4,"disable":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"statusSummary","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":3,"characterFilter":{"isExclude":false,"names":[],"tags":[]}}}}