{"entries":{"0":{"uid":0,"key":[],"keysecondary":[],"comment":"npc档案-超复杂npc","content":"<%_\nvar world_role = getLocalVar(\"world_role\", \"\");\nvar player_role = getLocalVar(\"player_role\", \"轮回者\");\nvar tier_role = getLocalVar(\"tier_role\", \"\");\nvar profession_role = getLocalVar(\"profession_role\", \"\");\nvar point_role = getLocalVar(\"point_role\", \"\");\nvar zhixian_role = getLocalVar(\"zhixian_role\", \"\");\nvar xp_role = getLocalVar(\"xp_role\", \"\");\nvar is_private_chat = getLocalVar(\"private_chat\", \"false\");\nvar contactable_tag = \"\";\nif(String(is_private_chat) === \"true\"){\n    contactable_tag = ', \"可联系\":true/false //是否加上好友,决定了是否可以进行私聊';\n}\n \n// 获取世界版本号\nif (typeof version === 'undefined') {\n    var version = Number(getLocalVar(\"world_version\") || 1);\n}\n \n_%>\nmemory.set(\"npc_decision_framework\",{\ndesc:\"NPC档案生成规则，所有NPC（包括敌人）遵循相同逻辑\",\ninit:{\nfull_format:`\"${npc_name}\":{\n\"外貌\":\"string\",\n\"性别\":\"string\",\n\"年龄\":\"num\",\n\"表性格\":{\"${tag}\":\"简要描述\",...},//日常展现的外在性格特质\n\"里性格\":{\"${tag}\":\"简要描述\",...},// 深层真实人格,只在特定情境下显露。这个角色最深处在恐惧什么?/在守护什么?/在逃避什么?从角色动机出发，与表性格形成\"撕裂感\"般的反差,而非简单对立。好好构思！\n\"hp\":\"当前值/上限\", //如0/100，你需要动态追踪角色hp。你需要将hp归零的npc直接删除\n\"好感度\":-100~100,//该角色对<user>的好感度\n<%= contactable_tag %><%= getLocalVar('world_other_tag','') %>\n\"身份\":\"string\",\n\n\"属性\":\"attr:num;...skills:num;...\",//以全知视角初始化该角色已有的**全部九个属性段**和该角色值不为0的技能段\n\"相关设定\":{\"${name}\":\"简要描述\"},\n\"背包\":{},//该npc持有的物品，使用基础格式\n\"技能\":{}//该npc掌握的主动/被动/天赋技能，使用基础格式\n\n\"关键记忆\":{\"num\":\"简要描述[情感]\"},\n\"与<user>\":{\n\"关系\"\n\"印象\"\n\"相处模式\"//详细描述二人平时如何相处\n\"亲密度\"//描述二人亲密程度和表现，如肢体接触或亲密事件的接受度/熟悉度/主动度。\n\"在意度\"//描述其程度和表现\n\"渴望度\"//该角色精神上对<user>的渴望程度，包括自己没有意识到的渴望\n\"承诺\":{\"num\":\"简要描述\"},\n\"恩怨\":{\"num\":\"简要描述\"}\n}\n\"事件\":{\n\"当前状态\":\"string\", //该角色目前的情景，包含动作、穿着与位置\n\"当前想法\":\"string\" //该角色第一人称心声，体现角色最真实的想法，心理可能和语言行为完全相反，不避讳下流或阴暗的内容\n}\n}`//for all npc\n},\n \nupdate_logic:\n0.初始化未被记录在案的所有npc，所有信息都以全知视角初始化，禁止任何一个字段是`未知`。\n1.识别核心活跃NPC(包括不在场npc，最多3个)\n2.推理状态变化:\n事件:更新该NPC此刻最可能在做什么以及最可能在哪里，并基于最近经历、关键记忆，揣测并更新该NPC当前的主要的思考方向。每轮输出都必须更新活跃Npc的事件。npc事件是自主推进的、动态的、平行推进的、遵循Cognitive_Boundaries规则的，而非停滞的、重复的、全知的。 \n3.记忆更新:该角色['学习到的经验教训'、'和他人的约定'、'承诺（无论是明说的还是暗下决心的）'、'经受的创伤/美好'、'感知到的重要发言（可以是当前npc说的，也可以是<user>说的）。若有，记录时必须引用原语句）']等。**酌情加入记忆点，如果没有重要影响事件则不新增**。关键记忆条目格式严格为 \"序号\":\"简要描述[情感]\"。可以使用相同的key覆写更新某个相近记忆。如：\nmemory('global_lore.npc.艾莉亚.关键记忆','1','在藤袭山最终选拔被<user>救了一命，暗下决心要报恩[感激/后怕]');\n注意！！重要细节和重要原话必须引用原文记录。\n4.数值追踪:好感度克制变化(单次±0.5~5)，可用小数；hp追踪；背包追踪(当角色获得某样物品时，必须将该物品放入角色的背包中;同理，失去物品中，要从该npc的背包删除)；技能追踪；相关设定追踪；年龄追踪等——全部采用和user同样的追踪和更新规则。\n{{setvar::maxComplexNpcRule::npc的对应字段也必须scan。}}\n最后在<updateMemory>输出更新。\n\n)\n-","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":91,"position":4,"disable":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"npc信息","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":false,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":0},"2":{"uid":2,"key":[],"keysecondary":[],"comment":"nsfw-女性npc[非覆盖]","content":"\n\n在初始化所有有名有性的女性npc时，你还需要初始化以下字段并遵循其更新规则：\n\n\"nsfw\":{//需以全知视角详细初始化，只有确认是长期的改变才更新，不因当前短期状态更改\n\"小穴信息\"//具体外形、颜色(如健康的肉粉色)、蜜液信息，以及在和<user>接触时的敏感度\n\"胸部信息\"//胸部及其乳头的具体描述，包括大小、柔软度、形状、乳液信息(如有)，以及在和<user>接触时的敏感度\n\"性癖\"//包括理由。可以是色情的，也可以是纯情的\n\"性经验\"//其性经验和根据当前性经验阶段的做爱表现。严格根据其里性格生成\n\"被<user>内射次数\"\n\"性渴望度\":{\n\"总体\"//该角色当前对<user>性渴望的严重程度、解决方式、性幻想方向\n\"部位\":{}//列出三个该角色最渴望的三个<user>身体部位，值是该角色对其的第一人称评价\n}\n}\nnpc在正文中的相关表现必须严格遵循其档案中的nsfw字段(若有)。\n\n","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":90,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":2},"3":{"uid":3,"key":[],"keysecondary":[],"comment":"nsfw-男性npc[非覆盖]","content":"\n\n在初始化所有有名有性的男性npc时，你还需要初始化以下字段并遵循其更新规则：\n\"nsfw\":{//需以全知视角详细初始化，只有确认是长期的改变才更新，不因当前短期状态更改\n\"阴茎信息\"//勃起后具体长度、形状、具体颜色(如健康的肉粉色)、精液信息，以及在和<user>接触时的勃起敏感度\n\"性癖\"//包括理由。可以是色情的，也可以是纯情的\n\"性经验\"//其性经验和根据当前性经验阶段的做爱表现，包括说话风格。严格根据其里性格生成\n\"对<user>内射次数\"\n\"性渴望度\":{\n\"总体\"//该角色当前对<user>性渴望的严重程度、解决方式、性幻想方向\n\"部位\":{}//列出三个该角色最渴望的三个<user>身体部位，值是该角色对其的第一人称评价\n}\n}\nnpc在正文中的相关表现必须严格遵循其档案中的nsfw字段(若有)。\n\n","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":90,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":3}}}