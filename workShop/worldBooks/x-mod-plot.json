{"entries":{"0":{"key":[],"keysecondary":[],"comment":" å‰§æƒ…å’Œä¼ç¬”æ ¼å¼","content":" \n<%_  \nvar double_api= getLocalVar(\"double_api\")|| \"false\";\nvar batches = getLocalVar(\"batches\")|| 1;\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 2) ){\n_%>\ngame.set(storyline_rules, {\ndesc: `\nå‰§æƒ…çº¿ï¼ˆstorylinesï¼‰çš„ç”Ÿæˆå’Œæ›´æ–°è§„èŒƒã€‚\n**æ ¸å¿ƒåŸåˆ™ï¼šåªè®°å½•â€œå…³é”®äº‹ä»¶â€ï¼Œé¿å…â€œæµæ°´è´¦â€ã€‚**\nä¸€ä¸ªäº‹ä»¶æ˜¯å¦â€œå…³é”®â€å¹¶å€¼å¾—è¢«è®°å½•ï¼Œå¿…é¡»æ»¡è¶³ä»¥ä¸‹ã€é‡è¦æ€§æ ‡å‡†ã€‘ä¸­è‡³å°‘ä¸€é¡¹ï¼š\n1.çŠ¶æ€æ”¹å˜: å¯¼è‡´ä¸€ä¸ªä¸»è¦è§’è‰²ã€ç‰©å“æˆ–ä¸–ç•ŒçŠ¶æ€å‘ç”Ÿæ ¹æœ¬æ€§ã€ä¸å¯é€†çš„æ”¹å˜ (ä¾‹å¦‚ï¼šè§’è‰²æ­»äº¡ã€ç‰©å“è¢«æ¯ã€è”ç›Ÿå»ºç«‹/ç ´è£‚)ã€‚\n2.ç›®æ ‡è¿›å±•: æ˜¾è‘—æ¨è¿›æˆ–é˜»ç¢äº†æŸæ¡å‰§æƒ…çº¿ï¼ˆä¸»çº¿/æ”¯çº¿ï¼‰çš„æ ¸å¿ƒç›®æ ‡ã€‚\n3.ä¿¡æ¯æ­ç¤º:æ­ç¤ºäº†**é‡è¦**çš„èƒŒæ™¯ä¿¡æ¯ï¼Œæˆ–è§£å¼€äº†æŸä¸ªå·²è®°å½•çš„ä¼ç¬”ã€‚å¸¸è§„çš„ä¿¡æ¯æ­ç¤º/è§„åˆ™æ­ç¤ºæ— éœ€è®°å½•ã€‚\n4.ä¼ç¬”åŸ‹ä¸‹: å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ã€æœªæ¥ä¼šäº§ç”Ÿå½±å“çš„è°œå›¢æˆ–æ‚¬å¿µï¼ˆå³éœ€è¦åŒæ—¶åœ¨ foreshadows ä¸­åˆ›å»ºæ–°æ¡ç›®ï¼‰ã€‚\n5.å‰§æƒ…åˆ†å‰: è§¦å‘äº†ä¸€æ¡æ–°çš„æ”¯çº¿æˆ–æš—çº¿ï¼ˆå³éœ€è¦åŒæ—¶åœ¨ storylines ä¸­åˆ›å»ºæ–°æ¡ç›®ï¼‰ã€‚\n6.è½¬æŠ˜ç‚¹: æ ‡å¿—ç€æ•…äº‹è¿›å…¥ä¸€ä¸ªæ–°çš„é˜¶æ®µæˆ–åœºæ™¯ï¼Œä¾‹å¦‚ä¸»è§’åšå‡ºé‡å¤§å†³å®šï¼Œæˆ–æ•…äº‹å‘ç”Ÿåœ°ç‚¹å‘ç”Ÿå…³é”®è½¬ç§»ã€‚\n\nä½ å¿…é¡»å…ˆåœ¨<loreAnalyze>ä¸­ä½¿ç”¨é¢å¤–æ ‡ç­¾å—<plotcheck>åŒ…è£¹æ€è€ƒå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å‘ç”Ÿçš„äº‹ä»¶ç¬¦åˆä¸Šè¿°æ ‡å‡†ã€‚æ²¡æœ‰åˆ™è·³è¿‡æ›´æ–°ï¼Œåªæœ‰ç¬¦åˆæ ‡å‡†çš„ï¼Œæ‰èƒ½åˆ›å»ºæ–°çš„æ¡ç›®ã€‚\n`,\n\nfull_format: {\n// Key: å‰§æƒ…çº¿çš„ä¸­æ–‡æ ‡é¢˜ï¼Œå¿…é¡»å”¯ä¸€ã€‚\n\"${storyline_title_as_key}\": {\n\"type\": \"string\", // \"ä¸»çº¿\", \"æ”¯çº¿\", \"æš—çº¿\"\n\"status\": \"string\", // \"æœªå¼€å§‹\", \"è¿›è¡Œä¸­\", \"å·²æš‚åœ\", \"å·²å®Œæˆ\", \"å·²å¤±è´¥\"\n\"currentEvent\": \"string | null\", // æŒ‡å‘å½“å‰äº‹ä»¶çš„key\n\"triggeredBy\": \"string | null\", // è§¦å‘æ­¤å‰§æƒ…çº¿çš„äº‹ä»¶key\n\"events\": {\n\"${event_key}\": {//å¦‚æ¸…æ™¨çš„èŠ±æŸ\n\"significance\": \"string\", // è¯´æ˜æ­¤äº‹ä»¶ç¬¦åˆå“ªæ¡ã€é‡è¦æ€§æ ‡å‡†ã€‘ã€‚ä¾‹å¦‚ï¼š\"çŠ¶æ€æ”¹å˜ï¼šå¯¼å¸ˆBæ­»äº¡\" æˆ– \"ä¿¡æ¯æ­ç¤ºï¼šè§£å¼€æŠ¤èº«ç¬¦æ¥æºçš„ä¼ç¬”\"ã€‚\n\"sumamry\":\"string\",//äº‹ä»¶çš„ç®€çŸ­æ€»ç»“ã€‚è·Ÿéšå‰§æƒ…å˜åŒ–\n\"status\": \"string\", // \"æœªå¼€å§‹\", \"è¿›è¡Œä¸­\", \"å·²å®Œæˆ\"\n\"linksTo\": \"string | null\", // å…³è”åˆ°çš„å‰§æƒ…çº¿key\n\"outcome\": \"string | null\" // äº‹ä»¶çš„ç»“æœæè¿°ï¼Œä¸“æ³¨äºæ­¤äº‹ä»¶é€ æˆçš„å¯¹äºº/äº‹/ä¸–ç•Œ/ç¯å¢ƒç­‰çš„**å½±å“**\n}\n}\n}\n}\n});\ngame.set(foreshadow_rules, {\ndesc: \"ä¼ç¬”ï¼ˆforeshadowsï¼‰çš„ç”Ÿæˆå’Œæ›´æ–°è§„èŒƒã€‚ç”¨äºè®°å½•æ•…äº‹ä¸­åŸ‹ä¸‹çš„æ‚¬å¿µã€è°œé¢˜åŠå…¶çŠ¶æ€ã€‚Keyç›´æ¥ä½¿ç”¨ä¼ç¬”çš„ä¸­æ–‡æ ‡é¢˜ã€‚\",\nfull_format: {\n\"${foreshadow_title_as_key}\": {\n\"isRevealed\": \"boolean\",\n\"plantedIn\": \"string\",\n\"revealEvent\": \"string | null\",\n\"truth\": \"string | null\"\n}\n}\n});\n<%_  \n}\n_%>\n ","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":600,"position":1,"disable":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"äº‹ä»¶æ¨è¿›","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":false,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"uid":0,"displayIndex":2,"triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"1":{"uid":1,"key":[],"keysecondary":[],"comment":"è‡ªåŠ¨æ€»ç»“event(9æ¡)","content":"<%_\n// =================================================================\n// EJS è„šæœ¬: å‰§æƒ…çº¿äº‹ä»¶æµ“ç¼©æ£€æŸ¥ (storyline_condense_check.ejs)\n// ä½œç”¨: æ£€æŸ¥å‰§æƒ…çº¿ä¸­çš„äº‹ä»¶æ•°é‡ï¼Œå½“è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª\n//       â€œæµ“ç¼©äº‹ä»¶â€çš„é™„åŠ ä»»åŠ¡ï¼Œä»¥é˜²æ­¢å‰§æƒ…è®°å½•å˜æˆæµæ°´è´¦ã€‚\n// =================================================================\n\nvar double_api = getLocalVar(\"double_api\") || \"false\";\nvar batches = getLocalVar(\"batches\") || 1;\n\n// ä»…åœ¨ç‰¹å®šæ¡ä»¶ä¸‹æ‰§è¡Œï¼Œä»¥é¿å…é‡å¤è§¦å‘\nif (double_api === \"false\" || (double_api === \"true\" && batches === 2)) {\n_%>\n<%_\n  // ===== é…ç½®åŒº =====\n  // å‰§æƒ…çº¿ä¸­â€œeventsâ€å¯¹è±¡çš„é”®å€¼å¯¹æ•°é‡é˜ˆå€¼ï¼Œè¶…è¿‡è¿™ä¸ªæ•°é‡å°±éœ€è¦æµ“ç¼©ã€‚\n  const EVENT_COUNT_THRESHOLD = 9;\n\n  // ===== å‡½æ•°å®šä¹‰åŒº =====\n  /**\n   * å®‰å…¨åœ°ä» getLocalVar è·å–æ•°æ®ï¼Œæä¾›å›é€€æœºåˆ¶ã€‚\n   * @param {string} varName - è¦è·å–çš„å˜é‡åã€‚\n   * @returns {object} - è·å–åˆ°çš„æ•°æ®ï¼Œå¦‚æœæ— æ•ˆåˆ™è¿”å›ç©ºå¯¹è±¡ã€‚\n   */\n  function getDataWithFallback_plot(varName) {\n    let data = getLocalVar(varName);\n    const isValid = (d) => d !== null && d !== undefined && typeof d === 'object' && Object.keys(d).length > 0;\n    if (!isValid(data)) {\n      data = getLocalVar(varName); // å†æ¬¡å°è¯•è·å–\n    }\n    return isValid(data) ? data : {};\n  }\n\n  // ===== æ•°æ®è·å– =====\n  // ä»…è·å– global_lore.plot æ•°æ®\n  var plotData = getDataWithFallback_plot(\"assa_data.global_lore.plot\");\n  var storylines = _.get(plotData, 'storylines', {});\n\n  // ===== æ ¸å¿ƒæ£€æŸ¥é€»è¾‘ =====\n  var needsCondenseList = []; // å­˜å‚¨éœ€è¦æµ“ç¼©çš„å‰§æƒ…çº¿ä¿¡æ¯\n\n  // éå†æ‰€æœ‰å‰§æƒ…çº¿\n  for (const storylineTitle in storylines) {\n    const storyline = storylines[storylineTitle];\n\n    // ç¡®ä¿ storyline å’Œ events å­˜åœ¨ä¸”ä¸ºå¯¹è±¡\n    if (storyline && typeof storyline === 'object' && storyline.events && typeof storyline.events === 'object') {\n      const eventCount = Object.keys(storyline.events).length;\n\n      // å¦‚æœäº‹ä»¶æ•°é‡è¶…è¿‡é˜ˆå€¼\n      if (eventCount > EVENT_COUNT_THRESHOLD) {\n        // è®°å½•éœ€è¦å¤„ç†çš„å‰§æƒ…çº¿æ ‡é¢˜\n        needsCondenseList.push(storylineTitle);\n      }\n    }\n  }\n\n  // ===== ç”Ÿæˆæœ€ç»ˆè¾“å‡º =====\n  var finalOutput = '';\n\n  if (needsCondenseList.length > 0) {\n    // å°†éœ€è¦å¤„ç†çš„å‰§æƒ…çº¿æ ‡é¢˜æ ¼å¼åŒ–ï¼Œæ–¹ä¾¿AIé˜…è¯»\n    const storylinesFormatted = needsCondenseList\n      .map(title => `â€œ${title}â€`)\n      .join('ã€');\n\n    // æ„å»ºç»™AIçš„æ¸…æ™°æŒ‡ä»¤\n    finalOutput = `æ£€æµ‹åˆ°ä»¥ä¸‹å‰§æƒ…çº¿çš„äº‹ä»¶è®°å½•è¿‡äºå†—é•¿ï¼š${storylinesFormatted}ã€‚è¿™å¯èƒ½å¯¼è‡´å‰§æƒ…åˆ†æå¤±å»ç„¦ç‚¹ã€‚è¯·å¯¹è¿™äº›å‰§æƒ…çº¿è¿›è¡Œæµ“ç¼©å’Œé‡æ„ã€‚\n\næ“ä½œè¦æ±‚å¦‚ä¸‹ï¼š\n1.  åˆ†æä¸å½’çº³: å›é¡¾æ¯ä¸€æ¡å¾…å¤„ç†å‰§æƒ…çº¿ä¸‹çš„æ‰€æœ‰äº‹ä»¶ï¼Œå°†å…¶å½’çº³ä¸ºæ›´å°‘ã€ä½†æ›´å…·æ¦‚æ‹¬æ€§çš„å‡ ä¸ªæ ¸å¿ƒé˜¶æ®µæˆ–å…³é”®è½¬æŠ˜ç‚¹ï¼ˆå»ºè®®1-3ä¸ªï¼‰ã€‚å…¶ä¸­ï¼Œä¸é‡è¦çš„äº‹ä»¶è¦ç›´æ¥å¿½ç•¥ï¼Œè¶Šé‡å¤§çš„äº‹ä»¶è¶Šè¦å®Œæ•´ä¿ç•™ã€‚\n2.  æ‰§è¡Œæ›´æ–°: åœ¨ <updateMemory> ä¸­ï¼Œä½¿ç”¨ 'delete' æŒ‡ä»¤åˆ é™¤æ—§çš„ 'events' å¯¹è±¡ï¼Œç„¶åä½¿ç”¨ 'memory' æŒ‡ä»¤åœ¨åŸè·¯å¾„ä¸‹é‡æ–°å†™å…¥ä½ å½’çº³æ€»ç»“åçš„ã€å…¨æ–°çš„ 'events' å¯¹è±¡ã€‚\n3.  ä¿æŒè¿è´¯: æ–°çš„äº‹ä»¶æ€»ç»“å¿…é¡»ä¿æŒåŸæœ‰çš„é€»è¾‘é¡ºåºå’Œå› æœå…³ç³»ï¼Œå¹¶æ­£ç¡®æ›´æ–° 'significance' å­—æ®µä»¥åæ˜ å…¶æ ¸å¿ƒä»·å€¼ã€‚`;\n  }\n%>\n<% if (finalOutput) { %>\ngame.set('addition task:æµ“ç¼©å¹¶é‡æ„å‰§æƒ…çº¿äº‹ä»¶', `\n<%= finalOutput %>\n`)\n<% } %>\n<% } %>","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":91,"position":4,"disable":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":1,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"800502":{"uid":800502,"displayIndex":0,"comment":"[bookmarkconfig]","disable":true,"constant":true,"selective":false,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":0,"role":null,"depth":0,"order":1000,"content":"{\n  \"data-tab\": \"global_plot\",\n  \"text\": \"plot\",\n  \"position\": 0\n}","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":null,"cooldown":null,"delay":null,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"918882":{"uid":918882,"displayIndex":1,"comment":"plotæ•°æ®å±•ç¤ºğŸ“™","disable":false,"constant":true,"selective":true,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":0,"role":null,"depth":0,"order":1000,"content":"<%_\n//å·¥å…·å‡½æ•°\nfunction getDataWithFallback(varName) {\n    let data = getLocalVar(varName);\n    const isValid = (data) => {\n        if (data === null || data === undefined) {\n            return false;\n        }\n        if (typeof data === 'object' && data !== null) {\n            if (Array.isArray(data)) {\n                return data.length > 0;\n            }\n            return Object.keys(data).length > 0;\n        }\n        return true;\n    };\n    if (!isValid(data)) {\n        data = getLocalVar(varName);\n    }\n    return data;\n}\n\n/**\n * æ ¼å¼åŒ–å¯¹è±¡ä¸ºå¸¦ç¼©è¿›å’Œæ¢è¡Œçš„å­—ç¬¦ä¸²ï¼Œæ”¯æŒé€’å½’æ¢è¡Œã€‚\n * @param {object} data - éœ€è¦æ ¼å¼åŒ–çš„å¯¹è±¡ã€‚\n * @param {number} [indent=0] - åˆå§‹ç¼©è¿›çº§åˆ«ã€‚\n * @param {boolean} [is_huanhang=true] - æ˜¯å¦å¯¹æ‰€æœ‰å±‚çº§çš„å­é”®éƒ½è¿›è¡Œæ¢è¡Œå’Œç¼©è¿›ã€‚\n */\nfunction formatObjectGraceSimple(data, indent = 0, is_huanhang = true) {\n    // å¦‚æœä¸æ˜¯å¯¹è±¡ï¼Œç›´æ¥è¿”å›JSONå­—ç¬¦ä¸²\n    if (typeof data !== 'object' || data === null) {\n        return JSON.stringify(data);\n    }\n\n    // å®šä¹‰ç¼©è¿›å­—ç¬¦ä¸²\n    const indentString = ' '.repeat(indent);\n    const nextIndentString = ' '.repeat(indent);\n    // --- å¤„ç†æ•°ç»„ ---\n    if (Array.isArray(data)) {\n        if (data.length === 0) return '[]';\n\n        // å¦‚æœä¸éœ€è¦é€’å½’æ¢è¡Œï¼Œåˆ™å°†æ•°ç»„å…ƒç´ åœ¨ä¸€è¡Œå†…æ˜¾ç¤º\n        if (!is_huanhang) {\n            const items = data.map(item => formatObjectGraceSimple(item, 0, false));\n            return '[' + items.join(', ') + ']';\n        }\n\n        // é€’å½’æ ¼å¼åŒ–æ•°ç»„çš„æ¯ä¸€é¡¹\n        const items = data.map(item =>\n            nextIndentString + formatObjectGraceSimple(item, indent + 1, is_huanhang)\n        );\n        \n        return '[\\n' + items.join(',\\n') + '\\n' + indentString + ']';\n    }\n\n    // --- å¤„ç†å¯¹è±¡ ---\n    // æ ¹æ®_filterå’Œ_showInEJSå±æ€§åˆ¤æ–­æ˜¯å¦éšè—\n    const shouldFilter = data._filter === true || data._filter === 'true';\n    const showInEJS = data._showInEJS === false || data._showInEJS === 'false';\n    if (shouldFilter && showInEJS) {\n        return '\"[å·²éšè—]\"';\n    }\n\n    // è¿‡æ»¤æ‰ä»¥ä¸‹åˆ’çº¿å¼€å¤´çš„é”®\n    const keys = Object.keys(data).filter(key => !key.startsWith('_'));\n    if (keys.length === 0) return '{}';\n\n    // æ ¼å¼åŒ–å¯¹è±¡çš„æ¯ä¸ªé”®å€¼å¯¹\n    const formattedLines = keys.map(key => {\n        let value = data[key];\n        let valueString;\n\n        // ç‰¹æ®Šå¤„ç†éœ€è¦éšè—çš„å­å¯¹è±¡\n        if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n            if (value._showInEJS === false || value._showInEJS === 'false') {\n                if (value._filter === true || value._filter === 'true') {\n                    const isProtected = value._is_protected === true || value._is_protected === 'true';\n                    const protectionMark = isProtected ? ' //æ­¤å­—æ®µç¦æ­¢åˆ é™¤ï¼' : '';\n                    valueString = '\"[å·²éšè—]\"' + protectionMark;\n                } else {\n                    valueString = formatObjectGraceSimple(value, indent + 1, is_huanhang);\n                }\n            } else {\n                valueString = formatObjectGraceSimple(value, indent + 1, is_huanhang);\n            }\n        } else {\n            valueString = formatObjectGraceSimple(value, indent + 1, is_huanhang);\n        }\n\n        // å¦‚æœä¸éœ€è¦é€’å½’æ¢è¡Œï¼Œåˆ™é”®å’Œå€¼åœ¨ä¸€è¡Œ\n        if (!is_huanhang) {\n            return `\"${key}\": ${valueString}`;\n        }\n\n        // å¦åˆ™ï¼Œé”®å’Œå€¼åœ¨æ–°è¡Œå¹¶å¸¦ç¼©è¿›\n        return `${nextIndentString}\"${key}\": ${valueString}`;\n    });\n\n    // è·å–å½“å‰å¯¹è±¡çš„ä¿æŠ¤æ ‡è®°\n    const isCurrentProtected = data._is_protected === true || data._is_protected === 'true';\n    const protectionMark = isCurrentProtected ? ' //æ­¤å­—æ®µç¦æ­¢åˆ é™¤ï¼' : '';\n\n    // å¦‚æœä¸éœ€è¦é€’å½’æ¢è¡Œï¼Œåˆ™å°†æ‰€æœ‰é”®å€¼å¯¹æ‹¼æ¥åœ¨ä¸€è¡Œ\n    if (!is_huanhang) {\n        // å¯¹äºé¡¶å±‚è°ƒç”¨ï¼Œè¿˜æ˜¯éœ€è¦æ¢è¡Œ\n        if (indent === 0) {\n              \n             return '{\\n' + formattedLines.map(line => nextIndentString + line).join(',\\n') + '\\n}' + protectionMark;\n        }\n        return '{' + formattedLines.join(', ') + '}' + protectionMark;\n    }\n \n    return '{\\n' + formattedLines.join(',\\n') + '\\n' + indentString + '}' + protectionMark;\n}\n\nfunction cleanObjectRecursively(obj) {\n    if (typeof obj !== 'object' || obj === null || Array.isArray(obj)) {\n        return obj;\n    }\n    const cleaned = {};\n    const allKeys = Object.keys(obj);\n\n    for (let key of allKeys) {\n        if (key.startsWith('_')) {\n            continue;\n        }\n        const value = obj[key];\n        if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n            let rawShowValue = value._showInEJS;\n            if (rawShowValue === false || rawShowValue === 'false') {\n                const shouldFilter = value._filter === true || value._filter === 'true';\n                if (!shouldFilter) {\n                    cleaned[key] = cleanObjectRecursively(value);\n                } else {\n                    cleaned[key] = \"[å·²éšè—]\";\n                }\n                continue;\n            }\n            cleaned[key] = cleanObjectRecursively(value);\n        } else {\n            cleaned[key] = value;\n        }\n    }\n    return cleaned;\n}\n\nif (typeof assaData === 'undefined') {\n    var assaData = getDataWithFallback(\"assa_data\");\n}\nif(!getLocalVar(\"assa_data.global_lore.plot\")){setLocalVar(\"assa_data.global_lore.plot\",{\"storylines\":{},\"foreshadows\":{}});}//åˆå§‹åŒ–\n\n// è·å–æ•°æ®\nvar global_plot_grqq7e = formatObjectGraceSimple(_.get(assaData, 'global_lore.plot', {}), 0, true);\n_%>\n\ngame.load('global_lore.plot',`\ndesc:'è®°å½•å½“å‰çš„ä¸»çº¿å‰§æƒ…/æ”¯çº¿å‰§æƒ…/æš—çº¿å‰§æƒ…/ä¼ç¬”ç­‰çš„ç›¸å…³ä¿¡æ¯',\n    <%_\n    var double_api = String(getLocalVar(\"double_api\") || \"false\");\n    var batch = Number(getLocalVar(\"batch\") || 1);\n   if (double_api === \"false\" || (double_api === \"true\" && batch === 1)) {\n    _%> notice: ä½ åœ¨ç”Ÿæˆæ­£æ–‡æ—¶ï¼Œå¿…é¡»æ³¨æ„ä»¥ä¸‹å‰§æƒ…ä¿¡æ¯ï¼Œåœ¨åˆé€‚çš„æ—¶æœºæ¨è¿›å‰§æƒ…ã€‚'<%_\n    }\n    _%>\n    path: 'global_lore.plot <%=global_plot_grqq7e%>'\n});","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":0,"cooldown":0,"delay":0,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}}}}