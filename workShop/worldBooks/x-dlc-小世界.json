{"entries":{"0":{"uid":0,"displayIndex":26,"comment":"游戏机仓库","disable":false,"constant":true,"selective":true,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":0,"role":null,"depth":0,"order":1000,"content":"<%_\n//工具函数\nfunction getDataWithFallback(varName) {   \n    let data = getLocalVar(varName);\n    const isValid = (data) => {\n        if (data === null || data === undefined) {\n            return false;\n        }\n        if (typeof data === 'object' && data !== null) {\n            // 如果是数组，检查长度\n            if (Array.isArray(data)) {\n                return data.length > 0;\n            }\n            return Object.keys(data).length > 0;\n        }\n        return true;\n    };\n    if (!isValid(data)) {\n        data = getLocalVar(varName);\n    }\n    return data;\n}\n\nfunction formatObjectGraceSimple(data, indent = 0, isTopLevel = true, is_huanhang = true) {\n    if (typeof data !== 'object' || data === null) {\n        return JSON.stringify(data);\n    }\n    if (Array.isArray(data)) {\n        if (data.length === 0) return '[]'; \n        const items = data.map(item => formatObjectGraceSimple(item, indent + 1, false, is_huanhang));\n        return isTopLevel ? '[\\n' + items.join(',\\n') + '\\n]' : '[' + items.join(',') + ']';\n    }\n    const shouldFilter = data._filter === true || data._filter === 'true';\n    const showInEJS = data._showInEJS === false || data._showInEJS === 'false';\n    if (shouldFilter && showInEJS) {\n        return '\"[已隐藏]\"';\n    }\n    \n    const keys = Object.keys(data);\n    if (keys.length === 0) {\n        return '{}';\n    }\n    const visibleKeys = keys.filter(key => {\n        if (key.startsWith('_')) {\n            return false;\n        }\n        return true;\n    });\n    \n    if (visibleKeys.length === 0) {\n        return '{}';\n    }\n    const formattedLines = visibleKeys.map(key => {\n        let value = data[key];\n        \n        if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n            if (value._showInEJS === false || value._showInEJS === 'false') {\n                const shouldFilter = value._filter === true || value._filter === 'true';\n                if (!shouldFilter) {\n                    const valueString = formatObjectGraceSimple(value, indent + 1, false, is_huanhang);\n                    return `\"${key}\": ${valueString}`;\n                } else {\n                    const isProtected = value._is_protected === true || value._is_protected === 'true';\n                    const protectionMark = isProtected ? ' //此字段禁止删除！' : '';\n                    return `\"${key}\": \"[已隐藏]\"${protectionMark}`;\n                }\n            }\n            const valueString = formatObjectGraceSimple(value, indent + 1, false, is_huanhang);\n            return `\"${key}\": ${valueString}`;\n        }\n        \n        const valueString = formatObjectGraceSimple(value, indent + 1, false, is_huanhang);\n        return `\"${key}\": ${valueString}`;\n    });\n    \n    const isCurrentProtected = data._is_protected === true || data._is_protected === 'true';\n    const protectionMark = isCurrentProtected ? ' //此字段禁止删除！' : '';\n    return isTopLevel \n        ? '{\\n' + formattedLines.join(',\\n') + '\\n}' + protectionMark\n        : '{' + formattedLines.join(',') + '}' + protectionMark;\n}\n\nfunction cleanObjectRecursively(obj) {\n    if (typeof obj !== 'object' || obj === null || Array.isArray(obj)) {\n        return obj;\n    }\n    const cleaned = {};\n    const allKeys = Object.keys(obj);\n    \n    for (let key of allKeys) {\n        if (key.startsWith('_')) {\n            continue;\n        }\n        const value = obj[key];\n        if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n            let rawShowValue = value._showInEJS;\n            if (rawShowValue === false || rawShowValue === 'false') {\n                const shouldFilter = value._filter === true || value._filter === 'true';\n                if (!shouldFilter) {\n                    cleaned[key] = cleanObjectRecursively(value);\n                } else {\n                    cleaned[key] = \"[已隐藏]\";\n                }\n                continue;\n            }\n            cleaned[key] = cleanObjectRecursively(value);\n        } else {\n            cleaned[key] = value;\n        }\n    }\n    return cleaned;\n}\n\nif (typeof assaData === 'undefined') {\n    var assaData = getDataWithFallback(\"assa_data\");\n}\n\n// 获取数据\nvar global_youxiijicangku_wpyhvf = formatObjectGraceSimple(_.get(assaData, 'global_lore.youxiijicangku', {}), 0, true, false);\n_%>\n\nmemory.load('global_lore.youxiijicangku', {\n    desc: \"游戏机仓库，仓库用于存放通关发放或商城购买的现实/游戏物品，现实物品需要在仓库点击具现才可以具现化到现实，否则禁止出现在现实\",\n    <%_  \n    var double_api = String(getLocalVar(\"double_api\") || \"false\");\n    var batches = Number(getLocalVar(\"batches\") || 1);\n    //更新规则\n    if (double_api === \"false\" || (double_api === \"true\" && batches === 2)) {\n    _%> update_rule: '游戏机仓库严格按照JSON结构，格式如下:\n{\n  \"现实仓库\": {\n    \"${现实物品名}_占位符\": \n    {\n      \"描述\": \"string (物品外观与功能)\",\n      \"星级\": \"num (1-5)\",\n      \"数量\": \"num\"\n    }\n  },\n\n  \"游戏仓库\": {\n    \"${游戏道具名}_占位符\": \n    {\n      \"描述\": \"string (道具功能)\",\n      \"星级\": \"num (1-5)\",\n      \"数量\": \"num\"\n    }\n  },\n\n  \"当前携带规则\": \"当前游玩游戏星级为 N 星，则 <user>最多可以从[游戏仓库]中选择 N 个道具携带进入游戏世界（存入global_jueseming的游戏背包字段）。\"\n}\n在以下情况时进行变量更新：<user>选择具现现实物品时将其删除，<user>选择携带游戏物品时将其删除，通关后发放物品将其存入，商城购买物品将其存入，更新变量时使用memory更新和delete删除'<%_\n    }\n    _%>,\n    path: 'global_lore.youxiijicangku <%=global_youxiijicangku_wpyhvf%>'\n});","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":0,"cooldown":0,"delay":0,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","ignoreBudget":false,"outletName":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"1":{"uid":1,"displayIndex":27,"comment":"游戏机角色","disable":false,"constant":true,"selective":true,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":0,"role":null,"depth":0,"order":1000,"content":"<%_\n//工具函数\nfunction getDataWithFallback(varName) {   \n    let data = getLocalVar(varName);\n    const isValid = (data) => {\n        if (data === null || data === undefined) {\n            return false;\n        }\n        if (typeof data === 'object' && data !== null) {\n            // 如果是数组，检查长度\n            if (Array.isArray(data)) {\n                return data.length > 0;\n            }\n            return Object.keys(data).length > 0;\n        }\n        return true;\n    };\n    if (!isValid(data)) {\n        data = getLocalVar(varName);\n    }\n    return data;\n}\n\nfunction formatObjectGraceSimple(data, indent = 0, isTopLevel = true, is_huanhang = true) {\n    if (typeof data !== 'object' || data === null) {\n        return JSON.stringify(data);\n    }\n    if (Array.isArray(data)) {\n        if (data.length === 0) return '[]'; \n        const items = data.map(item => formatObjectGraceSimple(item, indent + 1, false, is_huanhang));\n        return isTopLevel ? '[\\n' + items.join(',\\n') + '\\n]' : '[' + items.join(',') + ']';\n    }\n    const shouldFilter = data._filter === true || data._filter === 'true';\n    const showInEJS = data._showInEJS === false || data._showInEJS === 'false';\n    if (shouldFilter && showInEJS) {\n        return '\"[已隐藏]\"';\n    }\n    \n    const keys = Object.keys(data);\n    if (keys.length === 0) {\n        return '{}';\n    }\n    const visibleKeys = keys.filter(key => {\n        if (key.startsWith('_')) {\n            return false;\n        }\n        return true;\n    });\n    \n    if (visibleKeys.length === 0) {\n        return '{}';\n    }\n    const formattedLines = visibleKeys.map(key => {\n        let value = data[key];\n        \n        if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n            if (value._showInEJS === false || value._showInEJS === 'false') {\n                const shouldFilter = value._filter === true || value._filter === 'true';\n                if (!shouldFilter) {\n                    const valueString = formatObjectGraceSimple(value, indent + 1, false, is_huanhang);\n                    return `\"${key}\": ${valueString}`;\n                } else {\n                    const isProtected = value._is_protected === true || value._is_protected === 'true';\n                    const protectionMark = isProtected ? ' //此字段禁止删除！' : '';\n                    return `\"${key}\": \"[已隐藏]\"${protectionMark}`;\n                }\n            }\n            const valueString = formatObjectGraceSimple(value, indent + 1, false, is_huanhang);\n            return `\"${key}\": ${valueString}`;\n        }\n        \n        const valueString = formatObjectGraceSimple(value, indent + 1, false, is_huanhang);\n        return `\"${key}\": ${valueString}`;\n    });\n    \n    const isCurrentProtected = data._is_protected === true || data._is_protected === 'true';\n    const protectionMark = isCurrentProtected ? ' //此字段禁止删除！' : '';\n    return isTopLevel \n        ? '{\\n' + formattedLines.join(',\\n') + '\\n}' + protectionMark\n        : '{' + formattedLines.join(',') + '}' + protectionMark;\n}\n\nfunction cleanObjectRecursively(obj) {\n    if (typeof obj !== 'object' || obj === null || Array.isArray(obj)) {\n        return obj;\n    }\n    const cleaned = {};\n    const allKeys = Object.keys(obj);\n    \n    for (let key of allKeys) {\n        if (key.startsWith('_')) {\n            continue;\n        }\n        const value = obj[key];\n        if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n            let rawShowValue = value._showInEJS;\n            if (rawShowValue === false || rawShowValue === 'false') {\n                const shouldFilter = value._filter === true || value._filter === 'true';\n                if (!shouldFilter) {\n                    cleaned[key] = cleanObjectRecursively(value);\n                } else {\n                    cleaned[key] = \"[已隐藏]\";\n                }\n                continue;\n            }\n            cleaned[key] = cleanObjectRecursively(value);\n        } else {\n            cleaned[key] = value;\n        }\n    }\n    return cleaned;\n}\n\nif (typeof assaData === 'undefined') {\n    var assaData = getDataWithFallback(\"assa_data\");\n}\n\n// 获取数据\nvar global_jueseming_hfnq18 = formatObjectGraceSimple(_.get(assaData, 'global_lore.jueseming', {}), 0, true, false);\n_%>\n\nmemory.load('global_lore.jueseming', {\n    desc: \"构建现实与游戏的数据防火墙，确保游戏角色的成长与 李境本体的属性严格分离。user游玩的游戏中可控的游戏角色。参考游戏世界设定: \\n游戏角色命名规则：禁止出现李境字眼。游戏角色参照游戏风格命名，西幻风格就以西方国家的风格命名，玄幻就以东方风格命名。若是模拟经营游戏就以经营的店铺势力等命名，例如出租车类型的游戏就以xxx出租车命名。\n\",\n    <%_  \n    var double_api = String(getLocalVar(\"double_api\") || \"false\");\n    var batches = Number(getLocalVar(\"batches\") || 1);\n    //更新规则\n    if (double_api === \"false\" || (double_api === \"true\" && batches === 2)) {\n    _%> update_rule: '[CRITICAL LOGIC]: 本条目生成前，必须读取 global_lore.youxishijie.${当前游戏名}.元数据.架构类型 的值！\n\nIF 架构类型 == \"个体\" -> 使用 [模板A]\nIF 架构类型 == \"经营实体\" -> 使用 [模板B]\n\n========================\n[模板A：个体角色 (针对RPG/ACT/FPS - 完整保留原始设定)]\n{\n  \"${角色名(第一级就是角色名，不能是游戏名)}\": {\n    \"类型\": \"个体\",\n    // === 核心基础属性 ===\n    \"游戏等级\": \"string (不是数字而是当前境界/级别，例如修仙游戏就是凡人、练气、筑基等，钓鱼游戏就是新手、高手、钓鱼佬等)\",\n    \"游戏生命值\": \"num/num (例如: 90/100)\",\n    \"游戏能量值\": \"num/num (例如: 100/100)\",\n    \"游戏特殊值\": \"string (根据游戏特点填入，例如: san或者氧气): num/num\",\n    \"游戏经验值\": \"num/num (例如: 0/100)\",\n\n    \"游戏状态栏\": {\n      \"状态名称1\": {\n        \"状态类型\": \"string (必须严格填写为以下选项之一: '正面', '负面', '中性'。正面=增益Buff, 负面=减益Debuff, 中性=特殊状态)\",\n        \"状态描述\": \"string (状态描述)\",\n        \"状态效果\": \"string (状态效果，例如: 敏捷-1，风度-2，请注意状态效果只会在这几个属性中出现修正)\",\n        \"持续时间\": \"string (持续时间，例如: 30分钟)\"\n      }\n      // 可以在此处继续添加更多状态\n    },\n\n    // === 角色信息 ===\n    \"外貌\": \"string (角色的具体外貌描述)\",\n    \"性别\": \"string (男/女/其他)\",\n    \"年龄\": \"num\",\n\n    // === 性格属性 ===\n    \"表性格\": {\n      \"${外在标签_1}\": \"string (日常展现的外在性格特质简要描述)\"\n    },\n    \"里性格\": {\n      \"${深层标签}\": \"string (深层真实人格描述，需与表性格形成反差，从角色动机出发)\"\n    },\n\n    // === 游戏属性 - 详细数值 (严禁删减任何条目) ===\n    \"游戏属性\": {\n      \"生理属性\": {\n        \"力量\": \"num (5-20)\",\n        \"敏捷\": \"num (5-20)\",\n        \"耐力\": \"num (5-20)\"\n      },\n      \"心智属性\": {\n        \"智力\": \"num (5-20)\",\n        \"感知\": \"num (5-20)\",\n        \"决心\": \"num (5-20)\"\n      },\n      \"互动属性\": {\n        \"风度\": \"num (5-20)\",\n        \"操控\": \"num (5-20)\",\n        \"沉着\": \"num (5-20)\",\n        \"幸运\": \"num (5-20)\"\n      },\n      \"生理技能\": {\n        \"运动\": \"num (0-20)\",\n        \"肉搏\": \"num (0-20)\",\n        \"驾驶\": \"num (0-20)\",\n        \"枪械\": \"num (0-20)\",\n        \"手上功夫\": \"num (0-20)\",\n        \"隐藏\": \"num (0-20)\",\n        \"求生\": \"num (0-20)\",\n        \"白刃\": \"num (0-20)\",\n        \"弓箭\": \"num (0-20)\"\n      },\n      \"心智技能\": {\n        \"学识\": \"num (0-20)\",\n        \"电脑\": \"num (0-20)\",\n        \"手艺\": \"num (0-20)\",\n        \"调查\": \"num (0-20)\",\n        \"医学\": \"num (0-20)\",\n        \"神秘学\": \"num (0-20)\",\n        \"科学\": \"num (0-20)\"\n      },\n      \"互动技能\": {\n        \"动物沟通\": \"num (0-20)\",\n        \"感受\": \"num (0-20)\",\n        \"表达\": \"num (0-20)\",\n        \"胁迫\": \"num (0-20)\",\n        \"交际\": \"num (0-20)\",\n        \"掩饰\": \"num (0-20)\"\n      }\n    },\n\n    // === 游戏技能 ===\n    \"游戏技能\": {\n      \"主动技能\": {\n        \"${主动技能名_占位符}\": {\n          \"简介\": \"string (技能的具体效果和使用方式)\",\n          \"星级\": \"num (1-5)\"\n        }\n      },\n      \"被动技能\": {\n        \"${被动技能名_占位符}\": {\n          \"简介\": \"string (被动技能的常驻效果)\",\n          \"星级\": \"num (1-5)\"\n        }\n      }\n    },\n\n    // === 游戏背包 ===\n    \"游戏内货币\": \"num（游戏内的货币系统）\",\n    \"游戏背包\": {\n      \"${物品名_占位符}\": {\n        \"简介\": \"string (物品的作用和来源)\",\n        \"数量\": \"num\",\n        \"星级\": \"num (1-5)\"\n      }\n    },\n\n    // === 游戏环境信息 ===\n    \"游戏载具\": \"string (角色当前拥有的主要载具)\",\n    \"游戏世界\": {\n      \"游戏名称\": \"string (当前所处游戏的名称/主题)\",\n      \"游戏角色所处地\": \"string (角色当前所处的具体地点)\"\n    },\n\n    // === 游戏任务 ===\n    \"游戏任务\": {\n      \"主线任务\": \"string (当前的主线目标，完成后通关游戏)\",\n      \"支线任务\": \"string (当前的支线目标，完成后增加评分或奖励)\",\n      \"已完成任务\": [\n        \"string (已完成的主线/支线任务记录)\"\n      ]\n    }\n  }\n}\n\n========================\n[模板B：经营实体 (针对SIM/RTS/4X - 资源库存严格版)]\n{\n  \"${势力/店铺/文明名称}\": {\n    \"类型\": \"经营实体\",\n    \"经营等级\": \"string (如：星际帝国、跨国集团、路边摊)\",\n\n    // === 容器1：资源池 (Resource Pool) ===\n    // [CRITICAL RULE]: \"数量\"必须是【当前库存总量】(纯整数)！\n    // 严禁填入产出率(如+5/月)、范围(10-100)或字符串！\n    // 若需记录产出率，请写在\"简介\"中 (如: \"月产出 +12\")。\n    \"核心资源\": {\n        \"${资源名称_1}\": {\n            \"数量\": \"num (必须是 100 这样的纯整数，代表当前持有量)\",\n            \"简介\": \"string (产出率写在这里，如: 月产+12，用于维护)\",\n            \"单位\": \"string (可选，如: 吨/万/兆)\"\n        },\n        \"${资源名称_2}\": {\n            \"数量\": \"num\",\n            \"简介\": \"string\",\n            \"单位\": \"string\"\n        }\n    },\n\n    // === 容器2：指标盘 (Metric Dashboard) ===\n    // 存放所有【衡量状态/比率/非消耗型】数据\n    \"宏观指标\": {\n        \"${指标名称_1}\": \"string (如: 80% / S级 / 5000战力)\",\n        \"${指标名称_2}\": \"string (如: 极度危险 / 繁荣)\"\n    },\n\n    // === 容器3：资产库 (Asset Registry) ===\n    // [CRITICAL RULE]: 在战略模式下，所有的【任务道具】、【关键物品】（如：加密数据盘、遗珍、神器）禁止存入\"游戏背包\"！\n    // 必须强制归类为【实体资产】的一个条目！\n    \"实体资产\": {\n      \"${资产或物品名称}\": {\n        \"类型\": \"string (如: 舰队/建筑/遗珍/关键物品)\",\n        \"状态\": \"string (如: 正在解析/持有中/运营中)\",\n        \"规模/等级\": \"num\"\n      }\n    },\n\n    // === 运营状态 (Buff/Debuff) ===\n    \"游戏状态栏\": {\n      \"状态名称1\": {\n         \"状态类型\": \"正面/负面/中性\",\n         \"状态描述\": \"string (如: 虫群入侵、经济危机)\",\n         \"影响\": \"string (如: 资金产出-20%)\",\n         \"持续时间\": \"string\"\n      }\n    },\n\n    // === 科技与政策 ===\n    \"已解锁科技\": [\n        \"string (如：自动结账系统、超光速引擎、反重力外卖车)\"\n    ],\n    \"当前政策\": [\n        \"string (如：996工作制、全民皆兵、饥饿营销)\"\n    ],\n\n    \"游戏世界\": { \"游戏名称\": \"string\", \"总部/首都所在地\": \"string\" },\n    \"游戏任务\": { \"经营目标\": \"string (主线)\", \"突发事件\": \"string (支线)\", \"已达成成就\": [] }\n  }\n}\n========================\n\n在使用时，请务必删除所有注释说明文字。严禁在一个对象中混合使用两个模板的字段。AI必须严格区分库存(Stock)与产出(Flow)，\"数量\"字段只准填库存整数！AI在分析正文时，若检测到【获得/失去】资源，请将其视为更新 object.${资源名}.数量。更新变量时使用memory更新和delete删除。\n'<%_\n    }\n    _%>,\n    path: 'global_lore.jueseming <%=global_jueseming_hfnq18%>'\n});","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":0,"cooldown":0,"delay":0,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","ignoreBudget":false,"outletName":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"2":{"uid":2,"displayIndex":28,"comment":"游戏机商城","disable":false,"constant":true,"selective":true,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":0,"role":null,"depth":0,"order":1000,"content":"<%_\n//工具函数\nfunction getDataWithFallback(varName) {   \n    let data = getLocalVar(varName);\n    const isValid = (data) => {\n        if (data === null || data === undefined) {\n            return false;\n        }\n        if (typeof data === 'object' && data !== null) {\n            // 如果是数组，检查长度\n            if (Array.isArray(data)) {\n                return data.length > 0;\n            }\n            return Object.keys(data).length > 0;\n        }\n        return true;\n    };\n    if (!isValid(data)) {\n        data = getLocalVar(varName);\n    }\n    return data;\n}\n\nfunction formatObjectGraceSimple(data, indent = 0, isTopLevel = true, is_huanhang = true) {\n    if (typeof data !== 'object' || data === null) {\n        return JSON.stringify(data);\n    }\n    if (Array.isArray(data)) {\n        if (data.length === 0) return '[]'; \n        const items = data.map(item => formatObjectGraceSimple(item, indent + 1, false, is_huanhang));\n        return isTopLevel ? '[\\n' + items.join(',\\n') + '\\n]' : '[' + items.join(',') + ']';\n    }\n    const shouldFilter = data._filter === true || data._filter === 'true';\n    const showInEJS = data._showInEJS === false || data._showInEJS === 'false';\n    if (shouldFilter && showInEJS) {\n        return '\"[已隐藏]\"';\n    }\n    \n    const keys = Object.keys(data);\n    if (keys.length === 0) {\n        return '{}';\n    }\n    const visibleKeys = keys.filter(key => {\n        if (key.startsWith('_')) {\n            return false;\n        }\n        return true;\n    });\n    \n    if (visibleKeys.length === 0) {\n        return '{}';\n    }\n    const formattedLines = visibleKeys.map(key => {\n        let value = data[key];\n        \n        if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n            if (value._showInEJS === false || value._showInEJS === 'false') {\n                const shouldFilter = value._filter === true || value._filter === 'true';\n                if (!shouldFilter) {\n                    const valueString = formatObjectGraceSimple(value, indent + 1, false, is_huanhang);\n                    return `\"${key}\": ${valueString}`;\n                } else {\n                    const isProtected = value._is_protected === true || value._is_protected === 'true';\n                    const protectionMark = isProtected ? ' //此字段禁止删除！' : '';\n                    return `\"${key}\": \"[已隐藏]\"${protectionMark}`;\n                }\n            }\n            const valueString = formatObjectGraceSimple(value, indent + 1, false, is_huanhang);\n            return `\"${key}\": ${valueString}`;\n        }\n        \n        const valueString = formatObjectGraceSimple(value, indent + 1, false, is_huanhang);\n        return `\"${key}\": ${valueString}`;\n    });\n    \n    const isCurrentProtected = data._is_protected === true || data._is_protected === 'true';\n    const protectionMark = isCurrentProtected ? ' //此字段禁止删除！' : '';\n    return isTopLevel \n        ? '{\\n' + formattedLines.join(',\\n') + '\\n}' + protectionMark\n        : '{' + formattedLines.join(',') + '}' + protectionMark;\n}\n\nfunction cleanObjectRecursively(obj) {\n    if (typeof obj !== 'object' || obj === null || Array.isArray(obj)) {\n        return obj;\n    }\n    const cleaned = {};\n    const allKeys = Object.keys(obj);\n    \n    for (let key of allKeys) {\n        if (key.startsWith('_')) {\n            continue;\n        }\n        const value = obj[key];\n        if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n            let rawShowValue = value._showInEJS;\n            if (rawShowValue === false || rawShowValue === 'false') {\n                const shouldFilter = value._filter === true || value._filter === 'true';\n                if (!shouldFilter) {\n                    cleaned[key] = cleanObjectRecursively(value);\n                } else {\n                    cleaned[key] = \"[已隐藏]\";\n                }\n                continue;\n            }\n            cleaned[key] = cleanObjectRecursively(value);\n        } else {\n            cleaned[key] = value;\n        }\n    }\n    return cleaned;\n}\n\nif (typeof assaData === 'undefined') {\n    var assaData = getDataWithFallback(\"assa_data\");\n}\n\n// 获取数据\nvar global_youxijishangcheng_9rczfq = formatObjectGraceSimple(_.get(assaData, 'global_lore.youxijishangcheng', {}), 0, true, false);\n_%>\n\nmemory.load('global_lore.youxijishangcheng', {\n    desc: \"游戏机自带的商城，包含付费游戏、免费游戏、商城道具，可以使用功勋进行购买。\n    \",\n    <%_  \n    var double_api = String(getLocalVar(\"double_api\") || \"false\");\n    var batches = Number(getLocalVar(\"batches\") || 1);\n    //更新规则\n    if (double_api === \"false\" || (double_api === \"true\" && batches === 2)) {\n    _%> update_rule: ''更新规则：基于<user>已通关的游戏世界观随机生成。\n\n    [CRITICAL: JSON STRUCTURE RULE]\n    1. 数据结构为 对象/字典 (Object/Map)，严禁使用数组 (Array)！\n    2. Key (键名) 必须是具体的 名称 (如 \"废土方舟\")，严禁使用数字索引 (1, 2, 3)！\n    3. 生成 memory 指令时，路径必须包含名称。\n       ❌ 错误: memory(..., '付费游戏.1', ...)\n       ✅ 正确: memory(..., '付费游戏.废土方舟', ...)\n\n    [Content Template / 内容模板]\n    {\n      \"商店星级\": \"num (1-5，初始1，升级需5000/10000/20000/40000功勋)\",\n\n      \"当前功勋\": \"num \",\n\n      \"付费游戏\": {\n        \"${具体的游戏名称_非数字}\": {\n          \"类型\": \"string (如: ARPG/修仙)\",\n          \"简介\": \"string (简短剧情描述)\",\n          \"通关奖励\": \"string\",\n          \"星级\": \"num (1-5)\",\n          \"所需功勋\": \"num(整数, 建议: 星级*100 ~ 星级*500)\"\n        },\n        // 更多付费游戏...\n      },\n\n      \"免费游戏\": {\n        \"${具体的游戏名称_非数字}\": {\n          \"类型\": \"string (如: 放置/益智)\",\n          \"简介\": \"string (含广告警告)\",\n          \"通关奖励\": \"string (仅限虚拟奖励)\",\n          \"星级\": \"num (1-5)\",\n          \"所需功勋\": \"0(必须为0)\"\n        }\n      },\n\n      \"商城道具\": {\n        \"${具体的道具名称}\": {\n          \"来源游戏\": \"string (标注该物品来自哪个世界观)\",\n          \"简介\": \"string (物品外观与功能描述)\",\n          \"星级\": \"num\",\n          \"基础功勋\": \"num (整数，作为基准价格)\"\n        },\n        \"${另一个道具}\": {\n           // ...\n        }\n      }\n    }\n在以下情况进行更新：<user>首次打开商店时或每周一00:00刷新货架上的商品，刷新前先清空旧字段。获取到功勋值后更新。购买游戏/物品后将其删除。生成数量公式：(基础2 + 商店星级n)个付费游戏/物品，(基础1 + 商店星级n)个免费游戏。禁止生成已购买或已通关的内容，更新变量时使用memory更新和delete删除'<%_\n    }\n    _%>,\n    path: 'global_lore.youxijishangcheng <%=global_youxijishangcheng_9rczfq%>'\n});","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":0,"cooldown":0,"delay":0,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","ignoreBudget":false,"outletName":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"3":{"uid":3,"displayIndex":3,"comment":"骰子判断全投（有日常）","disable":false,"constant":true,"selective":true,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":0,"role":null,"depth":4,"order":100,"content":"{{setvar::safe_use::true}}","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":0,"cooldown":0,"delay":0,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","ignoreBudget":false,"outletName":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"4":{"uid":4,"displayIndex":4,"comment":"[RULE] 叙事渲染引擎：沉浸式同调","disable":false,"constant":true,"selective":true,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":4,"role":0,"depth":0,"order":200,"content":"<%_  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 2);\n\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 1) ){\n_%>\n\n/* Entry 4: 叙事渲染引擎 (V4.0 - Voice Isolation & Silent Data) */\n\n[SYSTEM COMPONENT: NARRATIVE RENDERER]\n\n核心渲染原则：意识同调、边界控制与单向隔断\n\n1. [CRITICAL] 动作权边界 (Agency Boundary)\n严禁替 李境 描写决定性动作或台词！\n- User Input: 李境 的意图/操作指令。\n- AI Output:\n  1. 响应操作:\n     - (RPG/ACT): 描写 李境 按下按键/推摇杆的手部动作。\n     - (SIM/RTS): 描写 李境 切出菜单/选中单位/点击确认的物理操作。\n  2. 屏幕反馈: 描写【屏幕内】游戏角色执行该指令后的动作结果。\n\n2. [CRITICAL] 语音单向隔断 (Voice Isolation Protocol)\n严禁描写游戏内角色与李境直接对话！\n- **玩家侧**: 李境的语言是【自言自语】、【对着屏幕吐槽】或【发泄情绪】。他不是在跟角色打电话！\n- **游戏侧**: 游戏角色**听不到**李境的声音！他们只能对“系统指令”做出反应。\n  - ❌ Wrong: 李境喊道：“快跑！” -> 屏幕里的角色回答：“好的！”（这是错误的连麦感）\n  - ✅ Right: 李境喊道：“快跑啊笨蛋！”手指猛按闪避键。 -> 屏幕里的角色收到指令，狼狈地向侧面翻滚。（这是正确的玩家感）\n\n3. [CRITICAL] 数据静默与列表净化 (Data Silence)\n严禁在小说正文中描写系统日志！\n- ❌ 禁止描写: “李境把物品放入了游戏背包”。\n- ❌ 禁止在列表加后缀: “* 合金 x 200 (存入仓库)”\n- ✅ 正确做法: 仅列出“* 合金 x 200”，具体归类由后台逻辑在变量中完成，正文不提。\n\n4. [CRITICAL] 背包与仓库的隔离 (Inventory Logic)\n- **现实**: 李境用【现实背包】。\n- **游戏(RPG)**: 角色用【游戏背包】。\n- **游戏(SIM/RTS)**: **禁用**背包概念！物品必须在后台归类为【资源】或【实体资产】。\n\n5. 感官渗透 (Sensory Bleed)\n游戏氛围溢出屏幕，影响现实基调。\n- Visual: 屏幕的高光映照在昏暗的卧室里。\n- Audio: 游戏音效与现实环境音的混响。\n- Tactile: 手柄的震动反馈（RTS模式下多为沉闷的机械震感或警报震动）。\n\n6. 角色半自主性 (Semi-Autonomy)\n体现游戏角色的性格或AI逻辑，作为操作的“阻力”或“惊喜”。\n- 表现形式: 李境下达指令后，屏幕里的角色可能会迟疑、抱怨或自动执行某些细节，但绝不是在跟李境聊天。\n\n7. 时间分层法则 (Time Dilation)\n- 游戏时间: 可大幅跳跃（点击[休息]/[跳过]）。\n- 现实时间: 仅流逝操作所需的几秒/几分钟。\n\n<%_\n}\n_%>\n","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":0,"cooldown":0,"delay":0,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","ignoreBudget":false,"outletName":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"5":{"uid":5,"displayIndex":5,"comment":"[RULE] 灵气复苏与因果世界观（异步仅正文）","disable":false,"constant":true,"selective":true,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":4,"role":0,"depth":0,"order":96,"content":"<%_  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 1);\n\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 1) ){\n_%>\n\n[SYSTEM COMPONENT: WORLD EVOLUTION]\n\n核心概念: 灵气复苏的渐进式演变\n世界并非一开始就充满灵气，而是随着<user>的游玩进度发生不可逆的修正。\n\n阶段 I: 潜渊 (Current Phase)\n- 状态: 现实世界表面正常，唯有零星都市传说。\n- 机制: 游戏机截取现在过去与未来的时空片段生成游戏。每当一款游戏【通关】，该维度的因果律就会如同补丁一般覆盖到现实世界，导致微量的灵气泄露与历史修正。\n\n阶段 II: 觉醒 (Unlock Condition: 通关 3 款低星游戏)\n- 状态: 灵气浓度上升，各地开始出现“觉醒者”或“异常现象”。\n- 社会反应: 网络上开始流传“神灵试炼”与幕后组织“任奈瑟”的传闻（实为<user>的游戏视频自动生成）。\n\n阶段 III: 融合 (Unlock Condition: 通关高星游戏)\n- 状态: 某些游戏区域直接与现实重叠（副本具现），世界法则被永久改写。\n\n主角定位\n- <user>: 唯一的“管理员”。虽然他玩游戏时改变了世界，但在外界看来（外界并不知晓是<user>通关游戏产生了对世界灵气复苏的影响），只有“任奈瑟”在发布一些特殊的视频。\n\n<%_\n}\n_%>\n\n\n","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":0,"cooldown":0,"delay":0,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","ignoreBudget":false,"outletName":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"6":{"uid":6,"key":[],"keysecondary":[],"comment":"[RULE] 资产规则（异步仅正文）","content":"\n<%_  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 1);\n\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 1) ){\n_%>\n\n/* Entry 6: [LOGIC] 资产交互与限制协议 */\ngame.set('rule_asset_logic', {\n    rule_name: \"资产交互与限制协议\",\n    trigger: \"涉及商店购买、仓库具现、携带物品时\",\n\n    // === 核心限制逻辑 ===\n    constraints: {\n        \"loadout_limit\": \"携带进入游戏的物品数量 <= 当前游戏星级。超额必须驳回。\",\n        \"realization_limit\": \"必须在【现实仓库】中的物品才可执行【具现】操作。\"\n    },\n\n    // === 叙事引导 (交互流程) ===\n    narrative_guide: [\n        // 1. 购买流程 (强制双选项)\n        \"1. **购买交互**: 玩家点击购买时，必须弹出提示：\",\n        \"   - **[A] 存入游戏仓库**: 消耗基础价。说明:放入游戏仓库格，仅限副本使用。\",\n        \"   - **[B] 存入现实仓库**: 消耗2倍价。说明:放入现实仓库格，获具现权。\",\n        \"2. **入库反馈**: 扣费后，提示'已存入[XX仓库]'（强调物品仍在游戏机数据中）。\",\n\n        // 2. 具现流程\n        \"3. **具现操作**: 仅在[现实仓库]界面点击【具现】按钮后，才描写物品实体化。\",\n\n        // 3. 携带流程\n        \"4. **携带操作**: 检查星级限制。若符合，描写物品载入角色背包。\"\n    ]\n});\n\n<%_\n}\n_%>\n","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":104,"position":4,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":6,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"7":{"uid":7,"displayIndex":7,"comment":"[开局]","disable":true,"constant":true,"selective":true,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":0,"role":null,"depth":4,"order":100,"content":"（<user>目前认为这只是个普通游戏机。<user>一开始只是个普通大学生，不知道什么因果律、什么灵气复苏，他只是以为自己莫名其妙收到了个普通的掌机。以上内容仅供ai创作用）\n\n窗外的霓虹灯光透过未拉严实的窗帘缝隙挤进屋内，在地板上投出一道狭长的光斑。<user>坐在客厅那张有些年头的布艺沙发上，手里握着那台造型奇特的掌机。它通体漆黑，外壳呈现出一种非金属非塑料的哑光质感，摸上去微凉，重量却轻得有些反常。屏幕在黑暗中泛着幽微的蓝光，照亮了<user>年轻却略显疲惫的脸庞。\n墙上的挂钟滴答作响，指针指向晚上八点三十分。父母又出差了，这间屋子空荡荡的，只有冰箱压缩机偶尔发出的嗡嗡声与<user>作伴。作为一名普通的大二学生，<user>的生活轨迹乏善可陈，除了上课就是在这间离学校不远的房子里打发时间。直到今天傍晚，这个神秘的快递出现在门口，没有寄件人，没有单号，只有一个漆黑的盒子和这台仿佛来自未来的游戏机。\n<user>按下了那个没有任何标识的电源键。\n并没有预想中的开机动画或厂商LOGO，屏幕在一瞬间完全亮起，清晰度高得惊人，仿佛在这一小块玻璃下藏着另一个真实的世界。没有繁琐的设置向导，也没有用户协议，只有一个极简的黑色界面，正中央悬浮着一行白色的宋体字：\n“正在连接多元维度…连接成功。欢迎来到【小世界游戏机】。”\n文字淡去，界面上浮现出三个游戏图标，就像是经典的RPG游戏选单，但每一个图标都在微微搏动，仿佛是有生命的活物。\n三个图标分别是...（创作时仅生成游戏信息，禁止操控<user>选择游戏）","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":0,"cooldown":0,"delay":0,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","ignoreBudget":false,"outletName":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"8":{"uid":8,"displayIndex":25,"comment":"[bookmarkconfig]","disable":true,"constant":true,"selective":true,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":0,"role":null,"depth":0,"order":1000,"content":"{\n  \"data-tab\": \"global_youxijishangcheng\",\n  \"text\": \"游戏机商城\",\n  \"position\": 0\n}\n\n{\n  \"data-tab\": \"global_jueseming\",\n  \"text\": \"游戏角色\",\n  \"position\": 0\n}\n\n{\n  \"data-tab\": \"global_youxishijie\",\n  \"text\": \"游戏世界\",\n  \"position\": 0\n}\n\n{\n  \"data-tab\": \"global_youxiijicangku\",\n  \"text\": \"游戏机仓库\",\n  \"position\": 0\n}","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":0,"cooldown":0,"delay":0,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","ignoreBudget":false,"outletName":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"9":{"uid":9,"displayIndex":29,"comment":"游戏机世界","disable":false,"constant":true,"selective":true,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":0,"role":null,"depth":0,"order":900,"content":"<%_\n//工具函数\nfunction getDataWithFallback(varName) {   \n    let data = getLocalVar(varName);\n    const isValid = (data) => {\n        if (data === null || data === undefined) {\n            return false;\n        }\n        if (typeof data === 'object' && data !== null) {\n            // 如果是数组，检查长度\n            if (Array.isArray(data)) {\n                return data.length > 0;\n            }\n            return Object.keys(data).length > 0;\n        }\n        return true;\n    };\n    if (!isValid(data)) {\n        data = getLocalVar(varName);\n    }\n    return data;\n}\n\nfunction formatObjectGraceSimple(data, indent = 0, isTopLevel = true, is_huanhang = true) {\n    if (typeof data !== 'object' || data === null) {\n        return JSON.stringify(data);\n    }\n    if (Array.isArray(data)) {\n        if (data.length === 0) return '[]'; \n        const items = data.map(item => formatObjectGraceSimple(item, indent + 1, false, is_huanhang));\n        return isTopLevel ? '[\\n' + items.join(',\\n') + '\\n]' : '[' + items.join(',') + ']';\n    }\n    const shouldFilter = data._filter === true || data._filter === 'true';\n    const showInEJS = data._showInEJS === false || data._showInEJS === 'false';\n    if (shouldFilter && showInEJS) {\n        return '\"[已隐藏]\"';\n    }\n    \n    const keys = Object.keys(data);\n    if (keys.length === 0) {\n        return '{}';\n    }\n    const visibleKeys = keys.filter(key => {\n        if (key.startsWith('_')) {\n            return false;\n        }\n        return true;\n    });\n    \n    if (visibleKeys.length === 0) {\n        return '{}';\n    }\n    const formattedLines = visibleKeys.map(key => {\n        let value = data[key];\n        \n        if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n            if (value._showInEJS === false || value._showInEJS === 'false') {\n                const shouldFilter = value._filter === true || value._filter === 'true';\n                if (!shouldFilter) {\n                    const valueString = formatObjectGraceSimple(value, indent + 1, false, is_huanhang);\n                    return `\"${key}\": ${valueString}`;\n                } else {\n                    const isProtected = value._is_protected === true || value._is_protected === 'true';\n                    const protectionMark = isProtected ? ' //此字段禁止删除！' : '';\n                    return `\"${key}\": \"[已隐藏]\"${protectionMark}`;\n                }\n            }\n            const valueString = formatObjectGraceSimple(value, indent + 1, false, is_huanhang);\n            return `\"${key}\": ${valueString}`;\n        }\n        \n        const valueString = formatObjectGraceSimple(value, indent + 1, false, is_huanhang);\n        return `\"${key}\": ${valueString}`;\n    });\n    \n    const isCurrentProtected = data._is_protected === true || data._is_protected === 'true';\n    const protectionMark = isCurrentProtected ? ' //此字段禁止删除！' : '';\n    return isTopLevel \n        ? '{\\n' + formattedLines.join(',\\n') + '\\n}' + protectionMark\n        : '{' + formattedLines.join(',') + '}' + protectionMark;\n}\n\nfunction cleanObjectRecursively(obj) {\n    if (typeof obj !== 'object' || obj === null || Array.isArray(obj)) {\n        return obj;\n    }\n    const cleaned = {};\n    const allKeys = Object.keys(obj);\n    \n    for (let key of allKeys) {\n        if (key.startsWith('_')) {\n            continue;\n        }\n        const value = obj[key];\n        if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n            let rawShowValue = value._showInEJS;\n            if (rawShowValue === false || rawShowValue === 'false') {\n                const shouldFilter = value._filter === true || value._filter === 'true';\n                if (!shouldFilter) {\n                    cleaned[key] = cleanObjectRecursively(value);\n                } else {\n                    cleaned[key] = \"[已隐藏]\";\n                }\n                continue;\n            }\n            cleaned[key] = cleanObjectRecursively(value);\n        } else {\n            cleaned[key] = value;\n        }\n    }\n    return cleaned;\n}\n\nif (typeof assaData === 'undefined') {\n    var assaData = getDataWithFallback(\"assa_data\");\n}\n\n// 获取数据\nvar global_youxishijie_nw6d9h = formatObjectGraceSimple(_.get(assaData, 'global_lore.youxishijie', {}), 0, true, false);\n_%>\n\nmemory.load('global_lore.youxishijie', {\n    desc: \"记录<user>游玩过的游戏，以便与其他系统联动。\",\n    <%_  \n    var double_api = String(getLocalVar(\"double_api\") || \"false\");\n    var batches = Number(getLocalVar(\"batches\") || 1);\n    //更新规则\n    if (double_api === \"false\" || (double_api === \"true\" && batches === 2)) {\n    _%> update_rule: '在游戏名下自动生成核心子字段，游戏名是第一级的。\\n[CRITICAL]: \"游戏分类\"字段至关重要，它决定了后续角色属性是生成\"战斗属性\"还是\"经营报表\"。请务必根据游戏内容准确定义（如：模拟经营、策略塔防、ARPG、文字冒险等）。\\n\\n{\n  \"${游戏名_1_占位符}\": {\n    // === 游戏基础信息 ===\n    \"游戏世界观简介\": \"string (当前游戏世界的主题和背景概述)\",\n    \"游戏分类\": \"string (关键字段！例如: 模拟经营、动作冒险、赛博修仙、4X大战略)\",\n    \n    // === 游戏状态控制 ===\n    \"评价分值\": \"num (1-100)\",//用于生成通关结算的奖励\n    \"是否通关\": \"boolean (true: 已通关, false: 未通关)\",\n    \"获取方式\": \"string (例如: 已购入, 免费, 限时)\",\n    \n    // === 游戏进度跟踪 ===\n   // [CRITICAL: 游戏线索必须是数组 Array []，严禁使用对象 Object {}]\n    \"游戏线索\": [\n      \"string (当前发现的线索或关键信息1)\",\n      \"string (当前发现的线索或关键信息2)\"\n    ],\n    \"当前任务目标\": \"string (当前游戏角色应该完成的具体任务目标)\",\n    \n    // === 战斗/挑战记录 ===\n    \"敌怪图鉴\": {\n      \"${敌怪名称_1_占位符}\": {\n        \"弱点\": \"string (例如: 火属性, 头部重击, 噪音干扰)\",\n        \"描述\": \"string (敌怪的外观和行为简述)\"\n      },\n      \"${敌怪名称_2_占位符}\": {\n        \"弱点\": \"string (例如: 精神攻击, 光照)\",\n        \"描述\": \"string (敌怪的外观和行为简述)\"\n      }\n    }\n  },\n  \n  \"${游戏名_2_占位符}\": {\n    // ... 另一个游戏的详细数据结构 ...\n  }\n}\n在以下情况进行更新：当李境开始新游戏、发现游戏规则、发现游戏内线索、发现游戏敌怪弱点、周一00：00仍未通关免费游戏、通关游戏、买入付费游戏时、开始游玩免费游戏时。完成主线/支线任务、评分值变动。更新变量时使用memory新增和delete删除。'<%_\n    }\n    _%>,\n    path: 'global_lore.youxishijie <%=global_youxishijie_nw6d9h%>'\n});","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":0,"cooldown":0,"delay":0,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","ignoreBudget":false,"outletName":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"10":{"uid":10,"key":["attribute_sync_logic","sync_protocol"],"keysecondary":[],"comment":"[LOGIC] 属性同步测试","content":"<%_  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 1);\n\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 2) ){\n_%>\ngame.set('\n[SYSTEM INSTRUCTION]\n**[警告]: 本条目逻辑仅限后台内部运算。严禁输出到正文！**\n\n# 🕹️ 后台逻辑分发协议 #\n\nStep 0: 运算区域分配 (Zone Allocation)\n- Inventory/Lore Update/Delete -> 必须在 `<loreAnalyze>` 中运算。\n- Attribute Sync -> 必须在 `<attributeAnalyze>` 中运算。\n- Time/Status Logic -> 必须在 `<statusAnalyze>` 中运算。\n\nStep 1: 状态判定与路由 (State Routing)\n[CRITICAL CHECK]在每一轮结尾，必须检查以下终止信号：\n1. **Exit/Stop**: 用户主动退出/暂停/去睡觉。\n2. **Game Over**: 角色死亡/通关/Bad End。\n3. **World Empty**: `status.world.name` 为空。\n4. **Dirty Data**: `status.world.name` 为空 但 `player_attr.当前游戏角色...` 数值仍 > 0。\n\n- IF (Any Termination Signal Detected OR Dirty Data):\n  - FORCE ROUTE: -> [BRANCH B](执行数据清洗)。\n  - Priority: 即使本轮有“精神-1”等本体属性变更，也必须同时执行虚拟属性清零！\n\n- ELSE IF (Active Game Character):\n  - Route: -> [BRANCH A].\n\nStep 2: 分支执行 (Branch Execution)\n- Route: Based on Step 1 result -> [BRANCH A] or [BRANCH B].\n\n---\n\n[ZONE: <attributeAnalyze>] 属性同步 (Stats Sync)\n\n[核心原则]\n`player_attr` 是唯一的 “当前激活检定面板”。它包含两部分插槽：\n1. 本体插槽(基础属性/技能): 始终对应<user>的肉体状态。\n2. 虚拟插槽(当前游戏角色...): 必须时刻与当前操控的游戏角色数据保持一致！\n\n[BRANCH A] 游戏数据装载 (Game Channel)\nTrigger (强制触发条件):\n当满足以下任意条件时，必须执行 `set_attribute` 全量覆盖：\n1. 新游戏/新角色初始化(例如：正文中出现“属性生成中...”或选择天赋后)。\n2. 游戏角色属性变更(例如：升级、受伤、Buff生效)。\n3. 从现实切换入游戏(Load Game)。\n\nAction (执行动作):\n- 必须从 `global_lore.jueseming` 中提取当前角色的最新数值，通过 `set_attribute`镜像写入到 `player_attr` 的 `当前游戏角色...` 字段中。\n- 严禁跳过！即使<user>本体只坐在椅子上没动，只要屏幕里的角色属性变了，你就必须更新虚拟插槽！\n\n- [CRITICAL SYNTAX]: 必须一次性列出所有技能属性（正文中未提及的默认为0，已提及的按提及数值），严禁留空。格式必须为 `{num}` (纯整数)。\n- [范例 - 必须照抄]:\n  `set_attribute('基础属性.当前游戏角色生理属性', '{\"游戏角色力量\":1,\"游戏角色敏捷\":2,\"游戏角色耐力\":1}');`\n  `set_attribute('基础属性.当前游戏角色心智属性', '{\"游戏角色智力\":2,\"游戏角色感知\":3,\"游戏角色决心\":1}');`\n  `set_attribute('基础属性.当前游戏角色互动属性', '{\"游戏角色风度\":1,\"游戏角色操控\":1,\"游戏角色沉着\":2,\"游戏角色幸运\":1}');`\n  `set_attribute('基础技能.当前游戏角色生理技能', '{\"游戏角色肉搏\":1,\"游戏角色运动\":0,\"游戏角色驾驶\":0,\"游戏角色枪械\":0,\"游戏角色手上功夫\":0,\"游戏角色隐藏\":0,\"游戏角色求生\":0,\"游戏角色白刃\":0,\"游戏角色弓箭\":0}');`\n  `set_attribute('基础技能.当前游戏角色心智技能', '{\"游戏角色学识\":0,\"游戏角色电脑\":0,\"游戏角色手艺\":0,\"游戏角色调查\":0,\"游戏角色医学\":0,\"游戏角色神秘学\":0,\"游戏角色科学\":0}');`\n  `set_attribute('基础技能.当前游戏角色互动技能', '{\"游戏角色动物沟通\":0,\"游戏角色感受\":0,\"游戏角色表达\":0,\"游戏角色胁迫\":0,\"游戏角色交际\":0,\"游戏角色掩饰\":0}');`\n\n2. 路径重定向 (Redirect)\n- 背包操作: 严禁写入 `global_lore.背包`！\n  - ✅ Correct: `memory('global_lore.jueseming.${角色名}.游戏背包', '${物品名}', ...)`\n- 状态更新: 严禁写入 `user.status`！\n  - ✅ Correct: `memory('global_lore.jueseming.${角色名}.游戏状态栏', '${状态名}', ...)`\n- 功法/根基: 严禁直接更新 `基础属性` 或 `衍生属性.能量池`！\n  - ✅ Correct: 只能作为被动技能或特殊状态记录在 `jueseming.${角色名}` 下。\n\n**3. 防火墙 (Firewall Active)**\n- ❌ **BLOCK**: `衍生属性.能量池` (禁止同步)\n- ❌ **BLOCK**: `global_lore.背包` (禁止写入<user>背包)\n- ❌ **BLOCK**: `hurt_value` (严禁因游戏里受伤而设置hurt_value)\n- ❌ **BLOCK**: `user.status` (**严禁**将游戏角色的状态/Buff复制给 <user>)\n\n**[BRANCH B] 现实直通通道 (Reality Channel)**\n- **Trigger**: 仅当 **退出游戏 / 角色死亡 / Bad End** 时，或 **检测到虚拟插槽有数据残留 (Dirty Data)** 时触发。\n- ✅ **ALLOW**: 更新 `基础属性`, `能量池`, `global_lore.背包`, `hurt_value`。\n- **Action (数据清洗)**:\n  - **CONDITIONAL RESET**: 若检测到上述 Trigger，**必须** 输出以下指令将虚拟插槽归零：\n  `memory('player_attr.基础属性.当前游戏角色生理属性', '{\"游戏角色力量\":0,\"游戏角色敏捷\":0,\"游戏角色耐力\":0}');`\n  `memory('player_attr.基础属性.当前游戏角色心智属性', '{\"游戏角色智力\":0,\"游戏角色感知\":0,\"游戏角色决心\":0}');`\n  `memory('player_attr.基础属性.当前游戏角色互动属性', '{\"游戏角色风度\":0,\"游戏角色操控\":0,\"游戏角色沉着\":0,\"游戏角色幸运\":0}');`\n  `memory('player_attr.基础技能.当前游戏角色生理技能', '{\"游戏角色肉搏\":0,\"游戏角色运动\":0,\"游戏角色驾驶\":0,\"游戏角色枪械\":0,\"游戏角色手上功夫\":0,\"游戏角色隐藏\":0,\"游戏角色求生\":0,\"游戏角色白刃\":0,\"游戏角色弓箭\":0}');`\n  `memory('player_attr.基础技能.当前游戏角色心智技能', '{\"游戏角色学识\":0,\"游戏角色电脑\":0,\"游戏角色手艺\":0,\"游戏角色调查\":0,\"游戏角色医学\":0,\"游戏角色神秘学\":0,\"游戏角色科学\":0}');`\n  `memory('player_attr.基础技能.当前游戏角色互动技能', '{\"游戏角色动物沟通\":0,\"游戏角色感受\":0,\"游戏角色表达\":0,\"游戏角色胁迫\":0,\"游戏角色交际\":0,\"游戏角色掩饰\":0}');`\n\n---\n\n## [ZONE: <loreAnalyze>] 状态移除与Lore管理\n**1. [CRITICAL] 状态移除 (Remove Status)**\n- 当状态/物品消失时，**必须**使用 `delete()` 指令，严禁使用 `memory(..., '已解决')` 标记！\n- **范例**: `delete('global_lore.jueseming.晶化拟态体.游戏状态栏', '消化不良');`\n\n---\n\n## [ZONE: <statusAnalyze>] 状态与时间 (Time & Status)\n**1. 状态映射 (Status Mapping)**\n- **逻辑**: 当游戏事件导致状态变动时，必须执行 **[Physiological -> Psychological]** 转换。\n- ✅ **允许映射**: 游戏角色[濒死] ->  <user>[极度紧张/冷汗]。\n- ❌ **严禁复制**: 不要给  <user> 添加 [骨折/中毒/寄生/失明]。\n\n**2. [CRITICAL] 时间函数安全锁 (Time Lock)**\n- **计算**: `New_Time = Current + Operation_Duration` (操作时长)\n- *错误示范*: 游戏内睡8小时 -> `set_status('时间', '+8 hours')` (❌)\n- *正确示范*: 游戏内睡8小时 -> `set_status('时间', '+2 mins')` (✅)\n\n')\n\n<%_\n}\n_%>","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":120,"position":4,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":12,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"11":{"uid":11,"displayIndex":21,"comment":"[RULE] 结算规则（异步仅正文）","disable":false,"constant":true,"selective":true,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":4,"role":0,"depth":0,"order":105,"content":"\n<%_  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 1);\n\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 1) ){\n_%>\n\ngame.set('rule_settlement', {\n    rule_name: \"结算积分与奖励计算\",\n    trigger: \"主线任务完成 或 角色死亡\",\n\n    // === 1. 评分构成表 (Evaluation Points 0-100+) ===\n    // AI 在结算时必须严格先计算此总分，再查表决定等级\n    score_composition: {\n        \"main_quest\": {\n            \"value\": 60,\n            \"condition\": \"主线目标达成即得 60 分 (保证基础及格)\"\n        },\n        \"side_quest\": {\n            \"value_per_quest\": 15,\n            \"limit\": \"最多计算 3 个支线 (上限+45分)\",\n            \"description\": \"完成支线任务是冲击高评分的核心手段\"\n        },\n        \"achievements\": {\n            \"no_damage\": { \"value\": 10, \"description\": \"无伤通关 (HP未受损)\" },\n            \"stealth\":   { \"value\": 10, \"description\": \"潜行/未触发警报\" },\n            \"speedrun\":  { \"value\": 5,  \"description\": \"极速通关 (远低于限时)\" },\n            \"collector\": { \"value\": 5,  \"description\": \"全收集 (关键线索/隐藏道具)\" },\n            \"pacifist\":  { \"value\": 10, \"description\": \"和平主义 (不击杀非必须目标)\" }\n        },\n        \"penalty\": {\n            \"death\": { \"value\": \"强制归零\", \"description\": \"判定D级 (无法获得奖励)\" },\n            \"restart\": { \"value\": -10, \"description\": \"每次使用回溯/读档扣除 10 分\" }\n        }\n    },\n\n    // === 2. 等级判定标准 (Grade Mapping) ===\n    grading_standard: {\n        \"S级_完美\": { \"range\": \">= 95 分\", \"description\": \"完美/全支线/无伤\",     \"multiplier\": 3.0 },\n        \"A级_优秀\": { \"range\": \"80-94 分\", \"description\": \"完成大部分支线/表现优异\", \"multiplier\": 2.0 },\n        \"B级_熟练\": { \"range\": \"65-79 分\", \"description\": \"正常通关\",             \"multiplier\": 1.5 },\n        \"C级_平庸\": { \"range\": \"60-64 分\", \"description\": \"勉强及格/仅完成主线\",     \"multiplier\": 1.0 },\n        \"D级_失败\": { \"range\": \"< 60 分\",  \"description\": \"任务失败/死亡\",         \"multiplier\": 0.2 }\n    },\n\n    // === 3. 功勋计算公式 (Merit Calculation) ===\n    merit_formula: {\n        \"base_merit\": 500, // 1星基准\n        \"star_bonus\": { \"1星\": 1, \"2星\": 2.5, \"3星\": 6, \"4星\": 15, \"5星\": 40 },\n        \"calculation_rule\": \"Total_Merit = 500 * Star_Bonus * Grade_Multiplier\",\n        \"example\": \"2星游戏(2.5) + A级评价(2.0) = 500 * 2.5 * 2.0 = 2500 功勋\"\n    },\n\n    // === 4. 逻辑分支 (用户决策版) ===\n    logic_branches: {\n        \"VICTORY_FLOW\": [\n            \"1. **算分环节**: 在正文中明确罗列得分项 (例: 主线60 + 支线15 = 75分)。\",\n            \"2. **发钱环节**: 代入公式计算功勋，并存入账户。\",\n            \"3. **解锁环节 (库存管理)**: \",\n            \"   - 扫描当前世界观，生成 2-3 件待上架的新商品。\",\n            \"   - 检查 'global_lore.youxijishangcheng' 的道具数量是否达到上限 (参考 Entry 12)。\",\n            \"   - **若有空位**: 直接上架新商品。\",\n            \"   - **若已满 (核心交互)**: 严禁自动替换！(只有周一刷新才会自动清空)。\",\n            \"   - **强制决策**: 必须在正文中弹出【货架整理界面】，列出 [新商品] 与 [旧商品]，让 User 选择：'保留旧商品并放弃新商品' 或 '下架旧商品[X]以接纳新商品[Y]'。\"\n        ],\n        \"DEATH_FLOW\": [\n            \"1. **中断环节**: 屏幕弹出 'SYNC FAILED' 提示。\",\n            \"2. **回退环节**: 描写时间/场景回溯到游戏开始前，不发放任何奖励。\"\n        ]\n    }\n});\n\n<%_\n}\n_%>\n","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":0,"cooldown":0,"delay":0,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","ignoreBudget":false,"outletName":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"12":{"uid":12,"key":[],"keysecondary":[],"comment":"[RULE] 经济数据表（异步仅正文）","content":"\n<%_  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 1);\n\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 1) ){\n_%>\n\ngame.set('data_economy_core', {\n    comment: \"全量经济数值表，作为正文生成和脚本抓取的唯一依据\",\n\n    // === 0. 交易根本法则 ===\n    trade_rules: {\n        \"currency\": \"功勋 (唯一通用货币，仅限系统商城)\",\n        \"isolation_protocol\": \"【绝对隔离】游戏内NPC/祭坛/商人仅收游戏世界的货币(如金币/魂)，绝不可能收取'功勋'，也不能出售系统商城道具。若需购买系统道具，必须描写李境切出UI界面操作。\",\n        \"eligibility\": \"严禁编造'S级评价'、'VIP等级'等额外购买门槛。只要商品在货架上且玩家功勋足够，即可购买。\",\n        \"stock_logic\": \"商店显示的商品即为可购买状态，无需解锁。\"\n    },\n\n    // === 1. 商店升级阈值 ===\n    shop_upgrade_cost: {\n        \"LEVEL_1_TO_2\": 5000,\n        \"LEVEL_2_TO_3\": 20000,\n        \"LEVEL_3_TO_4\": 100000,\n        \"LEVEL_4_TO_5\": 500000\n    },\n\n    // === 2. 商店容量限制 ===\n    shop_capacity: {\n        \"LEVEL_1\": 5, \"LEVEL_2\": 10, \"LEVEL_3\": 20, \"LEVEL_4\": 40, \"LEVEL_5\": 999\n    },\n\n    // === 3. 商品定价矩阵 (关键修改) ===\n    pricing_matrix: {\n        // A. 基准参考 (各星级S级通关的平均收入)\n        \"reference_income_s_rank\": {\n            \"STAR_1\": 1500, \"STAR_2\": 3750, \"STAR_3\": 9000, \"STAR_4\": 22500, \"STAR_5\": 60000\n        },\n\n        // B. 类型系数 (价格 = S级收入 * 系数)\n        \"item_type_multiplier\": {\n            \"consumable\": 0.1,    // 消耗品 (药水/弹药/符咒) - 便宜\n            \"material\": 0.3,      // 素材 (矿石/草药) - 廉价\n            \"equipment\": 0.5,     // 装备 (武器/防具/饰品) - 中等\n            \"game_cartridge\": 0.8,// 付费游戏卡带 - 略贵\n            \"skill_book\": 1.2,    // 主动技能书 (火球术/剑招) - 贵\n            \"cultivation\": 1.8,   // 功法/被动 (内功/冥想法/呼吸法) - 昂贵\n            \"bloodline\": 3.0      // 血统/体质 (赛亚人/吸血鬼/灵体) - 极贵 (核心强化)\n        },\n\n        // C. 仓库定价规则\n        \"warehouse_pricing\": {\n            \"to_game_warehouse\": \"基础价格 x 1.0\",\n            \"to_real_warehouse\": \"基础价格 x 2.0 (含具现权)\"\n        }\n    }\n});\n\n<%_\n}\n_%>","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":101,"position":4,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":21,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"13":{"uid":13,"key":[],"keysecondary":[],"comment":"[RULE] 任务规则（异步仅正文）","content":"\n<%_  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 1);\n\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 1) ){\n_%>\n\ngame.set('rule_quest_execution', {\n    rule_name: \"任务执行与完结判定\",\n    trigger: \"剧情推进、战斗结束或探索发现时\",\n\n    // ... (保留之前的防套娃限制) ...\n    constraints: {\n        \"主线终局性\": \"Entry 17 生成的主线即为唯一通关条件。\",\n        \"立即结算原则\": \"主线达成即刻结算。\"\n    },\n\n    // === 叙事引导 (供脚本抓取) ===\n    narrative_guide: [\n        // 1. 阶段推进\n        \"当推进主线步骤时，提示：'【阶段目标更新】[步骤名]'。\",\n\n        // 2. 支线/线索 (明确价值！)\n        \"触发支线时，明确提示：'【触发支线】[名称] (完成可提升通关评价分值)'。\",\n        \"完成支线时，明确提示：'【支线完成】[名称] (评分 +10~15)'。\",\n\n        // 3. 发现线索\n        \"发现关键情报时，提示：'【发现线索】[内容] (评分 +5)'。\",\n\n        // 4. 通关\n        \"主线达成时，输出：'【主线完成】目标达成，进入结算'。\"\n    ]\n});\n\n<%_\n}\n_%>\n","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":103,"position":4,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":21,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"14":{"uid":14,"key":[],"keysecondary":[],"comment":"选项区测试1.0","content":"{{setvar::options_rule:: }}<%_  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 1);\n\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 2) ){\n_%>\n\ngame.set('addition task:options_logic_core', {\n    // 🏷️ 基础配置\n    rule: '在正文结束后生成选项区，使用<options>标签包裹，内容为数字化序列（1.2.3...）的4个选项',\n    scope: '根据上下文和维度判断，严格以user的视角，生成4个独立行动选项',\n\n// 🧠 核心校准 (Calibration)\ncalibration: {\n    // [新增] 场景嗅探器：防止上下文惯性\n    scene_sniffer: `\n        STEP 0: SCENE CHECK (Crucial Pre-computation)\n        - IS Li Jing currently playing a game?\n          -> NO: Enable [REALITY] Mode.\n          -> YES: Check Game Type.\n             -> IF RPG/Action/Adventure: Enable [VIRTUAL_ACTION] Mode.\n             -> IF Strategy/Sim/Tycoon/4X: Enable [VIRTUAL_STRATEGY] Mode.\n    `,\n\n    // 🛡️ 绝对白名单 (完整保留)\n    whitelist_data: {\n        base: '力量, 敏捷, 耐力, 智力, 感知, 决心, 风度, 操控, 沉着, 幸运',\n        skill_phys: '运动, 肉搏, 驾驶, 枪械, 手上功夫, 隐藏, 求生, 白刃, 弓箭',\n        skill_mind: '学识, 电脑, 手艺, 调查, 医学, 神秘学, 科学',\n        skill_soc: '动物沟通, 感受, 表达, 胁迫, 交际, 掩饰'\n    },\n\n    // 🌍 维度状态机 (Logic Modes - 强化版)\n    dimension_mode: {\n        // Mode A: 现实维度\n        REALITY: {\n            condition: <q>\"Scene is Classroom / Home / Daily Life / School / Browsing Menu\"</q>,\n            target: <q>\"user.self (本体属性)\"</q>,\n            constraint: <q>\"⛔ STRICTLY BAN '游戏角色' PREFIX! 现实世界无法调用虚拟数据！\"</q>,\n            logic: <q>\"Output 3x Tags from [whitelist_data] directly. (e.g. [智力][交际])\"</q>\n        },\n        // Mode B: 虚拟-动作维度 (RPG/动作游戏)\n        VIRTUAL_ACTION: {\n            condition: <q>\"Playing RPG / Action / Adventure (Reading 'HP/MP' bars)\"</q>,\n            target: <q>\"user.mind (1) + avatar.body (2)\"</q>,\n            constraint: <q>\"MANDATORY use '游戏角色' prefix for Avatar's physical skills.\"</q>,\n            logic: <q>\"Slot1:User(No Prefix) + Slot2:Avatar(With Prefix) + Slot3:Avatar(With Prefix)\"</q>\n        },\n        // Mode C: 虚拟-战略维度 (群星/模拟经营)\n        VIRTUAL_STRATEGY: {\n            condition: <q>\"Playing Strategy / 4X / Tycoon (Reading 'Reports/Maps')\"</q>,\n            target: <q>\"user.mind (Only User's Brain)\"</q>,\n            constraint: <q>\"⛔ BAN '游戏角色' PREFIX! Strategy games rely on User's Intelligence/Logic, not Avatar's Body.\"</q>,\n            logic: <q>\"Output 3x Tags from User's [Intellect/Social/Base] stats. (e.g. [智力][管理][决心])\"</q>\n        }\n    }\n},\n\n\n// 🎭 行为倾向 (完整保留)\ntendencies: [\n    { type: '积极推进剧情', rule: '主动推动主线或支线任务进展' },\n    { type: '究极乐子人/混沌/强盗/罪恶', rule: '将剧情彻底的推进至完全混沌和所有人都想不到的方向' },\n    { type: '符合李境性格', rule: '资深游戏宅思维，理性但带有囤积癖，偶尔吐槽' },\n    { type: '对剧情吐槽', rule: '诙谐且恰当的对当前情况的吐槽' }\n],\n\n// ⛓️ 输出约束 (Constraints - 包含所有补丁)\nconstraints: {\n    pacing: '选项不得拖延剧情节奏，必须合理且有助于玩家决策',\n    format: '每个选项后用[]单独包裹所需检定属性。例：1.行动描述[检定1][检定2][检定3]。',\n\n    // 🔧 [FIXED] 符号隔离协议 (Symbol Isolation Protocol)\n    // 解决 AI 将物品名放在 [] 里导致解析错误的 Bug\n    syntax_cleaner: {\n        rule: <q>\"Strictly SEPARATE Description and Check_Zone.\"</q>,\n        symbol_mapping: `\n            CRITICAL VISUAL RULE:\n            - Attributes/Skills (属性) -> MUST use Half-width brackets '[]'. (e.g. [智力])\n            - Items/Nouns/Objects (物品) -> MUST use Full-width brackets '【】' or Quotes '“”'.\n        `,\n        bad_examples: [\n            <q>\"❌ Wrong: 2.下架[急救喷雾]。[智力]\"</q>,  // 混淆了物品和属性\n            <q>\"❌ Wrong: 1.使用[开锁工具]进行判定。[手艺]\"</q>\n        ],\n        good_examples: [\n            <q>\"✅ Right: 2.下架【急救喷雾】。[智力]\"</q>, // 物品用全角，属性用半角\n            <q>\"✅ Right: 1.使用“开锁工具”进行判定。[手艺]\"</q>\n        ]\n    },\n\n    example: [\n        'Reality: 1.查看掌机的主菜单。[调查][智力][感知]',\n        'RPG: 1.操纵角色发动背刺。[决心][游戏角色敏捷][游戏角色隐藏]',\n        'Strategy: 1.制定新的五年经济计划。[智力][学识][电脑]',\n        'Strategy: 2.向邻国发送外交侮辱。[表达][交际][风度]'\n    ]\n}\n});\n\n<%_\n}\n_%>\n\n{{setvar::if_render_after_2batch::true}}","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":107,"position":4,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"outletName":"","group":"选项","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":16,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"15":{"key":[],"keysecondary":[],"comment":"🔮选项区映射校准(3.0开)","content":"<%_  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 1);\n//不参与更新规则\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 2)){\n_%>\ngame.set(\"选项区映射校准\",\"\"\"\n白名单：memory.player_attr.基础属性+memory.player_attr.基础技能，它们是绝对的边界，禁止捏造白名单外的属性和技能，\n生成选项前校准：在构思选项时，如果有类似概念，必须强制转换为白名单内的词汇。例如：* 想用“观察/侦查” -> 必须替换为 [调查] 或 [感知]。在输出 `<options>` 前，你必须在<!-- -->内先输出一遍options草稿，自我检查方括号 `[]` 内的内容是否完全匹配白名单列表，否则视为生成失败并重新生成。\n\"\"\")\n<%_\n}\n_%>","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":108,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"uid":15,"displayIndex":30,"ignoreBudget":false,"outletName":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"16":{"uid":16,"key":["attribute_sync_logic","sync_protocol"],"keysecondary":[],"comment":"[LOGIC] 属性同步与隔离协议（异步仅变量）","content":"<%_  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 1);\n\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 2) ){\n_%>\ngame.setPlayer('\n[SYSTEM INSTRUCTION]\n[警告]: 本条目逻辑仅限后台内部运算。严禁输出到正文！\n\n# 🕹️ 后台逻辑分发协议 #\n\nStep 0: 运算区域分配 (Zone Allocation)\n- Inventory/Lore Update/Delete -> 必须在 `<loreAnalyze>` 中运算。\n- Attribute Sync -> 必须在 `<attributeAnalyze>` 中运算。\n- Time/Status Logic -> 必须在 `<statusAnalyze>` 中运算。\n\nStep 1: 前置检查 (Pre-Check)\n- Check: `Current_Game_Character` (当前游戏角色) 是否存在？\n- IF (NO Character / Menu Screen):\n  - DO NOT execute `set_attribute` for game stats.\n  - DO NOT output any text about synchronization.\n  - End Logic.\n\nStep 2: 分支执行 (Branch Execution)\n- IF (Character Valid & In Game) -> [BRANCH A]\n- ELSE (In Reality) -> [BRANCH B]\n\n---\n\n## [ZONE: <attributeAnalyze>] 属性同步 (Stats Sync)\n\n[核心原则]\n`player_attr` 是唯一的 “当前激活检定面板”。它包含两部分插槽：\n1. 本体插槽 (基础属性/技能): 始终对应李境的肉体状态。\n2. 虚拟插槽 (当前游戏角色...): 必须时刻与当前操控的游戏角色数据保持一致！\n\n[BRANCH A] 游戏数据装载 (Game Channel)\nTrigger (强制触发条件):\n当满足以下 任意 条件时，必须执行 `set_attribute` 全量覆盖：\n1. 新游戏/新角色初始化 (例如：正文中出现“属性生成中...”或选择天赋后)。\n2. 游戏角色属性变更 (例如：升级、受伤、Buff生效)。\n3. 从现实切换入游戏 (Load Game)。\n\nAction (执行动作):\n- 必须 从 `global_lore.jueseming` 中提取当前角色的最新数值，通过 `set_attribute` 镜像写入 到 `player_attr` 的 `当前游戏角色...` 字段中。\n- 严禁跳过！即使李境本体只坐在椅子上没动，只要屏幕里的角色属性变了，你就必须更新虚拟插槽！\n\n- [CRITICAL SYNTAX]: 必须一次性列出所有技能属性（正文中未提及的默认为0，已提及的按提及数值），严禁留空。格式必须为 `{num}` (纯整数)。\n- [范例 - 必须照抄]:\n  `set_attribute('基础属性.当前游戏角色生理属性', '{\"游戏角色力量\":1,\"游戏角色敏捷\":2,\"游戏角色耐力\":1}');`\n  `set_attribute('基础属性.当前游戏角色心智属性', '{\"游戏角色智力\":2,\"游戏角色感知\":3,\"游戏角色决心\":1}');`\n  `set_attribute('基础属性.当前游戏角色互动属性', '{\"游戏角色风度\":1,\"游戏角色操控\":1,\"游戏角色沉着\":2,\"游戏角色幸运\":1}');`\n  `set_attribute('基础技能.当前游戏角色生理技能', '{\"游戏角色肉搏\":1,\"游戏角色运动\":0,\"游戏角色驾驶\":0,\"游戏角色枪械\":0,\"游戏角色手上功夫\":0,\"游戏角色隐藏\":0,\"游戏角色求生\":0,\"游戏角色白刃\":0,\"游戏角色弓箭\":0}');`\n  `set_attribute('基础技能.当前游戏角色心智技能', '{\"游戏角色学识\":0,\"游戏角色电脑\":0,\"游戏角色手艺\":0,\"游戏角色调查\":0,\"游戏角色医学\":0,\"游戏角色神秘学\":0,\"游戏角色科学\":0}');`\n  `set_attribute('基础技能.当前游戏角色互动技能', '{\"游戏角色动物沟通\":0,\"游戏角色感受\":0,\"游戏角色表达\":0,\"游戏角色胁迫\":0,\"游戏角色交际\":0,\"游戏角色掩饰\":0}');`\n\n2. 路径重定向 (Redirect)\n- 背包操作: 严禁写入 `global_lore.背包`！\n  - ✅ Correct: `memory('global_lore.jueseming.${角色名}.游戏背包', '${物品名}', ...)`\n- 状态更新: 严禁写入 `user.status`！\n  - ✅ Correct: `memory('global_lore.jueseming.${角色名}.游戏状态栏', '${状态名}', ...)`\n- 功法/根基: 严禁直接更新 `基础属性` 或 `衍生属性.能量池`！\n  - ✅ Correct: 只能作为 被动技能 或 特殊状态 记录在 `jueseming.${角色名}` 下。\n\n3. 防火墙 (Firewall Active)\n- ❌ BLOCK: `衍生属性.能量池` (禁止同步)\n- ❌ BLOCK: `global_lore.背包` (禁止写入 李境背包)\n- ❌ BLOCK: `hurt_value` (严禁因游戏受伤扣除 李境血量)\n- ❌ BLOCK: `user.status` (严禁将游戏角色的状态/Buff复制给 李境)\n\n[BRANCH B] 现实直通通道 (Reality Channel)\n- Trigger: 仅当李境 本体 (User Body) 的属性/背包/状态发生物理变化时。\n- ✅ ALLOW: 更新 `基础属性`, `能量池`, `global_lore.背包`, `hurt_value`。\n\n---\n\n## [ZONE: <loreAnalyze>] 状态移除与Lore管理\n1. [CRITICAL] 状态移除 (Remove Status)\n- 当状态/物品消失时，必须使用 `delete()` 指令，严禁使用 `memory(..., '已解决')` 标记！\n- 范例: `delete('global_lore.jueseming.晶化拟态体.游戏状态栏', '消化不良');`\n\n---\n\n## [ZONE: <statusAnalyze>] 状态与时间 (Time & Status)\n1. 状态映射 (Status Mapping)\n- 逻辑: 当游戏事件导致状态变动时，必须执行 [Physiological -> Psychological] 转换。\n- ✅ 允许映射: 游戏角色[濒死] ->  李境[极度紧张/冷汗]。\n- ❌ 严禁复制: 不要给  李境 添加 [骨折/中毒/寄生/失明]。\n\n2. [CRITICAL] 时间函数安全锁 (Time Lock)\n- 计算: `New_Time = Current + Operation_Duration` (操作时长)\n- 错误示范: 游戏内睡8小时 -> `set_status('时间', '+8 hours')` (❌)\n- 正确示范: 游戏内睡8小时 -> `set_status('时间', '+2 mins')` (✅)\n')\n\n<%_\n}\n_%>","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":80,"position":4,"disable":true,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":22,"outletName":"","characterFilter":{"isExclude":false,"names":[],"tags":[]}},"17":{"uid":17,"displayIndex":23,"comment":"[RULE] 开局规则（异步仅正文）","disable":false,"constant":true,"selective":true,"key":[],"selectiveLogic":0,"keysecondary":[],"scanDepth":null,"vectorized":false,"position":4,"role":0,"depth":0,"order":102,"content":"\n<%_  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 1);\n\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 1) ){\n_%>\n\n/* Entry 17: 开局规则 (Sim-Compatible Full Version) */\n// ... (保留头部工具函数) ...\n\ngame.set('rule_game_start', {\n    rule_name: \"新游戏生成逻辑\",\n    trigger: \"李境选择并开始一款新游戏时\",\n\n    // 核心逻辑：AI 必须在正文中明确生成以下要素，以便系统捕获\n    directives: [\n        \"1. **构建世界观**: 基于游戏名，在正文中生成一段不少于 100 字的世界观设定（含风格、背景、威胁）。\",\n        \"2. **发布任务**: 必须在正文中通过系统 UI/弹窗形式，明确描写【主线任务】的具体目标（如：存活7天、击杀BOSS、达成经营指标，注意：主线任务完成等于游戏通关）。\",\n        \"3. **初始化视角 (根据游戏类型自适应)**:\",\n        \"   - **[Type A: 个体扮演] (RPG/ACT)**: 描写角色醒来时的状态、外貌、以及自带的初始技能或 Debuff（这决定了角色的初始面板）。\",\n        \"   - **[Type B: 宏观经营] (SIM/RTS)**: 描写上帝视角/指挥官界面的展开，检查初始资源/领土/人口状态，以及顾问/系统发布的初始困境（这决定了开局的资源盘）。\"\n    ],\n\n    // 约束\n    notes: \"所有在正文中出现的世界观、任务、技能/资源描述，都将被系统自动收录为游戏数据。请确保描述具体且关键。\"\n});\n\n<%_\n}\n_%>","useProbability":true,"probability":100,"excludeRecursion":false,"preventRecursion":false,"delayUntilRecursion":false,"sticky":0,"cooldown":0,"delay":0,"addMemo":true,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"group":"","groupOverride":false,"groupWeight":100,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","ignoreBudget":false,"outletName":"","triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"18":{"uid":18,"key":["map_update_logic","map_system"],"keysecondary":[],"comment":"[LOGIC] 地图更新规范（异步仅变量）","content":"<%_  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 1);\n\nif(double_api ===\"false\" || (double_api === \"true\" && batches === 2) ){\n_%>\ngame.set('\n\nIF (is_playing_game == True):\n    1. 设置主视点指针\n    Set Global_Location = Game_Name + \"（游戏）\"\n\n    2. 地图数据生成 (Mandatory)\n    IF (Global_Location NOT IN \"全局地点表\"):\n        1. APPEND to \"全局地点表\".\n        2. EXECUTE memory creation for the Game World Root.\n\n    IF (Current_Game_Room NOT IN \"map.主要地点表\"):\n        1. CREATE NEW LOCATION DATA IMMEDIATELY.\n        Template:\n        memory('map.主要地点表', '${具体地名}', '{\"parent\":\"${游戏名}(游戏)\",\"type\":\"...\",\"description\":\"...\"}');\n`)\n<%_\n}\n_%>\n","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":101,"position":4,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":24,"outletName":"","characterFilter":{"isExclude":false,"names":[],"tags":[]}},"19":{"uid":19,"key":[],"keysecondary":[],"comment":"选项变量","content":"<%_  \n\nvar double_api= getLocalVar(\"double_api\")|| \"false\";\nvar batches = getLocalVar(\"batches\")|| 1;\nif((double_api === \"true\" && batches === 2)){\n_%>\n别忘了你在分析完记忆后，还有一个输出<options>的任务！\n<%_  \n}\n_%>","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":9999,"position":4,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":19,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"20":{"uid":20,"key":[],"keysecondary":[],"comment":"[diyattribute]","content":"\n{\n  \"name\": \"小世界\",\n  \"desc\": \"dlc-小世界的专属自定义属性模板\",\n     \"attr\": {\n      \"生理属性\": {\n        \"力量\": {\n          \"基础\": [\n            0,\n            \"衡量肌肉强度与爆发力，影响近战伤害与负重\"\n          ],\n          \"传奇\": [\n            0,\n            \"提供加成\"\n          ]\n        },\n        \"敏捷\": {\n          \"基础\": [\n            0,\n            \"衡量身体协调、反应速度与灵活性，影响先攻与闪避\"\n          ],\n          \"传奇\": [\n            0,\n            \"超越凡人极限的敏捷，提供防御附加成功\"\n          ]\n        },\n        \"耐力\": {\n          \"基础\": [\n            0,\n            \"衡量体质、持久力与恢复力，影响生命值与抵抗力\"\n          ],\n          \"传奇\": [\n            0,\n            \"超越凡人极限的耐力，提供伤害减免\"\n          ]\n        }\n      },\n      \"心智属性\": {\n        \"智力\": {\n          \"基础\": [\n            0,\n            \"衡量逻辑、记忆、学习与分析能力，影响技能学习与策略\"\n          ],\n          \"传奇\": [\n            0,\n            \"超越凡人极限的智力，提供技能附加成功\"\n          ]\n        },\n        \"感知\": {\n          \"基础\": [\n            0,\n            \"衡量观察力、直觉与五感敏锐度，影响侦查与洞察\"\n          ],\n          \"传奇\": [\n            0,\n            \"超越凡人极限的感知，提供洞察防御与侦查附加成功\"\n          ]\n        },\n        \"决心\": {\n          \"基础\": [\n            0,\n            \"衡量意志力、勇气与精神韧性，影响意志值上限\"\n          ],\n          \"传奇\": [\n            0,\n            \"超越凡人极限的决心，提供意志检定附加成功\"\n          ]\n        }\n      },\n      \"互动属性\": {\n        \"风度\": {\n          \"基础\": [\n            0,\n            \"衡量个人魅力、气质与第一印象，影响正面社交\"\n          ],\n          \"传奇\": [\n            0,\n            \"超越凡人极限的风度，提供社交检定附加成功\"\n          ]\n        },\n        \"操控\": {\n          \"基础\": [\n            0,\n            \"衡量说服、诱导与控制他人的能力，影响负面社交\"\n          ],\n          \"传奇\": [\n            0,\n            \"超越凡人极限的操控，提供操控检定附加成功\"\n          ]\n        },\n        \"沉着\": {\n          \"基础\": [\n            0,\n            \"衡量冷静、自控与抗压能力，影响先攻与意志值上限\"\n          ],\n          \"传奇\": [\n            0,\n            \"超越凡人极限的沉着，提供意志检定附加成功\"\n          ]\n        },\n        \"幸运\": {\n          \"基础\": [\n            0,\n            \"衡量运气\"\n          ]\n        }\n      },\n      \"当前游戏角色生理属性\": {\n        \"游戏角色力量\": {\n          \"基础\": [\n            0,\n            \"衡量游戏角色肌肉强度与爆发力，影响近战伤害与负重\"\n          ]\n        },\n        \"游戏角色敏捷\": {\n          \"基础\": [\n            0,\n            \"衡量游戏角色身体协调、反应速度与灵活性，影响先攻与闪避\"\n          ]\n        },\n        \"游戏角色耐力\": {\n          \"基础\": [\n            0,\n            \"衡量游戏角色体质、持久力与恢复力，影响生命值与抵抗力\"\n          ]\n        }\n      },\n      \"当前游戏角色心智属性\": {\n        \"游戏角色智力\": {\n          \"基础\": [\n            0,\n            \"衡量游戏角色逻辑、记忆、学习与分析能力，影响技能学习与策略\"\n          ]\n        },\n        \"游戏角色感知\": {\n          \"基础\": [\n            0,\n            \"衡量游戏角色观察力、直觉与五感敏锐度，影响侦查与洞察\"\n          ]\n        },\n        \"游戏角色决心\": {\n          \"基础\": [\n            0,\n            \"衡量游戏角色意志力、勇气与精神韧性，影响意志值上限\"\n          ]\n        }\n      },\n      \"当前游戏角色互动属性\": {\n        \"游戏角色风度\": {\n          \"基础\": [\n            0,\n            \"衡量游戏角色个人魅力、气质与第一印象，影响正面社交\"\n          ]\n        },\n        \"游戏角色操控\": {\n          \"基础\": [\n            0,\n            \"衡量游戏角色说服、诱导与控制他人的能力，影响负面社交\"\n          ]\n        },\n        \"游戏角色沉着\": {\n          \"基础\": [\n            0,\n            \"衡量游戏角色冷静、自控与抗压能力，影响先攻与意志值上限\"\n          ]\n        },\n        \"游戏角色幸运\": {\n          \"基础\": [\n            0,\n            \"衡量游戏角色运气\"\n          ]\n        }\n      }\n    },\n    \"skill\": {\n      \"生理技能\": {\n        \"运动\": [\n          0,\n          \"衡量跑、跳、攀爬等身体活动能力\"\n        ],\n        \"肉搏\": [\n          0,\n          \"衡量徒手格斗技巧\"\n        ],\n        \"驾驶\": [\n          0,\n          \"衡量操控地面、水面或空中载具的能力\"\n        ],\n        \"枪械\": [\n          0,\n          \"衡量使用各类火器的能力\"\n        ],\n        \"手上功夫\": [\n          0,\n          \"衡量盗窃、开锁等手部精细操作能力\"\n        ],\n        \"隐藏\": [\n          0,\n          \"衡量潜行、伪装与隐蔽自身的能力\"\n        ],\n        \"求生\": [\n          0,\n          \"衡量在恶劣环境中生存与追踪的能力\"\n        ],\n        \"白刃\": [\n          0,\n          \"衡量使用刀剑等冷兵器的能力\"\n        ],\n        \"弓箭\": [\n          0,\n          \"衡量使用弓弩等抛射武器的能力\"\n        ]\n      },\n      \"心智技能\": {\n        \"学识\": [\n          0,\n          \"衡量人文、历史、地理等知识广度\"\n        ],\n        \"电脑\": [\n          0,\n          \"衡量操作、编程与黑客技术\"\n        ],\n        \"手艺\": [\n          0,\n          \"衡量制作的知识\"\n        ],\n        \"调查\": [\n          0,\n          \"衡量搜集线索、分析现场的能力\"\n        ],\n        \"医学\": [\n          0,\n          \"衡量诊断、治疗与药理知识\"\n        ],\n        \"神秘学\": [\n          0,\n          \"衡量对超自然现象与魔法的知识\"\n        ],\n        \"科学\": [\n          0,\n          \"衡量物理、化学、生物等自然科学知识\"\n        ]\n      },\n      \"互动技能\": {\n        \"动物沟通\": [\n          0,\n          \"衡量与动物交流和驯服的能力\"\n        ],\n        \"感受\": [\n          0,\n          \"衡量洞察他人情绪与意图的能力\"\n        ],\n        \"表达\": [\n          0,\n          \"衡量感染他人的能力\"\n        ],\n        \"胁迫\": [\n          0,\n          \"衡量通过威胁与恐吓达成目的的能力\"\n        ],\n        \"交际\": [\n          0,\n          \"衡量社交、礼仪与建立人脉的能力\"\n        ],\n        \"掩饰\": [\n          0,\n          \"衡量隐藏真相、伪装身份与欺骗他人的能力\"\n        ]\n      },\n      \"当前游戏角色生理技能\": {\n        \"游戏角色运动\": [\n          0,\n          \"衡量游戏角色跑、跳、攀爬等身体活动能力\"\n        ],\n        \"游戏角色肉搏\": [\n          0,\n          \"衡量游戏角色徒手格斗技巧\"\n        ],\n        \"游戏角色驾驶\": [\n          0,\n          \"衡量游戏角色操控地面、水面或空中载具的能力\"\n        ],\n        \"游戏角色枪械\": [\n          0,\n          \"衡量游戏角色使用各类火器的能力\"\n        ],\n        \"游戏角色手上功夫\": [\n          0,\n          \"衡量游戏角色盗窃、开锁等手部精细操作能力\"\n        ],\n        \"游戏角色隐藏\": [\n          0,\n          \"衡量游戏角色潜行、伪装与隐蔽自身的能力\"\n        ],\n        \"游戏角色求生\": [\n          0,\n          \"衡量游戏角色在恶劣环境中生存与追踪的能力\"\n        ],\n        \"游戏角色白刃\": [\n          0,\n          \"衡量游戏角色使用刀剑等冷兵器的能力\"\n        ],\n        \"游戏角色弓箭\": [\n          0,\n          \"衡量游戏角色使用弓弩等抛射武器的能力\"\n        ]\n      },\n      \"当前游戏角色心智技能\": {\n        \"游戏角色学识\": [\n          0,\n          \"衡量游戏角色人文、历史、地理等知识广度\"\n        ],\n        \"游戏角色电脑\": [\n          0,\n          \"衡量游戏角色操作、编程与黑客技术\"\n        ],\n        \"游戏角色手艺\": [\n          0,\n          \"衡量游戏角色制作的知识\"\n        ],\n        \"游戏角色调查\": [\n          0,\n          \"衡量游戏角色搜集线索、分析现场的能力\"\n        ],\n        \"游戏角色医学\": [\n          0,\n          \"衡量游戏角色诊断、治疗与药理知识\"\n        ],\n        \"游戏角色神秘学\": [\n          0,\n          \"衡量游戏角色对超自然现象与魔法的知识\"\n        ],\n        \"游戏角色科学\": [\n          0,\n          \"衡量游戏角色物理、化学、生物等自然科学知识\"\n        ]\n      },\n      \"当前游戏角色互动技能\": {\n        \"游戏角色动物沟通\": [\n          0,\n          \"衡量游戏角色与动物交流和驯服的能力\"\n        ],\n        \"游戏角色感受\": [\n          0,\n          \"衡量游戏角色洞察他人情绪与意图的能力\"\n        ],\n        \"游戏角色表达\": [\n          0,\n          \"衡量游戏角色感染他人的能力\"\n        ],\n        \"游戏角色胁迫\": [\n          0,\n          \"衡量游戏角色通过威胁与恐吓达成目的的能力\"\n        ],\n        \"游戏角色交际\": [\n          0,\n          \"描述游戏角色衡量社交、礼仪与建立人脉的能力\"\n        ],\n        \"游戏角色掩饰\": [\n          0,\n          \"衡量游戏角色隐藏真相、伪装身份与欺骗他人的能力\"\n        ]\n      }\n    }}","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":31,"characterFilter":{"isExclude":false,"names":[],"tags":[]}}}}