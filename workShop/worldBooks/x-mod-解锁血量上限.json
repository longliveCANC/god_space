{"entries":{"0":{"uid":0,"key":[],"keysecondary":[],"comment":"解锁血量上限","content":"\n<%_ \nif (typeof version === 'undefined') {\n    var version = Number(getLocalVar(\"world_version\", 1));\n}\n function getDataWithFallback(varName) {\n \n        let data = getLocalVar(varName);\n       \n        // 内联数据验证：检查是否为null、undefined，且如果是对象要有内容\n        const isValid = (data) => {\n            // 检查是否为 null 或 undefined\n            if (data === null || data === undefined) {\n                return false;\n            }\n            \n            // 如果是对象类型，检查是否有内容\n            if (typeof data === 'object' && data !== null) {\n                // 如果是数组，检查长度\n                if (Array.isArray(data)) {\n                    return data.length > 0;\n                }\n                // 如果是普通对象，检查是否有属性\n                return Object.keys(data).length > 0;\n            }\n            \n            // 其他类型（字符串、数字、布尔值等）只要不是 null/undefined 就认为有效\n            return true;\n        };\n        \n        // 如果数据不符合要求，从 getLocalVar 获取\n        if (!isValid(data)) {\n            data = getLocalVar(varName);\n        }\n\n // 如果还是无效，返回空对象作为默认值\n    if (!isValid(data)) {\n        data = {};\n    }\n        \n        return data;\n    }\n \n\nif (typeof characterData === 'undefined') {\n    var characterData = getDataWithFallback(\"play_character_data\");\n}\n \nvar hp_1= JSON.stringify(_.get(characterData, '衍生属性.生命值.上限[0]', ''));\nvar hp_2= JSON.stringify(_.get(characterData, '衍生属性.生命值.当前值[0]', '')); \nvar if_attribute_use = getLocalVar(\"attribute_use\")|| \"true\";\n \n\nvar is_hide_for_api = \"true\";\n  \nvar double_api= String(getLocalVar(\"double_api\")|| \"false\");\nvar batches = Number(getLocalVar(\"batches\")|| 1);\n\n \nif(double_api ===\"false\" || (double_api === \"true\" && batches === 2) ){\nvar  is_hide_for_api  = \"false\";\n}\n_%>\n<%_if (if_attribute_use === \"true\") {_%>\n \n<%_ if (is_hide_for_api === 'false') { _%>\n额外的，你可以通过该指令修改<user>的血量上限：set_attribute('衍生属性.生命值.上限',old_value,new_value);\n<user>血量上限也必须跟随正文更新。\n<%_}_%>\n<user>的生命值当前值是:<%= hp_2 %>,生命值上限是:<%= hp_1 %>\n <%_ } _%>","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":102,"position":1,"disable":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":0}}}