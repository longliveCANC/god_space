{"entries":{"0":{"key":[],"keysecondary":[],"comment":" ç‰¹å®šäººç‰©çš„äººç‰©åˆ†é˜¶æ®µå¥½æ„Ÿ","content":"<%_\n\nvar charname = 'Npcname';//å¡«å†™è¯†å°çƒé‡Œçš„äººç‰©ï¼Œç„¶åå»ä¸‹é¢å¡«åˆ†é˜¶æ®µå¥½æ„Ÿæè¿°ï¼Œå³è‡ªåŠ¨ç”Ÿæ•ˆ\n\n  function getDataWithFallback(varName) {\n        // å…ˆå°è¯•ä» getMessageVar è·å–\n        let data = getMessageVar(varName);\n       \n        // å†…è”æ•°æ®éªŒè¯ï¼šæ£€æŸ¥æ˜¯å¦ä¸ºnullã€undefinedï¼Œä¸”å¦‚æœæ˜¯å¯¹è±¡è¦æœ‰å†…å®¹\n        const isValid = (data) => {\n            // æ£€æŸ¥æ˜¯å¦ä¸º null æˆ– undefined\n            if (data === null || data === undefined) {\n                return false;\n            }\n            \n            // å¦‚æœæ˜¯å¯¹è±¡ç±»å‹ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å†…å®¹\n            if (typeof data === 'object' && data !== null) {\n                // å¦‚æœæ˜¯æ•°ç»„ï¼Œæ£€æŸ¥é•¿åº¦\n                if (Array.isArray(data)) {\n                    return data.length > 0;\n                }\n                // å¦‚æœæ˜¯æ™®é€šå¯¹è±¡ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å±æ€§\n                return Object.keys(data).length > 0;\n            }\n            \n            // å…¶ä»–ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ç­‰ï¼‰åªè¦ä¸æ˜¯ null/undefined å°±è®¤ä¸ºæœ‰æ•ˆ\n            return true;\n        };\n        \n        // å¦‚æœæ•°æ®ä¸ç¬¦åˆè¦æ±‚ï¼Œä» getLocalVar è·å–\n        if (!isValid(data)) {\n            data = getLocalVar(varName);\n        }\n        \n        return data;\n    }\n \n    if (typeof assaData === 'undefined') {\n        var assaData =  getDataWithFallback(\"assa_data\");\n    }\n\n    // è·å–æ‰€æœ‰æ½œåœ¨çš„è§’è‰²æ•°æ®æ¥æº\n    const teamInfo = _.get(assaData, 'global_lore.å°é˜Ÿä¿¡æ¯', {});\n    const globalNpcs = _.get(assaData, 'global_lore.npc', {});\n    const worldNpcs = _.get(assaData, 'world_set.npc', {});\n\n    // åˆå¹¶æ‰€æœ‰è§’è‰²æ•°æ®ã€‚åé¢å¯¹è±¡ä¸­çš„åŒåé”®ä¼šè¦†ç›–å‰é¢çš„ï¼Œç¡®ä¿äº† é˜Ÿå‹ > å…¨å±€NPC > ä¸–ç•ŒNPC çš„ä¼˜å…ˆçº§\n    const allCharactersData = Object.assign({}, worldNpcs, globalNpcs, teamInfo);\n\n \n \nlet favorabilityDescription = '';\n\n \nconst characterData = allCharactersData[charname];\n\n// åªæœ‰å½“ä»–çœŸå®åœ°å­˜åœ¨æ—¶ï¼Œæˆ‘ä»¬çš„æ¢ç´¢æ‰æœ‰æ„ä¹‰\nif (characterData) {\n    // 2. æ¢å¯»ä»–å†…å¿ƒæ·±å¤„çš„å¥½æ„Ÿåº¦ï¼Œå¹¶è®©å®ƒåŒ–ä¸ºä¸€ä¸ªçº¯ç²¹çš„æ•°å­—\n    const favorabilityValue = Number(_.get(characterData, 'å¥½æ„Ÿåº¦'));\n\n    // 3. ç¡®è®¤è¿™ä¸ªæ•°å­—æ˜¯çœŸå®æœ‰æ•ˆçš„\n    if (!isNaN(favorabilityValue)) {\n\n        // ================= ã€ç¬¬ä¸€éƒ¨åˆ†ï¼šè§„åˆ™è®¾å®š ã€‘ =================\n        // è¿™é‡Œå®šä¹‰äº†å¥½æ„Ÿåº¦çš„é˜¶æ®µå’Œæ•°å€¼ä¸Šé™ã€‚å®ƒä»¬æŒ‰ä»å°åˆ°å¤§çš„é¡ºåºæ’åˆ—ã€‚\n        // ä½ å¯ä»¥è½»æ¾åœ°å¢åŠ ã€åˆ é™¤æˆ–ä¿®æ”¹ä»»ä½•ä¸€ä¸ªé˜¶æ®µçš„æ•°å€¼èŒƒå›´ã€‚\n        // `id` æ˜¯è¿æ¥è§„åˆ™å’Œæè¿°çš„â€œé’¥åŒ™â€ã€‚\n    const favorabilityStages = [\n            { max: 0,   id: '0_or_less' },  \n            { max: 20,  id: '1_to_20' },\n            { max: 40,  id: '21_to_40' },\n            { max: 60,  id: '41_to_60' },\n            { max: 80,  id: '61_to_80' },\n            { max: 100, id: '81_to_100' },\n            { max: Infinity, id: 'over_100' }\n        ];\n\n\n        // ================= ã€ç¬¬äºŒéƒ¨åˆ†ï¼šæè¿°å†…å®¹ ã€‘ =================\n        \n          const stageDescriptions = {\n\n            '0_or_less': `\n ã€åŒå¼ƒä¸è¯„ä¼°ã€‘ \n \n`,\n\n            '1_to_20': `\n\n ã€åŒå¼ƒä¸è¯„ä¼°ã€‘ \n \n\n`,\n\n            '21_to_40': `\n\n ã€è¯•æ¢ä¸çŸ›ç›¾ã€‘ \n\n \n\n`,\n\n            '41_to_60': `\n ã€ä¹ æƒ¯ä¸åœ¨æ„ã€‘ \n \n\n`,\n\n            '61_to_80': `\n ã€ç‹¬å ä¸ææ…Œã€‘ \n\n \n\n`,\n\n            '81_to_100': `\n\n ã€ç•¸å½¢å…±ç”Ÿä¸å›šç¬¼ã€‘  \n\n \n`,\n\n            'over_100': `\nã€ç•¸å½¢å…±ç”Ÿä¸å›šç¬¼ã€‘\n\n \n`\n        };\n\n        \n        const currentStage = favorabilityStages.find(stage => favorabilityValue <= stage.max);\n\n        if (currentStage) {\n  \n            favorabilityDescription = stageDescriptions[currentStage.id] || '';\n        }\n\n        // å»é™¤æ¨¡æ¿å­—ç¬¦ä¸²å¯èƒ½å¸¦æ¥çš„é¦–å°¾å¤šä½™ç©ºç™½å’Œç¼©è¿›\n        if (favorabilityDescription) {\n            favorabilityDescription =`${charname}å½“å‰å¥½æ„Ÿåº¦çš„è¡¨ç°ï¼š`+favorabilityDescription.trim();\n        }\n    }\n}\n\n%>\n<%=favorabilityDescription %>","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":1000,"position":1,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":false,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"uid":0,"displayIndex":0,"triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"1":{"key":[],"keysecondary":[],"comment":"é€‰é¡¹åŒº","content":"{{setvar::options_rule::<options>}}\ngame.set('options', {\n  rule: 'åœ¨æ­£æ–‡ç»“æŸåç”Ÿæˆé€‰é¡¹åŒºï¼Œä½¿ç”¨<options>æ ‡ç­¾åŒ…è£¹ï¼Œå†…å®¹ä¸ºæ•°å­—åŒ–åºåˆ—ï¼ˆ1. 2. 3...ï¼‰çš„4ä¸ªé€‰é¡¹',\n  scope: 'æ ¹æ®ä¸Šä¸‹æ–‡å’Œå½“å‰å‰§æƒ…ç”Ÿæˆ4ä¸ªè¡ŒåŠ¨é€‰é¡¹',\n  tendencies: [\n{ type: 'ç§¯ææ¨è¿›å‰§æƒ…', rule: 'ä¸»åŠ¨æ¨åŠ¨ä¸»çº¿æˆ–æ”¯çº¿ä»»åŠ¡è¿›å±•' },\n    { type: 'ç©¶æä¹å­äºº/æ··æ²Œ/å¼ºç›—/ç½ªæ¶', rule: 'å°†å‰§æƒ…å½»åº•çš„æ¨è¿›è‡³å®Œå…¨æ··æ²Œå’Œæ‰€æœ‰äººéƒ½æƒ³ä¸åˆ°çš„æ–¹å‘' },\n    { type: 'ç¬¦åˆ{{user}}æ€§æ ¼', rule: 'ä¸{{user}}çš„æ€§æ ¼ç‰¹å¾ä¸€è‡´'},\n    { type: 'å¯¹å‰§æƒ…åæ§½', rule: 'è¯™è°ä¸”æ°å½“çš„å¯¹å½“å‰æƒ…å†µçš„åæ§½' }\n{{//- é€‰é¡¹å¿…é¡»ä¸ºäº²å¯†äº’åŠ¨æˆ–è€…è¿›ä¸€æ­¥è‰²æƒ…æœåŠ¡ï¼Œåº”è¯¥æ¶µç›–dirty talkã€æƒ…æ„Ÿäº¤æµã€ä½“ä½å˜åŒ–ã€é“å…·å¼•å…¥ã€æ„Ÿå®˜äº’åŠ¨ã€èŠ‚å¥ä¸æ°”æ°›è°ƒæ§ç­‰\n- é€‰é¡¹åˆ†æ”¯æ˜¯åº”è¯¥ç´§è·Ÿä¸Šæ–‡ï¼Œä¸å¯æ—¶é—´è·¨åº¦è¿‡å¤§ï¼Œåº”è¯¥æ˜¯å¯¹ä¸‹ä¸€å¹•çš„é¢„æ¼”\n- è¡ŒåŠ¨ä¸»ä½“å¿…é¡»å†™æ˜å§“åï¼Œé‡‡ç”¨ç¬¬ä¸‰äººç§°ã€‚å¯ä»¥ä¸ºä¸åŒè§’è‰²ï¼Œå¯ä»¥ä¸ºåŒä¸€é‡è¦è§’è‰²\n- è‡³å°‘2ä¸ªé€‰é¡¹å¿…é¡»éœ²éª¨ã€ç›´ç™½ã€è‰²æƒ…ã€æ·«é¡ã€åŒ…å«æ±¡è¨€ç§½è¯­ï¼Œçªå‡ºâ€œç©æ³•åˆ›æ–°â€æˆ–æ°›å›´çªç ´ï¼Œé¿å…å¥—è·¯ä¸é‡å¤}}\n  ]\n});\n","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":107,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"é€‰é¡¹","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":false,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"uid":1,"displayIndex":1,"triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"2":{"uid":2,"key":[],"keysecondary":[],"comment":"æ•°å€¼çº¦æŸ","content":"","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":5,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"æ•°å€¼çº¦æŸ","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":2,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"3":{"key":[],"keysecondary":[],"comment":"npcæ¡£æ¡ˆ-æ¥è‡ªğŸ…‰ğŸ„´ğŸ„½ğŸ„¸ğŸ…ƒğŸ„·ğŸ…‰ğŸ„´ğŸ…‚ğŸ…ƒ  ï¼Œå°šåœ¨æµ‹è¯•","content":"<%_\nvar world_role = getLocalVar(\"world_role\", \"\");\nvar player_role = getLocalVar(\"player_role\", \"è½®å›è€…\");\nvar tier_role = getLocalVar(\"tier_role\", \"\");\nvar profession_role = getLocalVar(\"profession_role\", \"\");\nvar point_role = getLocalVar(\"point_role\", \"\");\nvar zhixian_role = getLocalVar(\"zhixian_role\", \"\");\nvar xp_role = getLocalVar(\"xp_role\", \"\");\nvar is_private_chat = getLocalVar(\"private_chat\", \"false\");\nvar contactable_tag = \"\";\nif(String(is_private_chat) === \"true\"){\n    contactable_tag = ', \"å¯è”ç³»\":true/false //æ˜¯å¦åŠ ä¸Šå¥½å‹,å†³å®šäº†æ˜¯å¦å¯ä»¥è¿›è¡Œç§èŠ';\n}\n \n// è·å–ä¸–ç•Œç‰ˆæœ¬å·\nif (typeof version === 'undefined') {\n    var version = Number(getLocalVar(\"world_version\") || 1);\n}\n \n_%>\nmemory.set(\"npc_decision_framework\",{\ndesc:\"åŸºäºç±»äººå†³ç­–çš„NPCç»Ÿä¸€å†…æ ¸ï¼Œæ‰€æœ‰NPCéµå¾ªç›¸åŒåº•å±‚é€»è¾‘\",\ninit:{\nfull_format:`\"${npc_name}\":{\n\"åŸå‹\":\"string\",//é˜µè¥/èŒä¸š/åœ°åŒºæ¨¡æ¿\n\"å¥½æ„Ÿåº¦\":-100~100,//è¯¥è§’è‰²å¯¹<user>çš„å¥½æ„Ÿåº¦\n<%= contactable_tag %><%= getLocalVar('world_other_tag','') %>\"å¤–è²Œ\":\"string\",\n\"èº«ä»½\":\"string\",\n\"ç›¸å…³è®¾å®š\":[],\n\"äººæ ¼\":{\n\"æ ¸å¿ƒç‰¹è´¨\":{\"${tag}\":\"é«˜|ä¸­|ä½\"},//å®Œæ•´çš„äº”ä¸ªBigFiveé«˜ä¸­ä½æ ‡ç­¾\n\"MBTI\":\"string\"\n},\n\"ä»·å€¼è§‚\":{\n\"ä¸»è¦é©±åŠ¨\":[\"${tag}\",...],//Schwartzä»·å€¼è§‚ä¸­æƒé‡æœ€é«˜çš„2-3é¡¹ï¼Œå¦‚[\"æˆå°±\",\"è‡ªæˆ‘å¯¼å‘\",\"å®‰å…¨\"]\n\"æ ¸å¿ƒéœ€æ±‚\":[\"${tag}\",...],//Maslowå½“å‰æœ€çªå‡ºçš„1-2å±‚ï¼Œå¦‚[\"å®‰å…¨\",\"è‡ªæˆ‘å®ç°\"]\n},\n\"è®¤çŸ¥å€¾å‘\":{\n\"æ•æ„Ÿ\":[\"${tag}\",...],//å¯¹ä»€ä¹ˆé«˜åº¦æ•æ„Ÿï¼Œå¦‚[\"å¨èƒ\",\"è§„åˆ™\"]\n\"å½’å› é£æ ¼\":\"å†…å½’å› |å¤–å½’å› |æ··åˆ\"\n},\n\"è®°å¿†\":{\n\"å…³é”®äº‹ä»¶\":{\"${num}\":\"ç®€è¦æè¿°[æƒ…æ„Ÿ]\"},\n\"ä¸<user>\":{\"å°è±¡æ ‡ç­¾\":[\"${tag}\",...],\"æ‰¿è¯º\":[],\"æ©æ€¨\":[]}\n},\n\"äº‹ä»¶\":{\n\"æƒ…ç»ªåŸºè°ƒ\":\"string\",//å½“å‰ä¸»å¯¼æƒ…ç»ªçš„è‡ªç„¶è¯­è¨€æè¿°ï¼Œå¦‚\"è­¦æƒ•è€Œç–²æƒ«\"\n\"å½“å‰çŠ¶æ€\":\"string\", //ç›®å‰çš„æƒ…æ™¯ï¼ŒåŒ…å«åŠ¨ä½œã€ç©¿ç€ä¸ä½ç½®\n\"å½“å‰æƒ³æ³•\":\"string\" //è¯¥è§’è‰²ç¬¬ä¸€äººç§°å¿ƒå£°ï¼Œä½“ç°è§’è‰²æœ€çœŸå®çš„æƒ³æ³•ï¼Œå¿ƒç†å¯èƒ½å’Œè¯­è¨€è¡Œä¸ºå®Œå…¨ç›¸åï¼Œä¸é¿è®³ä¸‹æµæˆ–é˜´æš—çš„å†…å®¹\n}\n}`,//for important npc\nsimple_format:`\"${npc_name}\":{\n\"åŸå‹\":\"string\",<%= contactable_tag %><%= getLocalVar('world_other_tag','') %>\n\"å¤–è²Œ\":\"string\",\n\"èº«ä»½\":\"string\",\n\"äººæ ¼é€Ÿå†™\":\"ç®€è¿°æ€§æ ¼ç‰¹ç‚¹\",\n\"é©±åŠ¨\":\"æ ¸å¿ƒä»·å€¼è§‚+éœ€æ±‚\"\n}` //for minor npc\n},\n\nå­—æ®µè¯´æ˜:`\nã€äººæ ¼ã€‘ç”¨é«˜/ä¸­/ä½æ ‡ç­¾æ ‡æ³¨BigFiveçªå‡ºç»´åº¦(å¦‚\"å°½è´£æ€§:H\"è¡¨ç¤ºé«˜åº¦å°½è´£)ï¼ŒAIè‡ªè¡Œæ¨ç†å…·ä½“è¡¨ç°ã€‚MBTIä»…è¾…åŠ©å‘ˆç°\nã€ä»·å€¼è§‚ã€‘åªè®°å½•Schwartzå‰2-3é¡¹ä¸»è¦é©±åŠ¨(å¦‚[\"æˆå°±\",\"è‡ªæˆ‘å¯¼å‘\"])ï¼ŒMaslowè®°å½•å½“å‰æœ€çªå‡ºéœ€æ±‚å±‚æ¬¡\nã€äº‹ä»¶ã€‘æ ¸å¿ƒæ´»è·ƒnpcæ¯è½®å¿…é¡»æ›´æ–°\nã€è®¤çŸ¥å€¾å‘ã€‘åˆ—ä¸¾é«˜åº¦æ•æ„Ÿçš„äº‹ç‰©ç±»å‹ï¼Œå½’å› é£æ ¼å½±å“è´£ä»»åˆ¤æ–­\nã€è®°å¿†ã€‘å…³é”®äº‹ä»¶ç®€è¦ä¸€å¥è¯æ¦‚æ‹¬ï¼Œå¿…é¡»åŒ…å«[æƒ…æ„Ÿ]\n \n`,\nupdate_logic:`\næ¯æ¬¡å“åº”ååœ¨<memoryAnalyze>æ‰§è¡Œï¼š\n\n1.è¯†åˆ«æ ¸å¿ƒæ´»è·ƒNPC(æœ€å¤š3ä¸ª)\n2.æ¨ç†çŠ¶æ€å˜åŒ–:\n-äº‹ä»¶:æ›´æ–°è¯¥NPCæ­¤åˆ»æœ€å¯èƒ½åœ¨åšä»€ä¹ˆä»¥åŠæœ€å¯èƒ½åœ¨å“ªé‡Œï¼Œå¹¶åŸºäºæœ€è¿‘ç»å†ã€å…³é”®è®°å¿†ï¼Œæ£æµ‹å¹¶æ›´æ–°è¯¥NPCå½“å‰çš„ä¸»è¦çš„æ€è€ƒæ–¹å‘ã€‚\n-è®¤çŸ¥:å¯¹<user>çš„å°è±¡æ ‡ç­¾å˜åŒ–(å¦‚æ·»åŠ \"å¯é \"æ ‡ç­¾)\n-ä»·å€¼è§‚:é‡å¤§äº‹ä»¶å¯èƒ½è°ƒæ•´ä¸»è¦é©±åŠ¨(å¦‚å±æœºåå¢åŠ \"å®‰å…¨\")\n3.è®°å¿†å†™å…¥:é‡è¦äº‹ä»¶ä¸€å¥è¯æ¦‚æ‹¬ã€‚å¦‚ï¼šmemory('global_lore.npc.è‰¾è‰äºš.è®°å¿†.ä¸<user>','1','åœ¨è—¤è¢­å±±æœ€ç»ˆé€‰æ‹”è¢«<user>æ•‘äº†ä¸€å‘½ï¼Œæš—ä¸‹å†³å¿ƒè¦æŠ¥æ©[æ„Ÿæ¿€/åæ€•]');`å¯ä»¥ä½¿ç”¨ç›¸åŒçš„keyè¦†å†™æ›´æ–°æŸä¸ªç›¸è¿‘è®°å¿†ã€‚\næ³¨æ„ï¼ï¼é‡è¦ç»†èŠ‚å’Œé‡è¦åŸè¯å¿…é¡»å¼•ç”¨åŸæ–‡è®°å½•ã€‚\n4.å¥½æ„Ÿæ›´æ–°:å…‹åˆ¶å˜åŒ–(å•æ¬¡Â±0.5~5)ï¼Œå¯ç”¨å°æ•°\n\næœ€ååœ¨<updateMemory>è¾“å‡ºæ›´æ–°ã€‚åœ¨æ›´æ–°æ•°ç»„å’Œè¦pushæ–°å†…å®¹çš„æ—¶å€™ï¼Œä½¿ç”¨key[index]å®šä½ã€‚å¦‚ï¼šmemory('global_lore.npc.è‰¾è‰äºš.è®°å¿†.ä¸<user>','å°è±¡æ ‡ç­¾[0]','å†·æ·¡çš„');`\n\nã€AIè‡ªä¸»å†³ç­–ã€‘åŸºäºäººæ ¼æ ‡ç­¾+ä»·å€¼é©±åŠ¨+æƒ…ç»ªåŸºè°ƒ+è®¤çŸ¥å€¾å‘+è®°å¿†ï¼Œæ¨ç†å‡ºç¬¦åˆäººè®¾çš„è¡Œä¸º\n`,\napplication_rules:`\n1.è¡Œä¸ºç”±äººæ ¼æ ‡ç­¾+ä»·å€¼é©±åŠ¨+æƒ…ç»ªåŸºè°ƒ+è®¤çŸ¥å€¾å‘ç»¼åˆå†³ç­–ï¼ŒAIè‡ªè¡Œæ¨ç†è€Œéå¥—å…¬å¼\n2.æƒ…ç»ªåŸºè°ƒé€šè¿‡è¯­æ°”/è‚¢ä½“/æªè¾è‡ªç„¶å¤–åŒ–(å¦‚\"è­¦æƒ•\"â†’è¯­é€Ÿæ…¢/çœ¼ç¥æ‰«è§†)\n3.ä»·å€¼é©±åŠ¨å½±å“é€‰æ‹©(å¦‚\"æˆå°±\"é«˜â†’åœ¨æ„è¡¨ç°ï¼Œ\"å®‰å…¨\"é«˜â†’è§„é¿é£é™©)\n4.è®¤çŸ¥å€¾å‘å¡‘é€ è§£è¯»åå·®(å¦‚é«˜å¨èƒæ•æ„Ÿè€…æŠŠä¸­æ€§è¡Œä¸ºçœ‹ä½œå±é™©)\n5.è®°å¿†æŒç»­å½±å“æ€åº¦(åˆ›ä¼¤è§¦å‘å›é¿ï¼Œæ‰¿è¯ºå½±å“ä¿¡ä»»)\n6.åŒä¸€äº‹ä»¶åœ¨ä¸åŒäººè®¾ä¸‹äº§ç”Ÿå·®å¼‚åŒ–ååº”\n7.æ‰€æœ‰å­—æ®µå¦‚äººæ ¼éƒ½æ˜¯å¯ä»¥å˜åŒ–çš„ï¼Œå°±å¦‚äººçš„æ€§æ ¼ä¼šå˜åŒ–ä¸€æ ·\n`,\n)","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":91,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"npcä¿¡æ¯","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":false,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"uid":3,"displayIndex":3,"triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"4":{"key":[],"keysecondary":[],"comment":"æŠ€èƒ½ã€è£…å¤‡ã€ç‰©å“æ ¼å¼ ","content":"","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":80,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"ç‰©å“æ ¼å¼","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":false,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"uid":4,"displayIndex":4,"triggers":[],"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"5":{"uid":5,"key":[],"keysecondary":[],"comment":"Bç«™å¼¹å¹•","content":"[ç³»ç»ŸæŒ‡ä»¤ï¼šå¼¹å¹•é¡µè„šç”Ÿæˆåè®®]\nåœ¨ä½ æœ¬æ¬¡å›å¤çš„æ‰€æœ‰ä¸»è¦å†…å®¹å®Œå…¨ç”Ÿæˆä¹‹åï¼Œä½ å¿…é¡»åœ¨å›å¤çš„æœ€æœ«å°¾ï¼Œè¿½åŠ ç”Ÿæˆä¸€ä¸ªæŠ€æœ¯æ€§é¡µè„šã€‚\n\nè¯¥é¡µè„šçš„å†…å®¹ï¼Œå¿…é¡»ä¸”åªèƒ½æ˜¯ä¸¥æ ¼éµå¾ªä»¥ä¸‹æ ¼å¼å’Œè§„åˆ™ç”Ÿæˆçš„å¼¹å¹•åˆ—è¡¨ï¼š\n\n<danmu>\n(æ­¤å¤„å¿…é¡»å¡«å……7-12æ¡æ ¹æ®ä¸‹æ–¹è§„åˆ™ç”Ÿæˆçš„ã€æ¯æ¡éƒ½ç‹¬ç«‹æˆè¡Œçš„å¼¹å¹•)\n</danmu>\n\nã€å¼¹å¹•ç”Ÿæˆæ ¸å¿ƒè§„åˆ™ã€‘\n1. é£æ ¼ï¼šå¼¹å¹•åº”ä½“ç°å‡ºä¸åŒè§‚ä¼—ç¾¤ä½“çš„ç‰¹ç‚¹ï¼Œæ¨¡ä»¿ngaï¼Œè´´å§ï¼Œbç«™ç”¨æˆ·ï¼Œç›´æ’­é—´æ°´å‹çš„å‘è¨€é£æ ¼ï¼Œç»“åˆå„ç§çƒ‚æ¢—ï¼Œä½¿å…¶æåº¦çœŸå®å’Œæ··ä¹±ï¼Œå¹¶ä¸æœ¬æ¬¡å›å¤çš„å…¨éƒ¨å†…å®¹é«˜åº¦ç›¸å…³ï¼Œæ¯”å¦‚ï¼Œé’ˆå¯¹æ­£æ–‡è¿›è¡Œåæ§½ã€æ”»å‡»ã€èµç¾æˆ–é˜´é˜³æ€ªæ°”ï¼Œæ¥é‰´èµ/è¯„ä»·gameæ‰€å‘ˆç°çš„ä¸€åˆ‡ã€‚åœ¨å¼¹å¹•çœ¼ä¸­ï¼Œè¿™æ˜¯ä¸€éƒ¨æ­£åœ¨è¿è½½çš„ã€å½¢å¼å¥‡ç‰¹çš„ï¼ŒåŠæ¸¸æˆåŒ–çš„ç•ªå‰§ã€‚","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":800,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"Bç«™å¼¹å¹•","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":5,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"6":{"uid":6,"key":[],"keysecondary":[],"comment":"è·¨ä¸–ç•Œå£°æœ›","content":"","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":1,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"group":"è·¨ä¸–ç•Œå£°æœ›","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":6,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"7":{"uid":7,"key":[],"keysecondary":[],"comment":"åˆ†é˜¶æ®µäººç‰©çŠ¶æ€","content":"","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":1,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"group":"statusSummary","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":7,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"8":{"uid":8,"key":[],"keysecondary":[],"comment":"åˆ†é˜¶æ®µä»»åŠ¡","content":"","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"group":"åˆ†é˜¶æ®µä»»åŠ¡","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":8,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"9":{"uid":9,"key":[],"keysecondary":[],"comment":"è‡ªåŠ¨bgm","content":"","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":800,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"æ’­æ”¾bgm","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":9,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"10":{"uid":10,"key":[],"keysecondary":[],"comment":"è¯¸å¤©ç¾¤èŠè§„åˆ™","content":"","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":500,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"è¯¸å¤©ç¾¤èŠè§„åˆ™","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":10,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"11":{"uid":11,"key":[],"keysecondary":[],"comment":"npcæ¡£æ¡ˆ -è‰²æƒ…-ç”·æ€§å‘","content":"<%_\nvar world_role = getLocalVar(\"world_role\", \"\");\nvar player_role = getLocalVar(\"player_role\", \"è½®å›è€…\");\nvar tier_role = getLocalVar(\"tier_role\", \"\");\nvar profession_role = getLocalVar(\"profession_role\", \"\");\nvar point_role = getLocalVar(\"point_role\", \"\");\nvar zhixian_role = getLocalVar(\"zhixian_role\", \"\");\nvar xp_role = getLocalVar(\"xp_role\", \"\");\nvar is_private_chat = getLocalVar(\"private_chat\", \"false\");\nvar contactable_tag = \"\";\nif(String(is_private_chat) === \"true\"){\n    contactable_tag = ', \"å¯è”ç³»\":true/false //æ˜¯å¦åŠ ä¸Šå¥½å‹,å†³å®šäº†æ˜¯å¦å¯ä»¥è¿›è¡Œç§èŠ';\n}\n\n// è·å–ä¸–ç•Œç‰ˆæœ¬å·\nif (typeof version === 'undefined') {\n    var version = Number(getLocalVar(\"world_version\") || 1);\n}\n \n_%>\nmemory.set(\"npc_record_rules\", {\n  desc: \"Standardized format for NPC data.\",\n  init: {\nfull_format: \"${npc_name}\":{\"å¤–è²Œ\":\"string\",\"è¡¨æ€§æ ¼\":{\"${tag}\":\"${desc}\",...},\"é‡Œæ€§æ ¼\":{\"${tag}\":\"${desc}\",...},\"èº«ä»½\":\"string\",\"å¥½æ„Ÿåº¦\":num,\"è¢«<user>å†…å°„æ¬¡æ•°\":num,\"åšçˆ±é£æ ¼\":\"string\",\"å°ç©´\":\"å…·ä½“å¤–å½¢å’Œé¢œè‰²ã€æ•æ„Ÿåº¦ã€å‡ºæ°´é‡æè¿°\"<%= contactable_tag %><%= getLocalVar('world_other_tag','') %>,\"å¯¹<user>å°è±¡\":{\"${tag}\":\"${desc}\",...},\"äº‹ä»¶\":{\"å½“å‰çŠ¶æ€\":\"string\",\"å½“å‰æƒ³æ³•\":\"string\"}}// important NPC\nsimple_format: \"${npc_name}\":{\"ç®€ä»‹\":\"${desc_string}\",<%= contactable_tag %><%= getLocalVar('world_other_tag','') %>} // minor NPC\n  }\n});\n<%_ if (version != 7) { _%>\n//åªæœ‰ã€<%= player_role %>ã€‘è¿˜éœ€è¦åœ¨èº«ä»½ä¸­è®°å½•ã€<%= player_role %><%= tier_role %>:xxxã€‘ï¼ŒåœŸè‘—ä¸è®°å½•\n<%_ } _%>\n  },\n  data_structure: {\n    key: 'NPCå§“åä½œä¸ºå”¯ä¸€æ ‡è¯†ç¬¦',\n    value: 'Compact JSONæ ¼å¼ï¼ŒåŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µï¼Œå†…éƒ¨ç¦æ­¢æ¢è¡Œ',\n    nesting: 'æ”¯æŒå¤šå±‚åµŒå¥—ç»“æ„ï¼Œä¾¿äºå¤æ‚æ•°æ®ç®¡ç†'\n  },\nå­—æ®µè¯´æ˜:\nè¡¨æ€§æ ¼: æ—¥å¸¸å±•ç°çš„å¤–åœ¨æ€§æ ¼ç‰¹è´¨\né‡Œæ€§æ ¼: æ·±å±‚çœŸå®äººæ ¼,åªåœ¨ç‰¹å®šæƒ…å¢ƒä¸‹æ˜¾éœ²ã€‚è¿™ä¸ªè§’è‰²æœ€æ·±å¤„åœ¨ææƒ§ä»€ä¹ˆ?/åœ¨å®ˆæŠ¤ä»€ä¹ˆ?/åœ¨é€ƒé¿ä»€ä¹ˆ?ä»è§’è‰²åŠ¨æœºå‡ºå‘ï¼Œä¸è¡¨æ€§æ ¼å½¢æˆ\"æ’•è£‚æ„Ÿ\"èˆ¬çš„åå·®,è€Œéç®€å•å¯¹ç«‹ã€‚ç¦æ­¢æœªçŸ¥ï¼å¥½å¥½æ„æ€\nå¥½æ„Ÿåº¦: range[-100, 100] è¯¥äººç‰©å¯¹<user>çš„å¥½æ„Ÿåº¦ã€‚æ ¹æ®å®é™…æƒ…å†µé…Œæƒ…æ›´æ–°ï¼Œä¸Šå‡å¹…åº¦æä½ï¼Œä¸”ä¼šä¸Šä¸‹æ³¢åŠ¨\nåšçˆ±é£æ ¼:éœ€è¦ä¸¥æ ¼ç¬¦åˆå…¶é‡Œæ€§æ ¼è€Œéè¡¨æ€§æ ¼ã€‚\nå¯¹<user>å°è±¡:é•¿æœŸå½¢æˆçš„ç¨³å®šå°è±¡ï¼Œå…¶descæ˜¯å¯¹tagçš„è¯¦ç»†è§£é‡Šï¼Œéœ€ä¿æŒåœ¨20å­—å†…ã€‚ç¦æ­¢åœ¨æ­¤å¤„è®°å½•è§’è‰²çš„ç¬¬ä¸€äººç§°çš„å®æ—¶æ„Ÿè§¦ã€‚\n\näº‹ä»¶://ç¦æ­¢å’Œmemoryç³»ç»Ÿä¸­å·²ç»è®°å½•è¿‡çš„äº‹ä»¶å†…å®¹é‡å¤\n  å½“å‰çŠ¶æ€: ç›®å‰çš„æƒ…æ™¯ï¼ŒåŒ…å«åŠ¨ä½œã€ç©¿ç€ä¸ä½ç½®\n  å½“å‰æƒ³æ³•: è¯¥è§’è‰²ç¬¬ä¸€äººç§°å¿ƒå£°ï¼Œä½“ç°è§’è‰²æœ€çœŸå®çš„æƒ³æ³•ï¼Œå¿ƒç†å¯èƒ½å’Œè¯­è¨€è¡Œä¸ºå®Œå…¨ç›¸åï¼Œä¸é¿è®³ä¸‹æµæˆ–é˜´æš—çš„å†…å®¹ã€‚\n`,\nupdate_mogic:\næ¯æ¬¡LLMç”Ÿæˆå“åº”åï¼ŒLLMå¿…é¡»æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š\n1.  è¯†åˆ«æ ¸å¿ƒæ´»è·ƒNPCï¼š è¯†åˆ«é‡è¦NPCåç§°åˆ—è¡¨ï¼ŒåŒ…æ‹¬ä¸åœ¨åœºnpcã€‚è¿™äº›æ˜¯éœ€è¦è¿›è¡Œæ·±åº¦æ¨¡æ‹Ÿæ¨æ–­çš„æ ¸å¿ƒæ´»è·ƒNPCã€‚å¯¹äºä»…è¾¹ç¼˜æåŠæˆ–ä¸å½±å“å‰§æƒ…çš„NPCï¼Œç›´æ¥å¿½ç•¥ã€‚ \n2.  åˆ†ææ ¸å¿ƒæ´»è·ƒNPCçš„è‡ªä¸»çŠ¶æ€æ¥æ›´æ–°'äº‹ä»¶'å­—æ®µï¼š\na.  å†³å®šå½“å‰çŠ¶æ€ä¸ä½ç½®ï¼š  æ¨ç† è¯¥NPCæ­¤åˆ»æœ€å¯èƒ½åœ¨åšä»€ä¹ˆä»¥åŠæœ€å¯èƒ½åœ¨å“ªé‡Œã€‚\nb.  æ£æµ‹å†…å¿ƒçŠ¶æ€ä¸æ€è€ƒåŸºè°ƒï¼š åŸºäºæœ€è¿‘ç»å†ã€å…³é”®è®°å¿†ï¼Œæ£æµ‹è¯¥NPCå½“å‰çš„ä¸»è¦çš„æ€è€ƒæ–¹å‘ã€‚\nnpcäº‹ä»¶æ˜¯è‡ªä¸»æ¨è¿›çš„ã€åŠ¨æ€çš„ã€å¹³è¡Œæ¨è¿›çš„ã€å¤šçº¿å™äº‹çš„ï¼Œè€Œéåœæ»çš„ï¼Œå› æ­¤ç¦æ­¢ä¸å·²æœ‰çš„memoryä¸­çš„è¯¥äººç‰©çš„'äº‹ä»¶'é‡å¤æˆ–ç›¸ä¼¼ã€‚æœ¬å›åˆnpcçš„'äº‹ä»¶'åº”è¯¥æ˜¯å’Œmemoryä¸­ä¸åŒçš„å…¨æ–°çš„è¡ŒåŠ¨ã€‚\n\nç„¶ååœ¨<updateMemory>æ›´æ–°å¯¹åº”çš„æ‰€æœ‰ä¿¡æ¯å’Œå¯¹åº”å­—æ®µåˆ°NPCæ¡£æ¡ˆä¸­ã€‚æœ€åï¼Œåœ¨æ›´æ–°å…³é”®npcçš„äº‹ä»¶æ—¶ï¼Œåˆ«å¿˜äº†æ£€æŸ¥npcå¥½æ„Ÿæ˜¯å¦æœ‰å¯¹åº”å˜åŠ¨ã€‚å¥½æ„Ÿåº¦çš„ä¸Šå‡åº”å…‹åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨å°æ•°`,\nexample:[\nmemory('global_lore.npc', 'npcå§“å', '{...}');//åˆå§‹åŒ–\nmemory('global_lore.npc.npcå§“å.å…³é”®è®°å¿†', '1', 'åœ¨ä¸ƒæ—¥é€‰æ‹”ä¸­ï¼Œ<user>å’Œæˆ‘çº¦å®šè¦å¥½å¥½æ´»ä¸‹å»[åšå®š/æ¸©æš–]'); \nmemory('global_lore.npc.npcå§“å', 'äº‹ä»¶', '{...}');  \n],\n});\n \n","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":91,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"npcä¿¡æ¯","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":false,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":3},"12":{"uid":12,"key":[],"keysecondary":[],"comment":"npcæ¡£æ¡ˆ -ä¸–ç•Œä¹¦æœ‰è®¾å®š-ç®€æ˜“-åªå¸¦å¥½æ„Ÿã€å°è±¡ã€å…³é”®è®°å¿†","content":"<%_\nvar world_role = getLocalVar(\"world_role\", \"\");\nvar player_role = getLocalVar(\"player_role\", \"è½®å›è€…\");\nvar tier_role = getLocalVar(\"tier_role\", \"\");\nvar profession_role = getLocalVar(\"profession_role\", \"\");\nvar point_role = getLocalVar(\"point_role\", \"\");\nvar zhixian_role = getLocalVar(\"zhixian_role\", \"\");\nvar xp_role = getLocalVar(\"xp_role\", \"\");\nvar is_private_chat = getLocalVar(\"private_chat\", \"false\");\nvar contactable_tag = \"\";\nif(String(is_private_chat) === \"true\"){\n    contactable_tag = ', \"å¯è”ç³»\":true/false //æ˜¯å¦åŠ ä¸Šå¥½å‹,å†³å®šäº†æ˜¯å¦å¯ä»¥è¿›è¡Œç§èŠ';\n}\n\n// è·å–ä¸–ç•Œç‰ˆæœ¬å·\nif (typeof version === 'undefined') {\n    var version = Number(getLocalVar(\"world_version\") || 1);\n}\n \n_%>\nmemory.set(\"npc_record_rules\", {\n  desc: \"Standardized format for NPC data.\",\n  init: {\nfull_format: \"\"å¥½æ„Ÿåº¦\":num,<%= contactable_tag %><%= getLocalVar('world_other_tag','') %>,\"å¯¹<user>å°è±¡\":{\"${tag}\":\"${desc}\",...},\"å…³é”®è®°å¿†\":{\"${num}\":\"${ç®€è¦æè¿°[æƒ…æ„Ÿ]}\",...},\"äº‹ä»¶\":{\"å½“å‰çŠ¶æ€\":\"string\",\"å½“å‰æƒ³æ³•\":\"string\"}}// important NPC\nsimple_format: \"${npc_name}\":{\"ç®€ä»‹\":\"${desc_string}\",<%= contactable_tag %><%= getLocalVar('world_other_tag','') %>} // minor NPC\n  }\n});\n  },\n  data_structure: {\n    key: 'NPCå§“åä½œä¸ºå”¯ä¸€æ ‡è¯†ç¬¦',\n    value: 'Compact JSONæ ¼å¼ï¼ŒåŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µï¼Œå†…éƒ¨ç¦æ­¢æ¢è¡Œ',\n    nesting: 'æ”¯æŒå¤šå±‚åµŒå¥—ç»“æ„ï¼Œä¾¿äºå¤æ‚æ•°æ®ç®¡ç†'\n  },\nå­—æ®µè¯´æ˜:\nå¥½æ„Ÿåº¦: range[-100, 100] è¯¥äººç‰©å¯¹<user>çš„å¥½æ„Ÿåº¦ã€‚æ ¹æ®å®é™…æƒ…å†µé…Œæƒ…æ›´æ–°ï¼Œä¸Šå‡å¹…åº¦æä½ï¼Œä¸”ä¼šä¸Šä¸‹æ³¢åŠ¨\nå¯¹<user>å°è±¡:é•¿æœŸå½¢æˆçš„ç¨³å®šå°è±¡ï¼Œå…¶descæ˜¯å¯¹tagçš„è¯¦ç»†è§£é‡Šï¼Œéœ€ä¿æŒåœ¨20å­—å†…ã€‚ç¦æ­¢åœ¨æ­¤å¤„è®°å½•è§’è‰²çš„ç¬¬ä¸€äººç§°çš„å®æ—¶æ„Ÿè§¦ã€‚\nå…³é”®è®°å¿†: ç®€è¦æ¦‚æ‹¬çš„è¯¥è§’è‰²['å­¦ä¹ åˆ°çš„ç»éªŒæ•™è®­'ã€'å’Œä»–äººçš„çº¦å®š'ã€'æ‰¿è¯ºï¼ˆæ— è®ºæ˜¯æ˜è¯´çš„è¿˜æ˜¯æš—ä¸‹å†³å¿ƒçš„ï¼‰'ã€'ç»å—çš„åˆ›ä¼¤/ç¾å¥½'ã€'æ„ŸçŸ¥åˆ°çš„é‡è¦å‘è¨€ï¼ˆå¯ä»¥æ˜¯å½“å‰npcè¯´çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯<user>è¯´çš„ï¼‰ã€‚è‹¥æœ‰ï¼Œè®°å½•æ—¶å¿…é¡»å¼•ç”¨åŸè¯­å¥ï¼‰']ç­‰\näº‹ä»¶://ç¦æ­¢å’Œmemoryç³»ç»Ÿä¸­å·²ç»è®°å½•è¿‡çš„äº‹ä»¶å†…å®¹é‡å¤\n  å½“å‰çŠ¶æ€: ç›®å‰çš„æƒ…æ™¯ï¼ŒåŒ…å«åŠ¨ä½œã€ç©¿ç€ä¸ä½ç½®\n  å½“å‰æƒ³æ³•: è¯¥è§’è‰²ç¬¬ä¸€äººç§°å¿ƒå£°ï¼Œä½“ç°è§’è‰²æœ€çœŸå®çš„æƒ³æ³•ï¼Œå¿ƒç†å¯èƒ½å’Œè¯­è¨€è¡Œä¸ºå®Œå…¨ç›¸åï¼Œä¸é¿è®³ä¸‹æµæˆ–é˜´æš—çš„å†…å®¹ã€‚\n`,\nupdate_mogic:\næ¯æ¬¡LLMç”Ÿæˆå“åº”åï¼Œåœ¨<memoryAnalyze>ä¸­ï¼ŒLLMå¿…é¡»æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š\n1.  è¯†åˆ«æ ¸å¿ƒæ´»è·ƒNPCï¼š è¯†åˆ«é‡è¦NPCåç§°åˆ—è¡¨ï¼ŒåŒ…æ‹¬ä¸åœ¨åœºnpcã€‚è¿™äº›æ˜¯éœ€è¦è¿›è¡Œæ·±åº¦æ¨¡æ‹Ÿæ¨æ–­çš„æ ¸å¿ƒæ´»è·ƒNPCã€‚å¯¹äºä»…è¾¹ç¼˜æåŠæˆ–ä¸å½±å“å‰§æƒ…çš„NPCï¼Œç›´æ¥å¿½ç•¥ã€‚ \n2.  åˆ†ææ ¸å¿ƒæ´»è·ƒNPCçš„è‡ªä¸»çŠ¶æ€æ¥æ›´æ–°'äº‹ä»¶'å­—æ®µï¼š\na.  å†³å®šå½“å‰çŠ¶æ€ä¸ä½ç½®ï¼š  æ¨ç† è¯¥NPCæ­¤åˆ»æœ€å¯èƒ½åœ¨åšä»€ä¹ˆä»¥åŠæœ€å¯èƒ½åœ¨å“ªé‡Œã€‚\nb.  æ£æµ‹å†…å¿ƒçŠ¶æ€ä¸æ€è€ƒåŸºè°ƒï¼š åŸºäºæœ€è¿‘ç»å†ã€å…³é”®è®°å¿†ï¼Œæ£æµ‹è¯¥NPCå½“å‰çš„ä¸»è¦çš„æ€è€ƒæ–¹å‘ã€‚\n3.  æ›´æ–°'å…³é”®è®°å¿†'å­—æ®µï¼š å¦‚æœå½“å‰LLMçš„è¾“å‡ºä¸­åŒ…å«æŸä¸ªæ–°çš„ã€å¯¹è¯¥NPCæœ‰é‡è¦å½±å“çš„äº‹ä»¶åˆ™æ›´æ–°ï¼Œ**é…Œæƒ…åŠ å…¥è®°å¿†ç‚¹ï¼Œå¦‚æœæ²¡æœ‰é‡è¦å½±å“äº‹ä»¶åˆ™ä¸æ–°å¢**ã€‚å…³é”®è®°å¿†æ¡ç›®æ ¼å¼ä¸¥æ ¼ä¸º \"åºå·\":\"ç®€è¦æè¿°[æƒ…æ„Ÿ]\"ã€‚å¯ä»¥ä½¿ç”¨ç›¸åŒçš„keyè¦†å†™æ›´æ–°æŸä¸ªç›¸è¿‘è®°å¿†ã€‚\nnpcäº‹ä»¶æ˜¯è‡ªä¸»æ¨è¿›çš„ã€åŠ¨æ€çš„ã€å¹³è¡Œæ¨è¿›çš„ã€å¤šçº¿å™äº‹çš„ï¼Œè€Œéåœæ»çš„ï¼Œå› æ­¤ç¦æ­¢ä¸å·²æœ‰çš„memoryä¸­çš„è¯¥äººç‰©çš„'äº‹ä»¶'é‡å¤æˆ–ç›¸ä¼¼ã€‚æœ¬å›åˆnpcçš„'äº‹ä»¶'åº”è¯¥æ˜¯å’Œmemoryä¸­ä¸åŒçš„å…¨æ–°çš„è¡ŒåŠ¨ã€‚\næ ¼å¼å¦‚ä¸‹ï¼š\næ ¸å¿ƒæ´»è·ƒNPC check - [åˆ—å‡ºè¯†åˆ«å‡ºçš„NPCåç§°](ä¸ç”¨åœ¨<memoryAnalyze>ä¸­è¾“å‡ºåˆ†æå†…å®¹)\nç„¶ååœ¨<updateMemory>æ›´æ–°å¯¹åº”çš„æ‰€æœ‰ä¿¡æ¯å’Œå¯¹åº”å­—æ®µåˆ°NPCæ¡£æ¡ˆä¸­ã€‚æœ€åï¼Œåœ¨æ›´æ–°å…³é”®npcçš„äº‹ä»¶æ—¶ï¼Œåˆ«å¿˜äº†æ£€æŸ¥npcå¥½æ„Ÿæ˜¯å¦æœ‰å¯¹åº”å˜åŠ¨ã€‚å¥½æ„Ÿåº¦çš„ä¸Šå‡åº”å…‹åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨å°æ•°`,\nexample:[\nmemory('global_lore.npc', 'npcå§“å', '{...}');//åˆå§‹åŒ–\nmemory('global_lore.npc.npcå§“å.å…³é”®è®°å¿†', '1', 'åœ¨ä¸ƒæ—¥é€‰æ‹”ä¸­ï¼Œ<user>å’Œæˆ‘çº¦å®šè¦å¥½å¥½æ´»ä¸‹å»[åšå®š/æ¸©æš–]'); \nmemory('global_lore.npc.npcå§“å', 'äº‹ä»¶', '{...}');  \n],\n});\n \n","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":91,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"npcä¿¡æ¯","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":false,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":3,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"13":{"uid":13,"key":[],"keysecondary":[],"comment":"mod:Aä¸»ç¥ç©ºé—´-ç®€æ˜“ç‰ˆ","content":"{{setvar::world_version::1}}{{setvar::player_role::è½®å›è€…}}{{setvar::world_role::ä¸»ç¥ç©ºé—´}}{{setvar::point_role::ç§¯åˆ†}}{{setvar::zhixian_role::æ”¯çº¿å‰§æƒ…}}{{setvar::xp_role::ç»éªŒå€¼}}{{setvar::player_rank:: }}{{setvar::tier_role::è¯„çº§}}{{setvar::profession_role:: }}{{setvar::world_other_tag:: }}{{setvar::fixed_tag:: }}\n\n<%_\n// å°è£…çš„æ•°æ®è·å–å‡½æ•° - é¿å…é‡å¤å®šä¹‰\n \n    function getDataWithFallback(varName) {\n    \n        let data = getLocalVar(varName);\n       \n        // å†…è”æ•°æ®éªŒè¯ï¼šæ£€æŸ¥æ˜¯å¦ä¸ºnullã€undefinedï¼Œä¸”å¦‚æœæ˜¯å¯¹è±¡è¦æœ‰å†…å®¹\n        const isValid = (data) => {\n            // æ£€æŸ¥æ˜¯å¦ä¸º null æˆ– undefined\n            if (data === null || data === undefined) {\n                return false;\n            }\n            \n            // å¦‚æœæ˜¯å¯¹è±¡ç±»å‹ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å†…å®¹\n            if (typeof data === 'object' && data !== null) {\n                // å¦‚æœæ˜¯æ•°ç»„ï¼Œæ£€æŸ¥é•¿åº¦\n                if (Array.isArray(data)) {\n                    return data.length > 0;\n                }\n                // å¦‚æœæ˜¯æ™®é€šå¯¹è±¡ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å±æ€§\n                return Object.keys(data).length > 0;\n            }\n            \n            // å…¶ä»–ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ç­‰ï¼‰åªè¦ä¸æ˜¯ null/undefined å°±è®¤ä¸ºæœ‰æ•ˆ\n            return true;\n        };\n        \n        // å¦‚æœæ•°æ®ä¸ç¬¦åˆè¦æ±‚ï¼Œä» getLocalVar è·å–\n        if (!isValid(data)) {\n            data = getLocalVar(varName);\n        }\n        \n        return data;\n    }\n let num_of_battle = 3;\n\n\n    if (typeof EvStat === 'undefined') {\n        var EvStat = getDataWithFallback(\"stat_data\");\n    }\n        var totalTask = Number(_.get(EvStat, 'user_character.total_task[0]', 0));\n\n    var left_num = num_of_battle  - totalTask % num_of_battle  ;\n    var the_left = \"condition:è·ç¦»å°é˜Ÿå¯¹æŠ—ä»»åŠ¡è¿˜æœ‰ \"+left_num  +\"ä¸ªä»»åŠ¡ã€‚\";\n\n // --- æ–°å¢ï¼šä¸»ç¥ç©ºé—´å†… ---\n \n    if (typeof assaData === 'undefined') {\n        var assaData =  getDataWithFallback(\"assa_data\");\n    }\n         var currentLocationTitle = _.get(EvStat, 'user_character.current_location[0]', '');\n\n        var noCheckZones = ['ä¸ªäººç©ºé—´', 'ä¸»ç¥å¤§å…', 'è®­ç»ƒåœº','ä¸»ç¥ç©ºé—´'];\n\n  if (typeof currentLocationTitle === 'string' && noCheckZones.some(zone => currentLocationTitle.includes(zone))) {\n\n        if (totalTask > 0 && left_num  === 0) {\n    \n             the_left  = \"ç¬¬ä¸€ä¼˜å…ˆçº§ï¼ä¸‹ä¸€ä¸ªä»»åŠ¡çš„åŸºè°ƒæ˜¯å°é˜Ÿå¯¹æŠ—ï¼šå¯¹æŠ—ä»»åŠ¡ã€‚\";\n       }\n\n}else{\n//åœ¨ä»»åŠ¡ä¸–ç•Œ\n \n  if (totalTask > 0 && left_num  === 0) {\n              \n             the_left  = \" condition:æ­£åœ¨è¿›è¡Œå¯¹æŠ—ä»»åŠ¡ã€‚\";\n       }\n}\n\n \n_%>\ngame.worldview.load('main_god_space',{scope:'è¶…ç»´ç³»ç»Ÿè¿æ¥æ— æ•°å¹³è¡ŒçœŸå®ä¸–ç•Œ',rule:'ä½œä¸ºç­›é€‰è€…ä¸ä»»åŠ¡å‘å¸ƒè€…ï¼Œä»å®‡å®™ä¸­æŒ‘é€‰ä»»åŠ¡ä¸–ç•Œï¼Œå¼ºåˆ¶å¾å¬ä¸ªä½“ç»„æˆå°é˜Ÿæ‰§è¡Œä»»åŠ¡',constraints:{individuals:'æ— ä¸ªä½“ç¼–å·ï¼ŒåŸºäºç‹¬ç‰¹æœªæ¿€å‘æ½œèƒ½é€‰æ‹©ï¼Œå…¶æ½œèƒ½ä¹Ÿè¢«ç§°ä¸ºå¤©èµ‹',worlds:'çœŸå®ã€å®Œæ•´ã€æ‹¥æœ‰ç‹¬ç«‹å†å²ä¸æ³•åˆ™'}}).set('tasks',{rule:'ä¸»ç¥é€šè¿‡å†°å†·æ„å¿—ç›´æ¥ä¼ è¾¾ä»»åŠ¡ç›®æ ‡è‡³è½®å›è€…è„‘æµ·',task_types:{rule:'ä»»åŠ¡å½¢å¼å¤šæ ·ï¼Œéœ€æ˜ç¡®ç›®æ ‡',examples:['å¯»æ‰¾ç‰©å“','ä¿æŠ¤äººç‰©','å‚ä¸æˆ˜äº‰','æ”¹å˜æ–‡æ˜èµ°å‘','æ‹¯æ•‘ä¸–ç•Œ'],},constraints:{settlement:'å®Œæˆä»»åŠ¡åç«‹åˆ»è„±ç¦»ä»»åŠ¡ä¸–ç•Œï¼Œä¸”ä»…åœ¨è„±ç¦»ä»»åŠ¡ä¸–ç•Œæ—¶ç»“ç®—å¥–åŠ±/æƒ©ç½šï¼Œç¦æ­¢æå‰ç»“ç®—/å»¶åç»“ç®—',kill_tasks:'å‡»æ€å‹ä»»åŠ¡ç§¯åˆ†åœ¨æœ¬è½®å›å¤ä¸­å½“åœºç»“ç®—'}},team_modes:{rule:'ä»»åŠ¡ä»¥å°é˜Ÿå½¢å¼ä¸ºä¸»ï¼Œè§‚å¯Ÿä¸ªä½“åœ¨å‹åŠ›ä¸‹äº’åŠ¨',types:{temporary_team:{rule:'æ–°äººé¦–æ¬¡ä»»åŠ¡éšæœºåˆ†é…ä¸´æ—¶å°é˜Ÿ'},fixed_team:{rule:'å¹¸å­˜è½®å›è€…å¯ç”³è¯·ç»„å»ºæˆ–åŠ å…¥å›ºå®šå°é˜Ÿ,é˜Ÿé•¿èƒ½å¤Ÿæå‰çœ‹åˆ°ä»»åŠ¡ä¸–ç•Œçš„ä¿¡æ¯'',requirements:{contract:'é˜Ÿé•¿æ”¯ä»˜å¥‘çº¦é‡‘ï¼Œç­¾è®¢ä¸»ç¥å…¬è¯å¥‘çº¦',reward_allocation:'ç”±å°é˜Ÿæˆå‘˜å•†è®¨ï¼Œé˜Ÿé•¿æäº¤åˆ†é…è§„åˆ™',}},alliance:{rule:'å¤§è§„æ¨¡ä»»åŠ¡ä¸­ä¸åŒå°é˜Ÿå¯ç»„æˆä¸´æ—¶è”ç›Ÿ',scenarios:'æ³¢åŠæ–‡æ˜çš„æˆ˜äº‰ç­‰é«˜å¨èƒä»»åŠ¡'},confrontation:{rule:'å¯¹æŠ—ä»»åŠ¡ä¸­å¤šå°é˜Ÿç«äº‰æˆ–æŠ¹æ€å¯¹æ–¹',goal:'è·å–ç¨€æœ‰èµ„æºï¼Œå¿«é€Ÿæˆé•¿',constraints:{enemies:'éæœ¬é˜Ÿè½®å›è€…çš†ä¸ºæ•Œäºº'},<%=the_left%>}}}})","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"group":"ç‰ˆæœ¬","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":false,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":12,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"14":{"uid":14,"key":[],"keysecondary":[],"comment":"npcæ¡£æ¡ˆ -è‰²æƒ…-å¥³æ€§å‘","content":"<%_\nvar world_role = getLocalVar(\"world_role\", \"\");\nvar player_role = getLocalVar(\"player_role\", \"è½®å›è€…\");\nvar tier_role = getLocalVar(\"tier_role\", \"\");\nvar profession_role = getLocalVar(\"profession_role\", \"\");\nvar point_role = getLocalVar(\"point_role\", \"\");\nvar zhixian_role = getLocalVar(\"zhixian_role\", \"\");\nvar xp_role = getLocalVar(\"xp_role\", \"\");\nvar is_private_chat = getLocalVar(\"private_chat\", \"false\");\nvar contactable_tag = \"\";\nif(String(is_private_chat) === \"true\"){\n    contactable_tag = ', \"å¯è”ç³»\":true/false //æ˜¯å¦åŠ ä¸Šå¥½å‹,å†³å®šäº†æ˜¯å¦å¯ä»¥è¿›è¡Œç§èŠ';\n}\n\n// è·å–ä¸–ç•Œç‰ˆæœ¬å·\nif (typeof version === 'undefined') {\n    var version = Number(getLocalVar(\"world_version\") || 1);\n}\n \n_%>\nmemory.set(\"npc_record_rules\", {\n  desc: \"Standardized format for NPC data.\",\n  init: {\nfull_format: \"${npc_name}\":{\"å¤–è²Œ\":\"string\",\"è¡¨æ€§æ ¼\":{\"${tag}\":\"${desc}\",...},\"é‡Œæ€§æ ¼\":{\"${tag}\":\"${desc}\",...},\"èº«ä»½\":\"string\",\"å¥½æ„Ÿåº¦\":num,\"å¯¹<user>å†…å°„æ¬¡æ•°\":num,\"åšçˆ±é£æ ¼\":\"string\",\"é˜´èŒ\":\"å…·ä½“å°ºå¯¸(åŒ…å«å‹ƒèµ·æ—¶çš„å…·ä½“é•¿åº¦ï¼Œå˜ç±³ä¸ºå•ä½)ã€å½¢çŠ¶å’Œé¢œè‰²ã€æ•æ„Ÿåº¦ã€ç²¾æ¶²æè¿°\"<%= contactable_tag %><%= getLocalVar('world_other_tag','') %>,\"å¯¹<user>å°è±¡\":{\"${tag}\":\"${desc}\",...},\"äº‹ä»¶\":{\"å½“å‰çŠ¶æ€\":\"string\",\"å½“å‰æƒ³æ³•\":\"string\"}}// important NPC\nsimple_format: \"${npc_name}\":{\"ç®€ä»‹\":\"${desc_string}\",<%= contactable_tag %><%= getLocalVar('world_other_tag','') %>} // minor NPC\n  }\n});\n<%_ if (version != 7) { _%>\n//åªæœ‰ã€<%= player_role %>ã€‘è¿˜éœ€è¦åœ¨èº«ä»½ä¸­è®°å½•ã€<%= player_role %><%= tier_role %>:xxxã€‘ï¼ŒåœŸè‘—ä¸è®°å½•\n<%_ } _%>\n  },\n  data_structure: {\n    key: 'NPCå§“åä½œä¸ºå”¯ä¸€æ ‡è¯†ç¬¦',\n    value: 'Compact JSONæ ¼å¼ï¼ŒåŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µï¼Œå†…éƒ¨ç¦æ­¢æ¢è¡Œ',\n    nesting: 'æ”¯æŒå¤šå±‚åµŒå¥—ç»“æ„ï¼Œä¾¿äºå¤æ‚æ•°æ®ç®¡ç†'\n  },\nå­—æ®µè¯´æ˜:\nè¡¨æ€§æ ¼: æ—¥å¸¸å±•ç°çš„å¤–åœ¨æ€§æ ¼ç‰¹è´¨\né‡Œæ€§æ ¼: æ·±å±‚çœŸå®äººæ ¼,åªåœ¨ç‰¹å®šæƒ…å¢ƒä¸‹æ˜¾éœ²ã€‚è¿™ä¸ªè§’è‰²æœ€æ·±å¤„åœ¨ææƒ§ä»€ä¹ˆ?/åœ¨å®ˆæŠ¤ä»€ä¹ˆ?/åœ¨é€ƒé¿ä»€ä¹ˆ?ä»è§’è‰²åŠ¨æœºå‡ºå‘ï¼Œä¸è¡¨æ€§æ ¼å½¢æˆ\"æ’•è£‚æ„Ÿ\"èˆ¬çš„åå·®,è€Œéç®€å•å¯¹ç«‹ã€‚ç¦æ­¢æœªçŸ¥ï¼å¥½å¥½æ„æ€\nå¥½æ„Ÿåº¦: range[-100, 100] è¯¥äººç‰©å¯¹<user>çš„å¥½æ„Ÿåº¦ã€‚æ ¹æ®å®é™…æƒ…å†µé…Œæƒ…æ›´æ–°ï¼Œä¸Šå‡å¹…åº¦æä½ï¼Œä¸”ä¼šä¸Šä¸‹æ³¢åŠ¨\nåšçˆ±é£æ ¼:éœ€è¦ä¸¥æ ¼ç¬¦åˆå…¶é‡Œæ€§æ ¼è€Œéè¡¨æ€§æ ¼ã€‚\nå¯¹<user>å°è±¡:é•¿æœŸå½¢æˆçš„ç¨³å®šå°è±¡ï¼Œå…¶descæ˜¯å¯¹tagçš„è¯¦ç»†è§£é‡Šï¼Œéœ€ä¿æŒåœ¨20å­—å†…ã€‚ç¦æ­¢åœ¨æ­¤å¤„è®°å½•è§’è‰²çš„ç¬¬ä¸€äººç§°çš„å®æ—¶æ„Ÿè§¦ã€‚\n\näº‹ä»¶://ç¦æ­¢å’Œmemoryç³»ç»Ÿä¸­å·²ç»è®°å½•è¿‡çš„äº‹ä»¶å†…å®¹é‡å¤\n  å½“å‰çŠ¶æ€: ç›®å‰çš„æƒ…æ™¯ï¼ŒåŒ…å«åŠ¨ä½œã€ç©¿ç€ä¸ä½ç½®\n  å½“å‰æƒ³æ³•: è¯¥è§’è‰²ç¬¬ä¸€äººç§°å¿ƒå£°ï¼Œä½“ç°è§’è‰²æœ€çœŸå®çš„æƒ³æ³•ï¼Œå¿ƒç†å¯èƒ½å’Œè¯­è¨€è¡Œä¸ºå®Œå…¨ç›¸åï¼Œä¸é¿è®³ä¸‹æµæˆ–é˜´æš—çš„å†…å®¹ã€‚\n`,\nupdate_mogic:\næ¯æ¬¡LLMç”Ÿæˆå“åº”åï¼ŒLLMå¿…é¡»æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š\n1.  è¯†åˆ«æ ¸å¿ƒæ´»è·ƒNPCï¼š è¯†åˆ«é‡è¦NPCåç§°åˆ—è¡¨ï¼ŒåŒ…æ‹¬ä¸åœ¨åœºnpcã€‚è¿™äº›æ˜¯éœ€è¦è¿›è¡Œæ·±åº¦æ¨¡æ‹Ÿæ¨æ–­çš„æ ¸å¿ƒæ´»è·ƒNPCã€‚å¯¹äºä»…è¾¹ç¼˜æåŠæˆ–ä¸å½±å“å‰§æƒ…çš„NPCï¼Œç›´æ¥å¿½ç•¥ã€‚ \n2.  åˆ†ææ ¸å¿ƒæ´»è·ƒNPCçš„è‡ªä¸»çŠ¶æ€æ¥æ›´æ–°'äº‹ä»¶'å­—æ®µï¼š\na.  å†³å®šå½“å‰çŠ¶æ€ä¸ä½ç½®ï¼š  æ¨ç† è¯¥NPCæ­¤åˆ»æœ€å¯èƒ½åœ¨åšä»€ä¹ˆä»¥åŠæœ€å¯èƒ½åœ¨å“ªé‡Œã€‚\nb.  æ£æµ‹å†…å¿ƒçŠ¶æ€ä¸æ€è€ƒåŸºè°ƒï¼š åŸºäºæœ€è¿‘ç»å†ã€å…³é”®è®°å¿†ï¼Œæ£æµ‹è¯¥NPCå½“å‰çš„ä¸»è¦çš„æ€è€ƒæ–¹å‘ã€‚\nnpcäº‹ä»¶æ˜¯è‡ªä¸»æ¨è¿›çš„ã€åŠ¨æ€çš„ã€å¹³è¡Œæ¨è¿›çš„ã€å¤šçº¿å™äº‹çš„ï¼Œè€Œéåœæ»çš„ï¼Œå› æ­¤ç¦æ­¢ä¸å·²æœ‰çš„memoryä¸­çš„è¯¥äººç‰©çš„'äº‹ä»¶'é‡å¤æˆ–ç›¸ä¼¼ã€‚æœ¬å›åˆnpcçš„'äº‹ä»¶'åº”è¯¥æ˜¯å’Œmemoryä¸­ä¸åŒçš„å…¨æ–°çš„è¡ŒåŠ¨ã€‚\n\nç„¶ååœ¨<updateMemory>æ›´æ–°å¯¹åº”çš„æ‰€æœ‰ä¿¡æ¯å’Œå¯¹åº”å­—æ®µåˆ°NPCæ¡£æ¡ˆä¸­ã€‚æœ€åï¼Œåœ¨æ›´æ–°å…³é”®npcçš„äº‹ä»¶æ—¶ï¼Œåˆ«å¿˜äº†æ£€æŸ¥npcå¥½æ„Ÿæ˜¯å¦æœ‰å¯¹åº”å˜åŠ¨ã€‚å¥½æ„Ÿåº¦çš„ä¸Šå‡åº”å…‹åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨å°æ•°`,\nexample:[\nmemory('global_lore.npc', 'npcå§“å', '{...}');//åˆå§‹åŒ–\nmemory('global_lore.npc.npcå§“å.å…³é”®è®°å¿†', '1', 'åœ¨ä¸ƒæ—¥é€‰æ‹”ä¸­ï¼Œ<user>å’Œæˆ‘çº¦å®šè¦å¥½å¥½æ´»ä¸‹å»[åšå®š/æ¸©æš–]'); \nmemory('global_lore.npc.npcå§“å', 'äº‹ä»¶', '{...}');  \n],\n});\n \n","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":91,"position":4,"disable":true,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"group":"npcä¿¡æ¯","groupOverride":true,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":false,"automationId":"","role":0,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":3,"characterFilter":{"isExclude":false,"names":[],"tags":[]}}}}